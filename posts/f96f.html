<!DOCTYPE html><html lang="zh-CN" data-theme="light"><head><meta charset="UTF-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width,initial-scale=1"><title>MySQL自带工具使用介绍 | Xgp &amp; Blog</title><meta name="description" content="一、MySQL自带工具使用介绍 MySQL数据库不仅提供了数据库的服务器端应用程序，同时还提供了大量的客户端工具程序，如mysql，mysqladmin，mysqldump等等 。 语法格式：  Usage: mysql [OPTIONS] [database] 例如：  1# mysql -e &quot;select user,host from user&quot; mysql 大家只要运行"><meta name="keywords" content="sql结构化查询语句,数值类型"><meta name="author" content="Wu Shao Dong"><meta name="copyright" content="Wu Shao Dong"><meta name="format-detection" content="telephone=no"><link rel="shortcut icon" href="https://gitee.com/xgpqq/tuchuang/raw/master/img/Yun.png"><meta http-equiv="Cache-Control" content="no-transform"><meta http-equiv="Cache-Control" content="no-siteapp"><link rel="preconnect" href="//cdn.jsdelivr.net"/><link rel="dns-prefetch" href="//cdn.jsdelivr.net"/><link rel="preconnect" href="https://hm.baidu.com"/><link rel="dns-prefetch" href="https://hm.baidu.com"/><link rel="preconnect" href="https://fonts.googleapis.com" crossorigin="crossorigin"/><link rel="dns-prefetch" href="https://fonts.googleapis.com"/><link rel="preconnect" href="//busuanzi.ibruce.info"/><link rel="dns-prefetch" href="//busuanzi.ibruce.info"/><meta name="baidu-site-verification" content="rPK0WSwqdm"/><meta name="twitter:card" content="summary"><meta name="twitter:title" content="MySQL自带工具使用介绍"><meta name="twitter:description" content="一、MySQL自带工具使用介绍 MySQL数据库不仅提供了数据库的服务器端应用程序，同时还提供了大量的客户端工具程序，如mysql，mysqladmin，mysqldump等等 。 语法格式：  Usage: mysql [OPTIONS] [database] 例如：  1# mysql -e &quot;select user,host from user&quot; mysql 大家只要运行"><meta name="twitter:image" content="https://gitee.com/xgpqq/tuchuang/raw/master/img/5 (120).jpg"><meta property="og:type" content="article"><meta property="og:title" content="MySQL自带工具使用介绍"><meta property="og:url" content="https://wsdlxgp.top/posts/f96f.html"><meta property="og:site_name" content="Xgp &amp; Blog"><meta property="og:description" content="一、MySQL自带工具使用介绍 MySQL数据库不仅提供了数据库的服务器端应用程序，同时还提供了大量的客户端工具程序，如mysql，mysqladmin，mysqldump等等 。 语法格式：  Usage: mysql [OPTIONS] [database] 例如：  1# mysql -e &quot;select user,host from user&quot; mysql 大家只要运行"><meta property="og:image" content="https://gitee.com/xgpqq/tuchuang/raw/master/img/5 (120).jpg"><meta property="article:published_time" content="2020-06-17T16:01:00.000Z"><meta property="article:modified_time" content="2020-06-19T03:02:29.834Z"><script src="https://cdn.jsdelivr.net/npm/js-cookie/dist/js.cookie.min.js"></script><script>var autoChangeMode = '1'
var t = Cookies.get("theme")
if (autoChangeMode == '1'){
  var isDarkMode = window.matchMedia("(prefers-color-scheme: dark)").matches
  var isLightMode = window.matchMedia("(prefers-color-scheme: light)").matches
  var isNotSpecified = window.matchMedia("(prefers-color-scheme: no-preference)").matches
  var hasNoSupport = !isDarkMode && !isLightMode && !isNotSpecified

  if (t === undefined){
    if (isLightMode) activateLightMode()
    else if (isDarkMode) activateDarkMode()
    else if (isNotSpecified || hasNoSupport){
      console.log('You specified no preference for a color scheme or your browser does not support it. I Schedule dark mode during night time.')
      var now = new Date()
      var hour = now.getHours()
      var isNight = hour < 6 || hour >= 18
      isNight ? activateDarkMode() : activateLightMode()
  }
  } else if (t == 'light') activateLightMode()
  else activateDarkMode()

} else if (autoChangeMode == '2'){
  now = new Date();
  hour = now.getHours();
  isNight = hour < 6 || hour >= 18
  if(t === undefined) isNight? activateDarkMode() : activateLightMode()
  else if (t === 'light') activateLightMode()
  else activateDarkMode() 
} else {
  if ( t == 'dark' ) activateDarkMode()
  else if ( t == 'light') activateLightMode()
}

function activateDarkMode(){
  document.documentElement.setAttribute('data-theme', 'dark')
  if (document.querySelector('meta[name="theme-color"]') !== null){
    document.querySelector('meta[name="theme-color"]').setAttribute('content','#000')
  }
}
function activateLightMode(){
  document.documentElement.setAttribute('data-theme', 'light')
  if (document.querySelector('meta[name="theme-color"]') !== null){
  document.querySelector('meta[name="theme-color"]').setAttribute('content','#fff')
  }
}</script><link rel="stylesheet" href="/css/index.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free/css/all.min.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fancyapps/fancybox@latest/dist/jquery.fancybox.min.css"><link rel="canonical" href="https://wsdlxgp.top/posts/f96f.html"><link rel="next" title="MySQL数据文件介绍及存放位置" href="https://wsdlxgp.top/posts/80a7.html"><script>var _hmt = _hmt || [];
(function() {
  var hm = document.createElement("script");
  hm.src = "https://hm.baidu.com/hm.js?cad0cd04042fcca2c687648c42a45fc9";
  var s = document.getElementsByTagName("script")[0]; 
  s.parentNode.insertBefore(hm, s);
})();
</script><link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Titillium+Web"><script>var GLOBAL_CONFIG = { 
  root: '/',
  algolia: undefined,
  localSearch: {"path":"search.xml","languages":{"hits_empty":"找不到您查询的内容:${query}"}},
  translate: {"defaultEncoding":2,"translateDelay":0,"cookieDomain":"https://xxx/","msgToTraditionalChinese":"繁","msgToSimplifiedChinese":"簡"},
  copy: {
    success: '复制成功',
    error: '复制错误',
    noSupport: '浏览器不支持'
  },
  bookmark: {
    message_prev: '按',
    message_next: '键将本页加入书签'
  },
  runtime_unit: '天',
  runtime: true,
  copyright: undefined,
  ClickShowText: undefined,
  medium_zoom: false,
  fancybox: true,
  Snackbar: undefined,
  baiduPush: false,
  highlightCopy: true,
  highlightLang: true,
  highlightShrink: 'false',
  isFontAwesomeV5: true,
  isPhotoFigcaption: false,
  islazyload: false,
  isanchor: false
  
}</script><script>var GLOBAL_CONFIG_SITE = { 
  isPost: true,
  isHome: false,
  isSidebar: true  
  }</script><noscript><style>
#page-header {
  opacity: 1
}
.justified-gallery img{
  opacity: 1
}
</style></noscript><meta name="generator" content="Hexo 4.2.0"><link rel="alternate" href="/atom.xml" title="Xgp & Blog" type="application/atom+xml">
</head><body><div id="loading-box"><div class="loading-left-bg"></div><div class="loading-right-bg"></div><div class="spinner-box"><div class="configure-border-1"><div class="configure-core"></div></div><div class="configure-border-2"><div class="configure-core"></div></div><div class="loading-word">加载中...</div></div></div><canvas class="fireworks"></canvas><div id="mobile-sidebar"><div id="menu_mask"></div><div id="mobile-sidebar-menus"><div class="mobile_author_icon"><img class="avatar-img" src="https://gitee.com/xgpqq/tuchuang/raw/master/img/666.jpg" onerror="onerror=null;src='/img/friend_404.gif'" alt="avatar"/></div><div class="mobile_post_data"><div class="mobile_data_item is-center"><div class="mobile_data_link"><a href="/archives/"><div class="headline">文章</div><div class="length_num">115</div></a></div></div><div class="mobile_data_item is-center">      <div class="mobile_data_link"><a href="/tags/"><div class="headline">标签</div><div class="length_num">81</div></a></div></div><div class="mobile_data_item is-center">     <div class="mobile_data_link"><a href="/categories/"><div class="headline">分类</div><div class="length_num">4</div></a></div></div></div><hr/><div class="menus_items"><div class="menus_item"><a class="site-page" href="/"><i class="fa-fw fa fa-home"></i><span> 主页</span></a></div><div class="menus_item"><a class="site-page" href="/archives/"><i class="fa-fw fa fa-archive"></i><span> 归档</span></a></div><div class="menus_item"><a class="site-page" href="/tags/"><i class="fa-fw fa fa-tags"></i><span> 标签</span></a></div><div class="menus_item"><a class="site-page" href="/categories/"><i class="fa-fw fa fa-folder-open"></i><span> 分类</span></a></div><div class="menus_item"><a class="site-page" href="/link/"><i class="fa-fw fa fa-link"></i><span> 链接</span></a></div><div class="menus_item"><a class="site-page" href="/about/"><i class="fa-fw fa fa-heart"></i><span> 我</span></a></div><div class="menus_item"><a class="site-page"><i class="fa-fw fa fa-list" aria-hidden="true"></i><span> 其他</span><i class="fa fa-chevron-down menus-expand" aria-hidden="true"></i></a><ul class="menus_item_child"><li><a class="site-page" href="/music/"><i class="fa-fw fa fa-music"></i><span> 音乐</span></a></li><li><a class="site-page" href="/movies/"><i class="fa-fw fa fa-film"></i><span> 视频</span></a></li></ul></div></div></div></div><i class="fa fa-arrow-right on" id="toggle-sidebar" aria-hidden="true">     </i><div id="sidebar"><div class="sidebar-toc"><div class="sidebar-toc__title">目录</div><div class="sidebar-toc__progress"><span class="progress-notice">你已经读了</span><span class="progress-num">0</span><span class="progress-percentage">%</span><div class="sidebar-toc__progress-bar">     </div></div><div class="sidebar-toc__content"><ol class="toc"><li class="toc-item toc-level-1"><a class="toc-link" href="#"><span class="toc-number">1.</span> <span class="toc-text">一、MySQL自带工具使用介绍</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#1、mysql命令"><span class="toc-number">1.1.</span> <span class="toc-text">1、mysql命令</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#1）-e、-u、-p、-h、-P、-等选项的使用语法"><span class="toc-number">1.1.1.</span> <span class="toc-text">1）-e、-u、-p、-h、-P、 等选项的使用语法</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#语法格式："><span class="toc-number">1.1.1.0.1.</span> <span class="toc-text">语法格式：</span></a></li></ol></li><li class="toc-item toc-level-4"><a class="toc-link" href="#示例1：免登录执行sql语句"><span class="toc-number">1.1.1.1.</span> <span class="toc-text">示例1：免登录执行sql语句</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#示例2："><span class="toc-number">1.1.1.2.</span> <span class="toc-text">示例2：</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#示例3："><span class="toc-number">1.1.1.3.</span> <span class="toc-text">示例3：</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#执行一下"><span class="toc-number">1.1.1.4.</span> <span class="toc-text">执行一下</span></a></li></ol></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#2、-E"><span class="toc-number">1.2.</span> <span class="toc-text">2、-E</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#3、-H选项的使用方式"><span class="toc-number">1.3.</span> <span class="toc-text">3、-H选项的使用方式</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#4、创建授予test用户可以在指定的源登录"><span class="toc-number">1.4.</span> <span class="toc-text">4、创建授予test用户可以在指定的源登录</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#测试test用户连接mysql服务器"><span class="toc-number">1.4.0.1.</span> <span class="toc-text">测试test用户连接mysql服务器</span></a></li></ol></li></ol></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#"><span class="toc-number">2.</span> <span class="toc-text">二、–prompt使用方法</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#提示符解释："><span class="toc-number">2.0.0.1.</span> <span class="toc-text">提示符解释：</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#显示效果"><span class="toc-number">2.0.0.2.</span> <span class="toc-text">显示效果</span></a></li></ol></li></ol></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#"><span class="toc-number">3.</span> <span class="toc-text">三、–tee的使用方法</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#查看一下"><span class="toc-number">3.0.0.1.</span> <span class="toc-text">查看一下</span></a></li></ol></li></ol></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#"><span class="toc-number">4.</span> <span class="toc-text">四、mysqladmin命令</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#（1）ping"><span class="toc-number">4.0.1.</span> <span class="toc-text">（1）ping</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#（2）status"><span class="toc-number">4.0.2.</span> <span class="toc-text">（2）status</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#状态值："><span class="toc-number">4.0.2.1.</span> <span class="toc-text">状态值：</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#（3）processlist"><span class="toc-number">4.0.3.</span> <span class="toc-text">（3）processlist</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#（4）获取数据库当前的连接数"><span class="toc-number">4.0.4.</span> <span class="toc-text">（4）获取数据库当前的连接数</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#（5）显示mysql的启动时长"><span class="toc-number">4.0.5.</span> <span class="toc-text">（5）显示mysql的启动时长</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#（6）查看数据库所有库大小"><span class="toc-number">4.0.6.</span> <span class="toc-text">（6）查看数据库所有库大小</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#（7）processlist获取当前数据库的连接线程信息：-监控mysql进程运行状态："><span class="toc-number">4.0.7.</span> <span class="toc-text">（7）processlist获取当前数据库的连接线程信息： 监控mysql进程运行状态：</span></a></li></ol></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#"><span class="toc-number">5.</span> <span class="toc-text">五、mysqldump</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#"><span class="toc-number">6.</span> <span class="toc-text">六、mysqlbinlog</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#"><span class="toc-number">7.</span> <span class="toc-text">七、Mysqlslap性能测试</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#这里解释一下一些常用的选项"><span class="toc-number">7.0.0.1.</span> <span class="toc-text">这里解释一下一些常用的选项</span></a></li></ol></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#（1）查看Mysql数据库默认最大连接数"><span class="toc-number">7.1.</span> <span class="toc-text">（1）查看Mysql数据库默认最大连接数</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#2、修改MySQL数据库默认最大连接数"><span class="toc-number">7.2.</span> <span class="toc-text">2、修改MySQL数据库默认最大连接数</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#方法一"><span class="toc-number">7.2.0.1.</span> <span class="toc-text">方法一</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#方法二"><span class="toc-number">7.2.0.2.</span> <span class="toc-text">方法二</span></a></li></ol></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#3、查看Mysql默认使用存储引擎，"><span class="toc-number">7.3.</span> <span class="toc-text">3、查看Mysql默认使用存储引擎，</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#4、测试"><span class="toc-number">7.4.</span> <span class="toc-text">4、测试</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#1）用自带的SQL脚本来测试"><span class="toc-number">7.4.1.</span> <span class="toc-text">1）用自带的SQL脚本来测试</span></a><ol class="toc-child"><li class="toc-item toc-level-6"><a class="toc-link" href="#测试说明"><span class="toc-number">7.4.1.0.0.1.</span> <span class="toc-text">测试说明</span></a></li><li class="toc-item toc-level-6"><a class="toc-link" href="#测试结果说明"><span class="toc-number">7.4.1.0.0.2.</span> <span class="toc-text">测试结果说明</span></a></li><li class="toc-item toc-level-6"><a class="toc-link" href="#测试结论"><span class="toc-number">7.4.1.0.0.3.</span> <span class="toc-text">测试结论</span></a></li></ol></li></ol></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#2）测试结果保存为csv文件"><span class="toc-number">7.4.2.</span> <span class="toc-text">2）测试结果保存为csv文件</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#3）使用自定义sql脚本测试"><span class="toc-number">7.4.3.</span> <span class="toc-text">3）使用自定义sql脚本测试</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#执行脚本mysql3-sh生成mysqlslap工具需要的测试表"><span class="toc-number">7.4.3.1.</span> <span class="toc-text">执行脚本mysql3.sh生成mysqlslap工具需要的测试表</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#显示结果："><span class="toc-number">7.4.3.1.1.</span> <span class="toc-text">显示结果：</span></a></li></ol></li></ol></li></ol></li></ol></li></ol></div></div></div><div id="body-wrap"><div class="post-bg" id="nav" style="background-image: url(https://gitee.com/xgpqq/tuchuang/raw/master/img/325738.jpg)"><div id="page-header"><span class="pull_left" id="blog_name"><a class="blog_title" id="site-name" href="/">Xgp &amp; Blog</a></span><span class="pull_right menus"><div id="search_button"><a class="site-page social-icon search"><i class="fa fa-search fa-fw"></i><span> 搜索</span></a></div><div class="menus_items"><div class="menus_item"><a class="site-page" href="/"><i class="fa-fw fa fa-home"></i><span> 主页</span></a></div><div class="menus_item"><a class="site-page" href="/archives/"><i class="fa-fw fa fa-archive"></i><span> 归档</span></a></div><div class="menus_item"><a class="site-page" href="/tags/"><i class="fa-fw fa fa-tags"></i><span> 标签</span></a></div><div class="menus_item"><a class="site-page" href="/categories/"><i class="fa-fw fa fa-folder-open"></i><span> 分类</span></a></div><div class="menus_item"><a class="site-page" href="/link/"><i class="fa-fw fa fa-link"></i><span> 链接</span></a></div><div class="menus_item"><a class="site-page" href="/about/"><i class="fa-fw fa fa-heart"></i><span> 我</span></a></div><div class="menus_item"><a class="site-page"><i class="fa-fw fa fa-list" aria-hidden="true"></i><span> 其他</span><i class="fa fa-chevron-down menus-expand" aria-hidden="true"></i></a><ul class="menus_item_child"><li><a class="site-page" href="/music/"><i class="fa-fw fa fa-music"></i><span> 音乐</span></a></li><li><a class="site-page" href="/movies/"><i class="fa-fw fa fa-film"></i><span> 视频</span></a></li></ul></div></div><span class="toggle-menu close"><a class="site-page"><i class="fa fa-bars fa-fw" aria-hidden="true"></i></a></span></span></div><div id="post-info"><div id="post-title"><div class="posttitle">MySQL自带工具使用介绍</div></div><div id="post-meta"><div class="meta-firstline"><time class="post-meta__date"><span class="post-meta__date-created" title="发表于 2020-06-18 00:01:00"><i class="fa fa-calendar" aria-hidden="true"></i> 发表于 2020-06-18</span><span class="post-meta__separator">|</span><span class="post-meta__date-updated" title="更新于 2020-06-19 11:02:29"><i class="fa fa-history" aria-hidden="true"></i> 更新于 2020-06-19</span></time><span class="post-meta__categories"><span class="post-meta__separator">|</span><i class="fa fa-inbox post-meta__icon" aria-hidden="true"></i><a class="post-meta__categories" href="/categories/mysql/">mysql</a></span></div><div class="meta-secondline"> <span class="post-meta-wordcount"><i class="post-meta__icon far fa-file-word" aria-hidden="true"></i><span>字数总计:</span><span class="word-count">6.3k</span><span class="post-meta__separator">|</span><i class="post-meta__icon far fa-clock" aria-hidden="true"></i><span>阅读时长: 28 分钟</span></span></div><div class="meta-thirdline"><span class="post-meta-pv-cv"><span class="post-meta__separator">|</span><i class="fa fa-eye post-meta__icon" aria-hidden="true"> </i><span>阅读量:</span><span id="busuanzi_value_page_pv"></span></span><span class="post-meta-commentcount"></span></div></div></div></div><main class="layout_post" id="content-inner"><article id="post"><div class="post-content" id="article-container"><h1>一、MySQL自带工具使用介绍</h1>
<p><strong>MySQL数据库不仅提供了数据库的服务器端应用程序，同时还提供了大量的客户端工具程序，如mysql，mysqladmin，mysqldump等等 。</strong></p>
<p>语法格式：</p>
<blockquote>
<p><strong>Usage: mysql [OPTIONS] [database] 例如：</strong></p>
</blockquote>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs mysql"># mysql -e &quot;select user,host from user&quot; mysql<br></code></pre></td></tr></table></figure>
<p><strong>大家只要运行一下“mysql --help”就会得到如下相应的基本使用帮助信息：</strong></p>
<p><strong>这里主要介绍一些在运维过程中会用到的相关选项： 首先看看“-e, --execute=name”参数，这个参数是告诉</strong><br>
<strong>mysql，我要执行“-e”后面的某个命令，而不是要通过mysql连接登录到MySQL Server 上面。此参数在我们写一些基本的MySQL 检查和监控的脚本中非常有用，运维mysql时经常在脚本中使用到它。</strong></p>
<blockquote>
<p><strong>#mysql -hhostname -Pport -uusername -ppassword -e 相关mysql的sql语句</strong></p>
</blockquote>
<h2 id="1、mysql命令">1、mysql命令</h2>
<p><strong>Mysql命令是用的最多的一个命令工具了，为用户提供一个命令行接口来操作管理MySQL 服务器。可以通过mysql --help来查看其详细使用方法。</strong></p>
<table>
<thead>
<tr>
<th>mysql命令选项</th>
<th>作用</th>
<th>说明</th>
</tr>
</thead>
<tbody>
<tr>
<td>-u</td>
<td>指定连接数据库时使用的用户</td>
<td></td>
</tr>
<tr>
<td>-p</td>
<td>指定用户的密码</td>
<td>可以-p后面直接写密码，也可以不写，进行交互式输入密码，推荐后者</td>
</tr>
<tr>
<td>-h</td>
<td>指定要登录的主机</td>
<td>可选，如果为空，则登录本机</td>
</tr>
<tr>
<td>-P</td>
<td>指定要连接的端口</td>
<td>可选，默认是3306</td>
</tr>
<tr>
<td>-e</td>
<td>可以通过-e命令直接执行SQL语句，而不用进入数据库</td>
<td>免交互登录数据库执行SQL语句，通常在脚本中使用</td>
</tr>
<tr>
<td>-D</td>
<td>指定要登录到哪个库</td>
<td>默认不会登录到库，可以省略此选项，直接写库名</td>
</tr>
<tr>
<td>-E</td>
<td>查询到的结果以行来显示</td>
<td>类似于每条SQL语句后面加“\G”</td>
</tr>
<tr>
<td>-f</td>
<td>即使出现SQL错误，也强制继续</td>
<td>比如在不登陆数据库执行删除库的操作会有一个交互式的确认操作，可以使用此选项来避免交互式</td>
</tr>
<tr>
<td>-X</td>
<td>将查询到的数据导出位xml文件</td>
<td>导出的文件在windows系统中可以使用excel表格打开</td>
</tr>
<tr>
<td>-H</td>
<td>将查询到的数据导出位html文件</td>
<td>导出的文件在windows系统中可以使用浏览器打开</td>
</tr>
<tr>
<td>–prompt</td>
<td>定制自己的MySQL提示符显示的内容</td>
<td>默认登登录到MySQL后的提示符是“mysql &gt;”，可以使用该选项定制提示符</td>
</tr>
<tr>
<td>–tee</td>
<td>将操作数据库所有输入和输出的内容都记录进文件中</td>
<td>在一些较大维护变更的时候，为了方便被查，可以将整个操作过程中的输出信息保存到某个文件中</td>
</tr>
</tbody>
</table>
<p><strong>这里主要介绍一些在运维过程中会用到的相关选项。</strong></p>
<h3 id="1）-e、-u、-p、-h、-P、-等选项的使用语法">1）-e、-u、-p、-h、-P、 等选项的使用语法</h3>
<p><strong>首先看看“-e, --execute=name”参数，这个参数是告诉mysql，我要执行“-e”后面的某个命令，而不是要通过mysql连接登录到MySQL Server 上面。此参数在我们写一些基本的MySQL 检查和监控的脚本中非常有用，运维mysql时经常在脚本中使用到它。</strong></p>
<h5 id="语法格式：">语法格式：</h5>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs mysql">[root@mysql ~]# mysql  -hhostname -Pport -uusername -ppassword  -e  相关mysql的sql语句<br></code></pre></td></tr></table></figure>
<h4 id="示例1：免登录执行sql语句">示例1：免登录执行sql语句</h4>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><code class="hljs mysql">[root@mysql ~]# mysql -hlocalhost -P3306 -uroot -p mysql -e &quot;select user,host from user;&quot;<br>Enter password: <br>+---------------+-----------+<br>| user          | host      |<br>+---------------+-----------+<br>| bankMaster    | %         |<br>| bankMaster    | 127.0.0.1 |<br>| epetadmin     | localhost |<br>| mysql.session | localhost |<br>| mysql.sys     | localhost |<br>| root          | localhost |<br>+---------------+-----------+<br></code></pre></td></tr></table></figure>
<h4 id="示例2：">示例2：</h4>
<p><strong>通过binlog_cache_use 以及 binlog_cache_disk_use来分析设置的binlog_cache_size是否足够</strong></p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><code class="hljs MySQL">[root@mysql ~]#  mysql -uroot -p -e &quot;show status like &#39;binlog_cache%&#39;&quot;<br>Enter password: <br>+-----------------------+-------+<br>| Variable_name         | Value |<br>+-----------------------+-------+<br>| Binlog_cache_disk_use | 0     |<br>| Binlog_cache_use      | 0     |<br>+-----------------------+-------+<br></code></pre></td></tr></table></figure>
<h4 id="示例3：">示例3：</h4>
<p><strong>通过脚本创建数据库、表及对表进行增、改、删、查操作.脚本内容如下：</strong></p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br></pre></td><td class="code"><pre><code class="hljs mysql"># cat mysql1.sh<br><br>#!&#x2F;bin&#x2F;bash<br>HOSTNAME&#x3D;&quot;localhost&quot;<br>PORT&#x3D;&quot;3306&quot;<br>USERNAME&#x3D;&quot;root&quot;<br>PASSWORD&#x3D;&quot;123&quot;<br>DBNAME&#x3D;&quot;test_db&quot;<br>TABLENAME&#x3D;&quot;tb1&quot;<br><br>#create database<br>create_db_sql&#x3D;&quot;create database if not exists $&#123;DBNAME&#125;&quot;<br>mysql -h $&#123;HOSTNAME&#125; -P $&#123;PORT&#125; -u $&#123;USERNAME&#125; -p$&#123;PASSWORD&#125; -e &quot;$&#123;create_db_sql&#125;&quot;<br><br>#create table<br>create_table_sql&#x3D;&quot;create table if not exists $&#123;TABLENAME&#125; (name varchar(20),id int default 0)&quot;<br>mysql -h $&#123;HOSTNAME&#125; -P $&#123;PORT&#125; -u $&#123;USERNAME&#125; -p$&#123;PASSWORD&#125; $&#123;DBNAME&#125; -e &quot;$&#123;create_table_sql&#125;&quot;<br><br>#insert data to table<br>insert_sql&#x3D;&quot;insert into $&#123;TABLENAME&#125; values (&#39;tom&#39;,1)&quot;<br>mysql -h $&#123;HOSTNAME&#125; -P $&#123;PORT&#125; -u $&#123;USERNAME&#125; -p$&#123;PASSWORD&#125; $&#123;DBNAME&#125; -e &quot;$&#123;insert_sql&#125;&quot;<br><br>#select data<br>select_sql&#x3D;&quot;select * from $&#123;TABLENAME&#125;&quot;<br>mysql -h $&#123;HOSTNAME&#125; -P $&#123;PORT&#125; -u $&#123;USERNAME&#125; -p$&#123;PASSWORD&#125; $&#123;DBNAME&#125; -e &quot;$&#123;select_sql&#125;&quot;<br><br>#update data<br>update_sql&#x3D;&quot;update $&#123;TABLENAME&#125; set id&#x3D;3&quot;<br>mysql -h $&#123;HOSTNAME&#125; -P $&#123;PORT&#125; -u $&#123;USERNAME&#125; -p$&#123;PASSWORD&#125; $&#123;DBNAME&#125; -e &quot;$&#123;update_sql&#125;&quot;<br>mysql -h $&#123;HOSTNAME&#125; -P $&#123;PORT&#125; -u $&#123;USERNAME&#125; -p$&#123;PASSWORD&#125; $&#123;DBNAME&#125; -e &quot;$&#123;select_sql&#125;&quot;<br><br>#delete data<br>delete_sql&#x3D;&quot;delete from $&#123;TABLENAME&#125;&quot;<br>mysql -h $&#123;HOSTNAME&#125; -P $&#123;PORT&#125; -u $&#123;USERNAME&#125; -p$&#123;PASSWORD&#125; $&#123;DBNAME&#125; -e &quot;$&#123;delete_sql&#125;&quot;<br>mysql -h $&#123;HOSTNAME&#125; -P $&#123;PORT&#125; -u $&#123;USERNAME&#125; -p$&#123;PASSWORD&#125; $&#123;DBNAME&#125; -e &quot;$&#123;select_sql&#125;&quot;<br></code></pre></td></tr></table></figure>
<h4 id="执行一下">执行一下</h4>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><code class="hljs shell">[root@mysql ~]# sh mysql1.sh <br>mysql: [Warning] Using a password on the command line interface can be insecure.<br>mysql: [Warning] Using a password on the command line interface can be insecure.<br>mysql: [Warning] Using a password on the command line interface can be insecure.<br>mysql: [Warning] Using a password on the command line interface can be insecure.<br>+------+------+<br>| name | id   |<br>+------+------+<br>| tom  |    1 |<br>+------+------+<br>mysql: [Warning] Using a password on the command line interface can be insecure.<br>mysql: [Warning] Using a password on the command line interface can be insecure.<br>+------+------+<br>| name | id   |<br>+------+------+<br>| tom  |    3 |<br>+------+------+<br>mysql: [Warning] Using a password on the command line interface can be insecure.<br>mysql: [Warning] Using a password on the command line interface can be insecure.<br></code></pre></td></tr></table></figure>
<h2 id="2、-E">2、-E</h2>
<p><strong>如果在连接时候使用了“-E, --vertical”参数，登入之后的所有查询结果都将以纵列显示，效果和我们在一条query 之后以“\G”结尾一样。</strong></p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><code class="hljs mysql"># mysql -uroot -p123 -E<br>mysql: [Warning] Using a password on the command line interface can be insecure.<br>Welcome to the MySQL monitor. Commands end with ; or \g.<br>Your MySQL connection id is 27<br>Server version: 5.7.22 Source distribution<br>Copyright (c) 2000, 2018, Oracle and&#x2F;or its affiliates. All rights reserved.<br>Oracle is a registered trademark of Oracle Corporation and&#x2F;or its<br>affiliates. Other names may be trademarks of their respective<br>owners.<br>Type &#39;help;&#39; or &#39;\h&#39; for help. Type &#39;\c&#39; to clear the current input statement.<br>mysql&gt; show databases;<br>*************************** 1. row ***************************<br>Database: information_schema<br>*************************** 2. row ***************************<br>Database: mysql<br>*************************** 3. row ***************************<br>Database: test_db<br>10 rows in set (0.00 sec)<br></code></pre></td></tr></table></figure>
<p><strong>“-H, --html”与“-X, --xml”，在启用这两个参数之后，select出来的所有结果都会按照“Html”与“Xml”格式来输出，在有些场合之下，比如希望Xml或者Html 文件格式导出某些报表文件的时候，是非常方便的。</strong></p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br></pre></td><td class="code"><pre><code class="hljs mysql">[root@192 ~]# mysql -utest -p -X<br>Enter password: <br>Welcome to the MySQL monitor.  Commands end with ; or \g.<br>Your MySQL connection id is 40<br>Server version: 5.7.30 MySQL Community Server (GPL)<br><br>Copyright (c) 2000, 2020, Oracle and&#x2F;or its affiliates. All rights reserved.<br><br>Oracle is a registered trademark of Oracle Corporation and&#x2F;or its<br>affiliates. Other names may be trademarks of their respective<br>owners.<br><br>Type &#39;help;&#39; or &#39;\h&#39; for help. Type &#39;\c&#39; to clear the current input statement.<br><br>mysql&gt; use test_db;<br>Reading table information for completion of table and column names<br>You can turn off this feature to get a quicker startup with -A<br><br>Database changed<br>mysql&gt; select * from tb1;<br>&lt;?xml version&#x3D;&quot;1.0&quot;?&gt;<br><br>&lt;resultset statement&#x3D;&quot;select * from tb1;&quot; xmlns:xsi&#x3D;&quot;http:&#x2F;&#x2F;www.w3.org&#x2F;2001&#x2F;XMLSchema-instance&quot;&gt;<br>  &lt;row&gt;<br>        &lt;field name&#x3D;&quot;name&quot;&gt;tom&lt;&#x2F;field&gt;<br>        &lt;field name&#x3D;&quot;id&quot;&gt;1&lt;&#x2F;field&gt;<br>  &lt;&#x2F;row&gt;<br><br>  &lt;row&gt;<br>        &lt;field name&#x3D;&quot;name&quot;&gt;tom&lt;&#x2F;field&gt;<br>        &lt;field name&#x3D;&quot;id&quot;&gt;2&lt;&#x2F;field&gt;<br>  &lt;&#x2F;row&gt;<br><br>  &lt;row&gt;<br>        &lt;field name&#x3D;&quot;name&quot;&gt;tom&lt;&#x2F;field&gt;<br>        &lt;field name&#x3D;&quot;id&quot;&gt;3&lt;&#x2F;field&gt;<br>  &lt;&#x2F;row&gt;<br>&lt;&#x2F;resultset&gt;<br>3 rows in set (0.01 sec)<br></code></pre></td></tr></table></figure>
<h2 id="3、-H选项的使用方式">3、-H选项的使用方式</h2>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs shell">[root@mysql ~]# mysql -H -uroot -p123.com -e "select * from mysql.user" &gt; a.html<br><span class="hljs-meta">#</span><span class="bash">将查询的结果重定向输出到a.html文件中</span><br>[root@mysql ~]# sz a.html    #下载这个文件到本地windows系统<br></code></pre></td></tr></table></figure>
<p><img src="https://gitee.com/xgpqq/tuchuang/raw/master/img/image-20200618184838389.png" alt="image-20200618184838389"></p>
<h2 id="4、创建授予test用户可以在指定的源登录">4、创建授予test用户可以在指定的源登录</h2>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs mysql"># mysql -uroot -p -e &quot;grant all on test_db.* to root@&#39;192.168.1.10&#39; identified by<br>&#39;123&#39;&quot;<br>Enter password:<br></code></pre></td></tr></table></figure>
<h4 id="测试test用户连接mysql服务器">测试test用户连接mysql服务器</h4>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><code class="hljs mysql">[root@mysql ~]# mysql -u root -p -e &quot;grant all on test_db.* to test@&#39;192.168.1.%&#39; identified by &#39;123&#39;&quot;<br>Enter password: <br>[root@mysql ~]#  mysql -utest -p123 -h 192.168.1.10<br>mysql: [Warning] Using a password on the command line interface can be insecure.<br>Welcome to the MySQL monitor.  Commands end with ; or \g.<br>Your MySQL connection id is 18<br>Server version: 5.7.22 MySQL Community Server (GPL)<br><br>Copyright (c) 2000, 2018, Oracle and&#x2F;or its affiliates. All rights reserved.<br><br>Oracle is a registered trademark of Oracle Corporation and&#x2F;or its<br>affiliates. Other names may be trademarks of their respective<br>owners.<br><br>Type &#39;help;&#39; or &#39;\h&#39; for help. Type &#39;\c&#39; to clear the current input statement.<br><br>mysql&gt;<br></code></pre></td></tr></table></figure>
<h1>二、–prompt使用方法</h1>
<p><strong>“–prompt=name”参数对于做运维的人来说是一个非常重要的参数选项，其主要功能是<code>定制自己的mysql提示符的显示内容。</code></strong></p>
<p><strong>在默认情况下，我们通过mysql登入到数据库之后，mysql的提示符只是一个很简单的内容”mysql&gt;“，没有其他任何附加信息。非常幸运的是mysql通过“<code>--prompt=name</code>”参数给我们提供了自定义提示信息的办法，可以通过配置显示登入的主机地址，登录用户名，当前时间，当前数据库schema，MySQL Server 的一些信息等等。</strong></p>
<p><strong>个人强烈建议将登录主机名，登录用户名和所在的schema 这三项加入提示内容，因为当大家手边管理的MySQL 越来越多，操作越来越频繁的时候，非常容易因为操作的时候没有太在意自己当前所处的环境而造成在错误的环境执行了错误的命令并造成严重后果的情况。如果我们在提示内容中加入了这几项之后，至少可以更方便的提醒自己当前所处环境，以尽量减少犯错误的概率.</strong></p>
<p><strong>个人强烈建议提示符定义：</strong></p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs mysql">&quot;\\u@\\h : \\d \\r:\\m:\\s&gt; &quot;<br></code></pre></td></tr></table></figure>
<h4 id="提示符解释：">提示符解释：</h4>
<ul>
<li><strong>\u ：表示用户名,</strong></li>
<li><strong>\h ：表示主机名，</strong></li>
<li><strong>\d ：表示当前数据库，</strong></li>
<li><strong>\r小时：（12小时制），</strong></li>
<li><strong>\R小时（24小时制），</strong></li>
<li><strong>\m：分种，</strong></li>
<li><strong>\s秒，</strong></li>
</ul>
<h4 id="显示效果">显示效果</h4>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><code class="hljs mysql">[root@mysql ~]# mysql -uroot -p --prompt&#x3D;&quot;\\u@\\h: \\d \\r:\\m:\\s&quot;<br>Enter password: <br>Welcome to the MySQL monitor.  Commands end with ; or \g.<br>Your MySQL connection id is 26<br>Server version: 5.7.22 MySQL Community Server (GPL)<br><br>Copyright (c) 2000, 2018, Oracle and&#x2F;or its affiliates. All rights reserved.<br><br>Oracle is a registered trademark of Oracle Corporation and&#x2F;or its<br>affiliates. Other names may be trademarks of their respective<br>owners.<br><br>Type &#39;help;&#39; or &#39;\h&#39; for help. Type &#39;\c&#39; to clear the current input statement.<br><br>root@localhost: (none) 04:54:56&gt; use test_db<br>Reading table information for completion of table and column names<br>You can turn off this feature to get a quicker startup with -A<br><br>Database changed<br>root@localhost: (none) 04:54:56&gt;<br></code></pre></td></tr></table></figure>
<h1>三、–tee的使用方法</h1>
<p><strong>“–tee=name”参数也是对运维人员非常有用的参数选项，用来告诉mysql，将所有输入和输出内容都记录进文件。在我们一些较大维护变更的时候，为了方便被查，最好是将整个操作过程的所有输入和输出内容都保存下来.假如mysql命令行状态下，要进行大量的交互操作，其实可以把这些操作记录在log中进行审计，很简单 <code>mysql -u root -p --tee=/path/xxxx.log</code></strong></p>
<p><strong>也可以在服务器上的/etc/my.cnf中的[client]加入 tee =/tmp/client_mysql.log即可. 注：若没有[client]就添加即可 或者在mysql&gt;提示符下执行下面的命令</strong></p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><code class="hljs mysql">mysql&gt; tee &#x2F;opt&#x2F;xgp.log<br>Logging to file &#39;&#x2F;opt&#x2F;xgp.log&#39;<br>mysql&gt; show databases;<br>+--------------------+<br>| Database           |<br>+--------------------+<br>| information_schema |<br>| mysql              |<br>| performance_schema |<br>| sys                |<br>| test_db            |<br>+--------------------+<br>5 rows in set (0.00 sec)<br></code></pre></td></tr></table></figure>
<h4 id="查看一下">查看一下</h4>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><code class="hljs mysql">[root@mysql ~]# cat &#x2F;opt&#x2F;xgp.log <br>mysql&gt; tee &#x2F;opt&#x2F;xgp.log<br>Logging to file &#39;&#x2F;opt&#x2F;xgp.log&#39;<br>mysql&gt; show databases;<br>+--------------------+<br>| Database           |<br>+--------------------+<br>| information_schema |<br>| mysql              |<br>| performance_schema |<br>| sys                |<br>| test_db            |<br>+--------------------+<br>5 rows in set (0.00 sec)<br></code></pre></td></tr></table></figure>
<p><strong>同样，“–tee”这个配置项也可以写入my.cnf这个主配置文件中的client字段下，如下：</strong></p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><code class="hljs shell">[root@mysql ~]# vim /etc/my.cnf <br><br>[client]<br>socket=/usr/local/mysql/mysql.sock<br>[mysqld]<br>basedir=/usr/local/mysql<br>datadir=/usr/local/mysql/data<br>pid-file=/usr/local/mysql/data/mysql.pid<br>socket=/usr/local/mysql/mysql.sock<br>log-error=/usr/local/mysql/data/mysql.err<br>tee=/opt/xgp.log<br></code></pre></td></tr></table></figure>
<h1>四、mysqladmin命令</h1>
<p><strong>mysqladmin,顾名思义,提供的功能都是与MySQL管理相关的各种功能。如MySQL Server状态检查,各种统计信息的flush,创建/删除数据库，关闭MySQL Server等等。mysqladmin所能做的事情，虽然大部分都可以通过mysql连接登录上MySQL Server之后来完成，但是大部分通过mysqladmin来完成操作会更简单更方便。</strong><br>
<strong>mysqladmin后面可以接选项，也可以接命令,这里就不说选项了，主要说一下命令</strong></p>
<table>
<thead>
<tr>
<th>命令字</th>
<th>作用</th>
</tr>
</thead>
<tbody>
<tr>
<td>create databasename</td>
<td>创建一个库</td>
</tr>
<tr>
<td>drop databasename</td>
<td>删除一个库</td>
</tr>
<tr>
<td>status</td>
<td>查询MySQL的基本状态（显示的信息有限 ）</td>
</tr>
<tr>
<td>extended-status</td>
<td>查询服务器的详细状态信息（类似于在数据库中执行show status;）</td>
</tr>
<tr>
<td>flush-hosts</td>
<td>刷新服务器缓存</td>
</tr>
<tr>
<td>flush-logs</td>
<td>刷新二进制日志文件（如果二进制日志功能开启，那么执行这个操作会生成新的二进制日志文件）</td>
</tr>
<tr>
<td>flush-status</td>
<td>刷新状态变量</td>
</tr>
<tr>
<td>flush-tables</td>
<td>刷新所有表</td>
</tr>
<tr>
<td>flush-threads</td>
<td>刷新所有线程缓存</td>
</tr>
<tr>
<td>flush-privileges</td>
<td>重新加载授权表</td>
</tr>
<tr>
<td>processlist</td>
<td>查看当前连接数据库的所有ID详细信息</td>
</tr>
<tr>
<td>kill id</td>
<td>杀掉某个或多个连接ID（一般需要先使用processlist查看出ID列表，然后根据ID将其kill掉 ）</td>
</tr>
<tr>
<td>ping</td>
<td>检测某个MySQL服务是否处于启动状态</td>
</tr>
<tr>
<td>password</td>
<td>修改用户密码</td>
</tr>
<tr>
<td>shutdown</td>
<td>关闭MySQL服务</td>
</tr>
<tr>
<td>start-slave</td>
<td>开启主从复制</td>
</tr>
<tr>
<td>stop-slave</td>
<td>关闭主从复制</td>
</tr>
<tr>
<td>variables</td>
<td>查询MySQL服务中的所有变量</td>
</tr>
<tr>
<td>version</td>
<td>查询MySQL的版本详细信息</td>
</tr>
</tbody>
</table>
<h3 id="（1）ping">（1）ping</h3>
<p><strong>监测服务是否正常</strong></p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs shell">[root@mysql ~]# mysqladmin -uroot -p  ping<br>Enter password: <br>mysqld is alive<br></code></pre></td></tr></table></figure>
<h3 id="（2）status">（2）status</h3>
<p><strong>获取mysql当前状态值</strong></p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs shell">[root@mysql ~]# mysqladmin -uroot -p  status<br>Enter password: <br>Uptime: 3413  Threads: 2  Questions: 102  Slow queries: 0  Opens: 118  Flush tables: 1  Open tables: 111  Queries per second avg: 0.029<br></code></pre></td></tr></table></figure>
<h4 id="状态值：">状态值：</h4>
<ul>
<li>**mysqladmin status命令结果有下述列 **</li>
<li><strong>Uptime:是mysql服务器运行的秒数.</strong></li>
<li><strong>Threads:活跃线程的数量即开启的会话数.</strong></li>
<li><strong>Questions： 服务器启动以来客户的问题(查询)数目 （只要跟mysql作交互，不管查询表，还是查询服务器状态都记一次）.</strong></li>
<li><strong>Slow queries：是慢查询的数量.</strong></li>
<li>**Opens：mysql已经打开的数据库表的数量 **</li>
<li>**Flush tables: mysql已经执行的flush tables，refresh和reload命令的数量.注：flush tables //刷新表（清除缓存）reload 重载授权表 refresh 洗掉所有表并关闭和打开日志文件 **</li>
<li><strong>open：打开数据库的表的数量，以服务器启动开始.</strong></li>
<li><strong>Queries per second avg：select语句平均查询时间 Memory in use分配的内存(只有在MySQL用–withdebug编译时可用) Max memory used分配的最大内存(只有在MySQL用–with-debug编译时可用)</strong></li>
</ul>
<h3 id="（3）processlist">（3）processlist</h3>
<p><strong>获取数据库当前连接信息</strong></p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><code class="hljs shell">[root@mysql ~]# mysqladmin -uroot -p  processlist<br>Enter password: <br>+----+------+-----------+---------+---------+------+----------+------------------+<br>| Id | User | Host      | db      | Command | Time | State    | Info             |<br>+----+------+-----------+---------+---------+------+----------+------------------+<br>| 32 | root | localhost | test_db | Sleep   | 877  |          |                  |<br>| 40 | root | localhost |         | Query   | 0    | starting | show processlist |<br>+----+------+-----------+---------+---------+------+----------+------------------+<br></code></pre></td></tr></table></figure>
<h3 id="（4）获取数据库当前的连接数">（4）获取数据库当前的连接数</h3>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs shell">[root@mysql ~]# mysql -uroot -p -BNe "select host,count(host) from processlist group by host" information_schema<br>Enter password: <br>localhost	2<br></code></pre></td></tr></table></figure>
<h3 id="（5）显示mysql的启动时长">（5）显示mysql的启动时长</h3>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs shell">[root@mysql ~]# mysql -uroot -p123 -e "SHOW STATUS LIKE '%uptime%'" | awk '/ptime/&#123; calc = $NF/3600;print $(NF-1), calc"Hour"&#125;'<br><br>Uptime 1.005Hour<br>Uptime_since_flush_status 1.005Hour<br></code></pre></td></tr></table></figure>
<h3 id="（6）查看数据库所有库大小">（6）查看数据库所有库大小</h3>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><code class="hljs shell">[root@mysql ~]# mysql -uroot -p123 -e 'select table_schema,round(sum(data_length+index_length)/1024/1024,4) from information_schema.tables group by table_schema'<br><br>+--------------------+--------------------------------------------------+<br>| table_schema       | round(sum(data_length+index_length)/1024/1024,4) |<br>+--------------------+--------------------------------------------------+<br>| information_schema |                                           0.1563 |<br>| mysql              |                                           2.4425 |<br>| performance_schema |                                           0.0000 |<br>| sys                |                                           0.0156 |<br>| test_db            |                                           0.0156 |<br>+--------------------+--------------------------------------------------+<br></code></pre></td></tr></table></figure>
<h3 id="（7）processlist获取当前数据库的连接线程信息：-监控mysql进程运行状态："><strong>（7）processlist获取当前数据库的连接线程信息： 监控mysql进程运行状态：</strong></h3>
<p><strong>上面的这三个功能在一些简单监控脚本中经常使用到的.mysqladmin其他参数选项可以通过执行“mysqladmin–help”或man mysqladmin得到帮助信息.编写一个简单的mysql监控脚本，内容如下：</strong></p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><code class="hljs shell"><span class="hljs-meta">#</span><span class="bash">!/bin/bash</span><br><span class="hljs-meta">#</span><span class="bash">监测服务是否正常</span><br>mysqladmin -uroot -p123 -h localhost ping<br><span class="hljs-meta">#</span><span class="bash">获取mysql当前状态值</span><br>mysqladmin -uroot -p123 -h localhost status<br><span class="hljs-meta">#</span><span class="bash">获取数据库当前连接信息</span><br>mysqladmin -uroot -p123 -h localhost processlist<br><span class="hljs-meta">#</span><span class="bash">获取数据库当前的连接数</span><br>mysql -uroot -p123 -BNe "select host,count(host) from processlist group by host" information_schema<br><span class="hljs-meta">#</span><span class="bash">显示mysql的启动时长</span><br>mysql -uroot -p123 -e "SHOW STATUS LIKE '%uptime%'" | awk '/ptime/&#123; calc = $NF/3600;print $(NF-1), calc"Hour"&#125;'<br><span class="hljs-meta">#</span><span class="bash">查看数据库所有库大小</span><br>mysql -uroot -p123 -e 'select table_schema,round(sum(data_length+index_length)/1024/1024,4) from information_schema.tables group by table_schema'<br></code></pre></td></tr></table></figure>
<h1>五、mysqldump</h1>
<p><strong>这个工具其功能就是将MySQL Server中的数据以SQL 语句的形式从数据库中dump 成文本文件。mysqldump是做为MySQL 的一种逻辑备份工具，在我之前的博文中有这个工具的使用方法：<a href="https://blog.51cto.com/14154700/2395340" target="_blank" rel="noopener">MySQL的备份与恢复详解</a></strong></p>
<h1>六、mysqlbinlog</h1>
<p><strong>mysqlbinlog程序的主要功能就是分析MySQL Server 所产生的二进制日志（也就是binlog）。</strong><br>
<strong>通过mysqlbinlog，我们可以解析出binlog中指定时间段或者指定日志起始和结束位置的内容解析成SQL 语句。</strong></p>
<h1>七、Mysqlslap性能测试</h1>
<p><strong>MySQL二种存储引擎 mysqlslap是mysql自带的基准测试工具,优点:查询数据,语法简单,灵活容易使用.该工具可以模拟多个客户端同时并发的向服务器发出查询更新,给出了性能测试数据而且提供了多种引擎的性能比较.mysqlslap为mysql性能优化前后提供了直观的验证依据,建议系统运维和DBA人员应该掌握一些常见的压力测试工具,才能准确的掌握线上数据库支撑的用户流量上限及其抗压性等问题.现在看一下这个压力测试工具mysqlslap，关于他的选项手册上以及–help介绍的很详细。</strong></p>
<h4 id="这里解释一下一些常用的选项">这里解释一下一些常用的选项</h4>
<ul>
<li><strong>–concurrency代表并发数量，多个可以用逗号隔开。例如：concurrency=50,100,200 --engines代表要测试的引</strong><br>
<strong>擎，可以有多个，用分隔符隔开。</strong></li>
<li><strong>–iterations代表要运行这些测试多少次，即运行多少次后，得到结果。</strong></li>
<li><strong>–auto-generate-sql 代表用系统自己生成的SQL脚本来测试。</strong></li>
<li><strong>–auto-generate-sql-load-type 代表要测试的是读 还是写还是两者混合的（read,write,update,mixed）</strong></li>
<li><strong>–number-of-queries 代表总共要运行多少次查询。每个客户运行的查询数量可以用查询总数/并发数来计算。比如倒数第二个结果2=200/100。</strong></li>
<li><strong>–debug-info 代表要额外输出CPU以及内存的相关信息（注：只有在MySQL用–with-debug编译时可）。</strong></li>
<li><strong>–number-int-cols 代表测试表中的INTEGER类型的属性有几个。</strong></li>
<li><strong>–number-char-cols代表测试表的char类型字段的数量。</strong></li>
<li><strong>–create-schema 代表自己定义的模式（在MySQL中也就是库即创建测试的数据库）。</strong></li>
<li><strong>–query 代表自己的SQL脚本。</strong></li>
<li><strong>–only-print如果只想打印看看SQL语句是什么，可以用这个选项。</strong></li>
<li><strong>–csv=name 生产CSV格式数据文件 查看Mysql数据库默认最大连接数</strong></li>
</ul>
<h2 id="（1）查看Mysql数据库默认最大连接数">（1）查看Mysql数据库默认最大连接数</h2>
<p><strong>可以看到mysql5.7.13默认是151。注：不同版本默认最大连接数不差别。一般生产环境是不够的。</strong></p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><code class="hljs mysql">mysql&gt; show variables like &#39;%max_connections%&#39;;<br>+-----------------+-------+<br>| Variable_name   | Value |<br>+-----------------+-------+<br>| max_connections | 151   |<br>+-----------------+-------+<br>1 row in set (0.00 sec)<br></code></pre></td></tr></table></figure>
<p><strong>注：不同版本默认最大连接数不差别。一般生产环境是不够的</strong></p>
<h2 id="2、修改MySQL数据库默认最大连接数">2、修改MySQL数据库默认最大连接数</h2>
<h4 id="方法一">方法一</h4>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><code class="hljs mysql">mysql&gt; set GLOBAL max_connections &#x3D; 1024;<br>Query OK, 0 rows affected (0.00 sec)<br>mysql&gt; show variables like &#39;%max_connections%&#39;;<br>+-----------------+-------+<br>| Variable_name   | Value |<br>+-----------------+-------+<br>| max_connections | 1024  |<br>+-----------------+-------+<br>1 row in set (0.00 sec)<br></code></pre></td></tr></table></figure>
<h4 id="方法二">方法二</h4>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><code class="hljs mysql">在my.cnf[mysqld]下添加 <br>max_connections&#x3D;1024 #增加到1024<br>重启Mysql.<br><br>总结：修改my.cnf文件并重启mysqld服务<br></code></pre></td></tr></table></figure>
<h2 id="3、查看Mysql默认使用存储引擎，">3、查看Mysql默认使用存储引擎，</h2>
<p><strong>如下查看： <code>mysql&gt; show engines;</code></strong></p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><code class="hljs mysql">mysql&gt; show engines;<br>+--------------------+---------+----------------------------------------------------------------+--------------+------+------------+<br>| Engine             | Support | Comment                                                        | Transactions | XA   | Savepoints |<br>+--------------------+---------+----------------------------------------------------------------+--------------+------+------------+<br>| InnoDB             | DEFAULT | Supports transactions, row-level locking, and foreign keys     | YES          | YES  | YES        |<br>| CSV                | YES     | CSV storage engine                                             | NO           | NO   | NO         |<br>| MyISAM             | YES     | MyISAM storage engine                                          | NO           | NO   | NO         |<br>| BLACKHOLE          | YES     | &#x2F;dev&#x2F;null storage engine (anything you write to it disappears) | NO           | NO   | NO         |<br>| PERFORMANCE_SCHEMA | YES     | Performance Schema                                             | NO           | NO   | NO         |<br>| MRG_MYISAM         | YES     | Collection of identical MyISAM tables                          | NO           | NO   | NO         |<br>| ARCHIVE            | YES     | Archive storage engine                                         | NO           | NO   | NO         |<br>| MEMORY             | YES     | Hash based, stored in memory, useful for temporary tables      | NO           | NO   | NO         |<br>| FEDERATED          | NO      | Federated MySQL storage engine                                 | NULL         | NULL | NULL       |<br>+--------------------+---------+----------------------------------------------------------------+--------------+------+------------+<br>9 rows in set (0.00 sec)<br></code></pre></td></tr></table></figure>
<h2 id="4、测试">4、测试</h2>
<p><strong>现在我们来看一下具体测试的例子。</strong></p>
<h3 id="1）用自带的SQL脚本来测试">1）用自带的SQL脚本来测试</h3>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br></pre></td><td class="code"><pre><code class="hljs mysql">[root@mysql ~]# mysqlslap --defaults-file&#x3D;&#x2F;etc&#x2F;my.cnf --concurrency&#x3D;100,200 --iterations&#x3D;1 --number-int-cols&#x3D;20 --number-char-cols&#x3D;30 --auto-generate-sql --auto-generate-sql-add-autoincrement --auto-generate-sql-load-type&#x3D;mixed --engine&#x3D;myisam,innodb --number-of-queries&#x3D;2000 -uroot -p123 --verbose<br><br>Benchmark<br>trueRunning for engine myisam<br>trueAverage number of seconds to run all queries: 0.330 seconds<br>trueMinimum number of seconds to run all queries: 0.330 seconds<br>trueMaximum number of seconds to run all queries: 0.330 seconds<br>trueNumber of clients running queries: 100<br>trueAverage number of queries per client: 20<br><br>Benchmark<br>trueRunning for engine myisam<br>trueAverage number of seconds to run all queries: 0.341 seconds<br>trueMinimum number of seconds to run all queries: 0.341 seconds<br>trueMaximum number of seconds to run all queries: 0.341 seconds<br>trueNumber of clients running queries: 200<br>trueAverage number of queries per client: 10<br><br>Benchmark<br>trueRunning for engine innodb<br>trueAverage number of seconds to run all queries: 0.610 seconds<br>trueMinimum number of seconds to run all queries: 0.610 seconds<br>trueMaximum number of seconds to run all queries: 0.610 seconds<br>trueNumber of clients running queries: 100<br>trueAverage number of queries per client: 20<br><br>Benchmark<br>trueRunning for engine innodb<br>trueAverage number of seconds to run all queries: 0.457 seconds<br>trueMinimum number of seconds to run all queries: 0.457 seconds<br>trueMaximum number of seconds to run all queries: 0.457 seconds<br>trueNumber of clients running queries: 200<br>trueAverage number of queries per client: 10<br></code></pre></td></tr></table></figure>
<h6 id="测试说明">测试说明</h6>
<figure class="highlight tex"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs tex">模拟测试两次读写并发，第一次100，第二次200，自动生成SQL脚本，测试表包含20个init字段，30个char字段，每次执行2000查询请求。测试引擎分别是myisam，innodb。<br></code></pre></td></tr></table></figure>
<h6 id="测试结果说明">测试结果说明</h6>
<figure class="highlight tex"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs tex">Myisam第一次100客户端同时发起增查用1.459/s,第二次200客户端同时发起增查用1.420/s<br>Innodb第一次100客户端同时发起增查用1.352/s,第二次200客户端同时发起增查用2.330/s<br></code></pre></td></tr></table></figure>
<h6 id="测试结论">测试结论</h6>
<figure class="highlight tex"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs tex">由此可见MyISAM存储引擎处理性能是最好的，也是最常用的，但不支持事务。<br>InonDB存储引擎提供了事务型数据引擎（ACID），在事务型引擎里使用最多的。具有事务回滚，系统修复等特点。<br></code></pre></td></tr></table></figure>
<h3 id="2）测试结果保存为csv文件">2）测试结果保存为csv文件</h3>
<p><strong>Mysqlslap测试工具生产CSV格式数据文件并转换成图表形式：</strong></p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs shell">[root@mysql ~]# mysqlslap --defaults-file=/etc/my.cnf --concurrency=100,200 --iterations=1 --number-int-cols=20 --number-char-cols=30 --auto-generate-sql --auto-generate-sql-add-autoincrement --auto-generate-sql-load-type=mixed --engine=myisam,innodb --number-of-queries=2000 -uroot -p123 --csv=/root/a.csv<br></code></pre></td></tr></table></figure>
<p><strong>将/root/a.csv拷贝到windows主机上，打开并生成图表</strong></p>
<p><img src="https://gitee.com/xgpqq/tuchuang/raw/master/img/image-20200618175243042.png" alt="image-20200618175243042"></p>
<h3 id="3）使用自定义sql脚本测试">3）使用自定义sql脚本测试</h3>
<p><strong>用我们自己定义的SQL 脚本或语句来测试 首先准备好要测试的数据库表，这里我们编写一个生成表的脚本去完成 脚本内容如下：</strong></p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><code class="hljs shell">[root@mysql ~]# cat /root/mysql3.sh<br><span class="hljs-meta">#</span><span class="bash">!/bin/bash</span><br>HOSTNAME="localhost"<br>PORT="3306"<br>USERNAME="root"<br>PASSWORD="123"<br>DBNAME="test1"<br>TABLENAME="tb1"<br><span class="hljs-meta">#</span><span class="bash">create database</span><br>mysql -h $&#123;HOSTNAME&#125; -P $&#123;PORT&#125; -u $&#123;USERNAME&#125; -p$&#123;PASSWORD&#125; -e "drop database if exists $&#123;DBNAME&#125;" create_db_sql="create database if not exists $&#123;DBNAME&#125;"<br>mysql -h $&#123;HOSTNAME&#125; -P $&#123;PORT&#125; -u $&#123;USERNAME&#125; -p$&#123;PASSWORD&#125; -e "$&#123;create_db_sql&#125;"<br><span class="hljs-meta">#</span><span class="bash">create table</span><br>create_table_sql="create table if not exists $&#123;TABLENAME&#125;(stuid int not null primary key,stuname varchar(20) not null,stusex char(1) not null,cardid varchar(20) not null,birthday datetime,entertime datetime,address varchar(100) default null)"<br>mysql -h $&#123;HOSTNAME&#125; -P $&#123;PORT&#125; -u $&#123;USERNAME&#125; -p$&#123;PASSWORD&#125; $&#123;DBNAME&#125; -e "$&#123;create_table_sql&#125;"<br><span class="hljs-meta">#</span><span class="bash">insert data to table</span><br>i=1<br>while [ $i -le 20000 ]<br>do<br>insert_sql="insert into $&#123;TABLENAME&#125; values($i,'zhangsan','1','1234567890123456','1999-10-10','2016-9-3','zhongguo beijingshi changpinqu')"<br>mysql -h $&#123;HOSTNAME&#125; -P $&#123;PORT&#125; -u $&#123;USERNAME&#125; -p$&#123;PASSWORD&#125; $&#123;DBNAME&#125; -e "$&#123;insert_sql&#125;"<br>let i++<br>done<br><span class="hljs-meta">#</span><span class="bash">select data</span><br>select_sql="select count(*) from $&#123;TABLENAME&#125;"<br>mysql -h $&#123;HOSTNAME&#125; -P $&#123;PORT&#125; -u $&#123;USERNAME&#125; -p$&#123;PASSWORD&#125; $&#123;DBNAME&#125; -e "$&#123;select_sql&#125;"<br></code></pre></td></tr></table></figure>
<p><strong>授权脚本x执行权限</strong></p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs shell">[root@192 opt]# chmod +x mysql_test.sh<br></code></pre></td></tr></table></figure>
<h4 id="执行脚本mysql3-sh生成mysqlslap工具需要的测试表">执行脚本mysql3.sh生成mysqlslap工具需要的测试表</h4>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs shell">[root@mysql ~]# /root/mysql3.sh<br><br>执行mysqlslap工具进行测试<br>[root@mysql ~]# mysqlslap --defaults-file=/etc/my.cnf --concurrency=10,20 --iterations=1 --create-schema='test1' --query='select * from test1.tb1' --engine=myisam,innodb --number-of-queries=2000 -uroot -p123 –verbose<br></code></pre></td></tr></table></figure>
<h5 id="显示结果：">显示结果：</h5>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br></pre></td><td class="code"><pre><code class="hljs mysql">[root@192 opt]# mysqlslap --defaults-file&#x3D;&#x2F;etc&#x2F;my.cnf --concurrency&#x3D;10,20 --iterations&#x3D;1 --create-schema&#x3D;&#39;test1&#39; --query&#x3D;&#39;select * from test1.tb1&#39; --engine&#x3D;myisam,innodb --number-of-queries&#x3D;2000 -uroot -p1234 –verbose<br>mysqlslap: [Warning] Using a password on the command line interface can be insecure.<br>Benchmark<br>        Running for engine myisam<br>        Average number of seconds to run all queries: 3.261 seconds<br>        Minimum number of seconds to run all queries: 3.261 seconds<br>        Maximum number of seconds to run all queries: 3.261 seconds<br>        Number of clients running queries: 10<br>        Average number of queries per client: 200<br><br>Benchmark<br>        Running for engine myisam<br>        Average number of seconds to run all queries: 3.010 seconds<br>        Minimum number of seconds to run all queries: 3.010 seconds<br>        Maximum number of seconds to run all queries: 3.010 seconds<br>        Number of clients running queries: 20<br>        Average number of queries per client: 100<br><br>Benchmark<br>        Running for engine innodb<br>        Average number of seconds to run all queries: 3.421 seconds<br>        Minimum number of seconds to run all queries: 3.421 seconds<br>        Maximum number of seconds to run all queries: 3.421 seconds<br>        Number of clients running queries: 10<br>        Average number of queries per client: 200<br><br>Benchmark<br>        Running for engine innodb<br>        Average number of seconds to run all queries: 3.252 seconds<br>        Minimum number of seconds to run all queries: 3.252 seconds<br>        Maximum number of seconds to run all queries: 3.252 seconds<br>        Number of clients running queries: 20<br>        Average number of queries per client: 100<br></code></pre></td></tr></table></figure>
<p><strong>注：通过mysqlslap工具对mysql server进行压力测试，可以通过–concurrency、–number-of-queries等选项的值查看每次测试的结果，通过反复测试、优化得出mysql server的最大并发数.如果mysqlslap工具输出结果为Segmentation fault (core dumped)基本表示走超出mysql server的负载。</strong></p>
</div><div class="post-copyright"><div class="post-copyright__author"><span class="post-copyright-meta">文章作者: </span><span class="post-copyright-info"><a href="mailto:undefined">Wu Shao Dong</a></span></div><div class="post-copyright__type"><span class="post-copyright-meta">文章链接: </span><span class="post-copyright-info"><a href="https://wsdlxgp.top/posts/f96f.html">https://wsdlxgp.top/posts/f96f.html</a></span></div><div class="post-copyright__notice"><span class="post-copyright-meta">版权声明: </span><span class="post-copyright-info">本博客所有文章除特别声明外，均采用 <a href="https://creativecommons.org/licenses/by-nc-sa/4.0/" target="_blank">CC BY-NC-SA 4.0</a> 许可协议。转载请注明来自 <a href="https://wsdlxgp.top" target="_blank">Xgp & Blog</a>！</span></div></div><div class="tag_share"><div class="post-meta__tag-list"><a class="post-meta__tags" href="/tags/sql%E7%BB%93%E6%9E%84%E5%8C%96%E6%9F%A5%E8%AF%A2%E8%AF%AD%E5%8F%A5/">sql结构化查询语句</a><a class="post-meta__tags" href="/tags/%E6%95%B0%E5%80%BC%E7%B1%BB%E5%9E%8B/">数值类型</a></div><div class="post_share"><div class="social-share" data-image="https://gitee.com/xgpqq/tuchuang/raw/master/img/5 (120).jpg" data-sites="facebook,twitter,wechat,weibo,qq"></div><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/social-share.js/dist/css/share.min.css"/><script src="https://cdn.jsdelivr.net/npm/social-share.js/dist/js/social-share.min.js"></script></div></div><div class="post-reward"><a class="reward-button button--primary button--animated"> <i class="fa fa-qrcode"></i> 打赏<div class="reward-main"><ul class="reward-all"><li class="reward-item"><img class="post-qr-code__img" src="http://xgp-cunchu.test.upcdn.net/k8s/3.jpg" alt="微信"/><div class="post-qr-code__desc">微信</div></li><li class="reward-item"><img class="post-qr-code__img" src="http://xgp-cunchu.test.upcdn.net/k8s/1.jpg" alt="支付寶"/><div class="post-qr-code__desc">支付寶</div></li><li class="reward-item"><img class="post-qr-code__img" src="http://xgp-cunchu.test.upcdn.net/k8s/2.jpg" alt="QQ支付"/><div class="post-qr-code__desc">QQ支付</div></li></ul></div></a></div><nav class="pagination_post" id="pagination"><div class="next-post pull-full"><a href="/posts/80a7.html"><img class="next_cover" src="https://gitee.com/xgpqq/tuchuang/raw/master/img/5 (114).jpg" onerror="onerror=null;src='/img/404.jpg'"><div class="pagination-info"><div class="label">下一篇</div><div class="next_info">MySQL数据文件介绍及存放位置</div></div></a></div></nav><div class="relatedPosts"><div class="relatedPosts_headline"><i class="fa fa-fw fa-thumbs-up" aria-hidden="true"></i><span> 相关推荐</span></div><div class="relatedPosts_list"><div class="relatedPosts_item"><a href="/posts/b19d.html" title="MySQL子查询"><img class="relatedPosts_cover" src="https://gitee.com/xgpqq/tuchuang/raw/master/img/5 (100).jpg"><div class="relatedPosts_main is-center"><div class="relatedPosts_date"><i class="fa fa-history fa-fw" aria-hidden="true"></i> 2020-06-19</div><div class="relatedPosts_title">MySQL子查询</div></div></a></div><div class="relatedPosts_item"><a href="/posts/8338.html" title="MySQL索引"><img class="relatedPosts_cover" src="https://gitee.com/xgpqq/tuchuang/raw/master/img/5 (102).jpg"><div class="relatedPosts_main is-center"><div class="relatedPosts_date"><i class="fa fa-history fa-fw" aria-hidden="true"></i> 2020-06-19</div><div class="relatedPosts_title">MySQL索引</div></div></a></div><div class="relatedPosts_item"><a href="/posts/a0ec.html" title="MySQL视图"><img class="relatedPosts_cover" src="https://gitee.com/xgpqq/tuchuang/raw/master/img/5 (101).jpg"><div class="relatedPosts_main is-center"><div class="relatedPosts_date"><i class="fa fa-history fa-fw" aria-hidden="true"></i> 2020-06-19</div><div class="relatedPosts_title">MySQL视图</div></div></a></div><div class="relatedPosts_item"><a href="/posts/40d5.html" title="MySQL 事务(2)"><img class="relatedPosts_cover" src="https://gitee.com/xgpqq/tuchuang/raw/master/img/5 (104).jpg"><div class="relatedPosts_main is-center"><div class="relatedPosts_date"><i class="fa fa-history fa-fw" aria-hidden="true"></i> 2020-06-19</div><div class="relatedPosts_title">MySQL 事务(2)</div></div></a></div><div class="relatedPosts_item"><a href="/posts/22c1.html" title="MySQL用户管理（1）"><img class="relatedPosts_cover" src="https://gitee.com/xgpqq/tuchuang/raw/master/img/5 (105).jpg"><div class="relatedPosts_main is-center"><div class="relatedPosts_date"><i class="fa fa-history fa-fw" aria-hidden="true"></i> 2020-06-19</div><div class="relatedPosts_title">MySQL用户管理（1）</div></div></a></div><div class="relatedPosts_item"><a href="/posts/b0d5.html" title="MySQL 事务(1)"><img class="relatedPosts_cover" src="https://gitee.com/xgpqq/tuchuang/raw/master/img/5 (103).jpg"><div class="relatedPosts_main is-center"><div class="relatedPosts_date"><i class="fa fa-history fa-fw" aria-hidden="true"></i> 2020-06-19</div><div class="relatedPosts_title">MySQL 事务(1)</div></div></a></div></div><div class="clear_both"></div></div><hr><div id="post-comment"><div class="comment_headling"><i class="fa fa-comments fa-fw" aria-hidden="true"></i><span> 评论</span></div><div id="lv-container" data-id="city" data-uid="MTAyMC80OTM0NS8yNTgzNw=="><script>(function(d, s) {
    var j, e = d.getElementsByTagName(s)[0];
    if (typeof LivereTower === 'function') { return; }
    j = d.createElement(s);
    j.src = 'https://cdn-city.livere.com/js/embed.dist.js';
    j.async = true;
    e.parentNode.insertBefore(j, e);
})(document, 'script');</script></div></div></article></main><footer id="footer" style="background-image: url(https://gitee.com/xgpqq/tuchuang/raw/master/img/325738.jpg)" data-type="photo"><div id="footer-wrap"><div class="copyright">&copy;2019 - 2020 By Wu Shao Dong</div><div class="framework-info"><span>驱动 </span><a href="https://hexo.io" target="_blank" rel="noopener"><span>Hexo</span></a><span class="footer-separator">|</span><span>主题 </span><a href="https://github.com/jerryc127/hexo-theme-butterfly" target="_blank" rel="noopener"><span>Butterfly</span></a></div><div class="ypy"><a href="https://console.upyun.com/services/file/" target="_blank" rel="noopener"><img class="icp-icon" src="/img/1591433700(1).png"/><span></span></a></div></div></footer></div><section class="rightside" id="rightside"><div id="rightside-config-hide"><i class="fa fa-book" id="readmode" title="阅读模式"></i><i class="fa fa-plus" id="font_plus" title="放大字体"></i><i class="fa fa-minus" id="font_minus" title="缩小字体"></i><a class="translate_chn_to_cht" id="translateLink" href="javascript:translatePage();" title="简繁转换" target="_self">繁</a><i class="darkmode far fa-moon" id="darkmode" title="夜间模式"></i></div><div id="rightside-config-show"><div id="rightside_config" title="设置"><i class="fa fa-cog" aria-hidden="true"></i></div><a id="to_comment" href="#post-comment" title="直达评论"><i class="scroll_to_comment fa fa-comments">  </i></a><i class="fa fa-list-ul close" id="mobile-toc-button" title="目录" aria-hidden="true"></i><i class="fa fa-arrow-up" id="go-up" title="回到顶部" aria-hidden="true"></i></div></section><div class="search-dialog" id="local-search"><div class="search-dialog__title" id="local-search-title">本地搜索</div><div id="local-input-panel"><div id="local-search-input"><div class="local-search-box"><input class="local-search-box--input" placeholder="搜索文章" type="text"/></div></div></div><hr/><div id="local-search-results"><div id="local-hits"></div><div id="local-stats"><div class="local-search-stats__hr" id="hr"><span>由</span> <a href="https://github.com/wzpan/hexo-generator-search" target="_blank" rel="noopener" style="color:#49B1F5;">hexo-generator-search</a>
 <span>提供支持</span></div></div></div><span class="search-close-button"><i class="fa fa-times"></i></span></div><div class="search-mask"></div><script src="https://cdn.jsdelivr.net/npm/jquery@latest/dist/jquery.min.js"></script><script src="/js/utils.js"></script><script src="/js/main.js"></script><script src="/js/tw_cn.js"></script><script src="https://cdn.jsdelivr.net/npm/@fancyapps/fancybox@latest/dist/jquery.fancybox.min.js"></script><script src="https://cdn.jsdelivr.net/npm/animejs@latest/anime.min.js"></script><script src="/js/third-party/fireworks.js"></script><script id="ribbon_piao" mobile="false" src="/js/third-party/piao.js"></script><script id="canvas_nest" color="0,0,255" opacity="0.7" zIndex="-1" count="99" mobile="false" src="/js/third-party/canvas-nest.js"></script><script src="/js/third-party/activate-power-mode.js"></script><script>POWERMODE.colorful = true;
POWERMODE.shake = true;
document.body.addEventListener('input', POWERMODE);
</script><script async src="//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script><script src="https://cdn.jsdelivr.net/npm/instant.page@3/instantpage.min.js" type="module"></script><script src="/js/search/local-search.js"></script><script>var endLoading = function () {
  document.body.style.overflow = 'auto';
  document.getElementById('loading-box').classList.add("loaded")
}
window.addEventListener('load',endLoading)</script><script src="/live2dw/lib/L2Dwidget.min.js?094cbace49a39548bed64abff5988b05"></script><script>L2Dwidget.init({"log":false,"pluginJsPath":"lib/","pluginModelPath":"assets/","pluginRootPath":"live2dw/","tagMode":false});</script></body></html>