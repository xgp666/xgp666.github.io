<!DOCTYPE html><html lang="zh-CN" data-theme="light"><head><meta charset="UTF-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width,initial-scale=1"><title>Python监控Linux系统（1） | Xgp &amp; Blog</title><meta name="description" content="一、使用开源库监控Linux 在这一小节，我们将介绍一个在Python生态中广泛使用的开源项目，即psutil。随后，我们将使用psutil重构前一小节编写的监控程序。另外，还会简单介绍psutil提供的进程管理功能。 1、psutil介绍  psutil &#x3D; process and system utilities   psutil是一个开源且跨平台的库，其提供了便利的函数用来获取操作系统的信息"><meta name="keywords" content="nfs,pv,pvc,Storage Class,dashboard,helm,deployment"><meta name="author" content="Wu Shao Dong"><meta name="copyright" content="Wu Shao Dong"><meta name="format-detection" content="telephone=no"><link rel="shortcut icon" href="https://gitee.com/xgpqq/tuchuang/raw/master/img/Yun.png"><meta http-equiv="Cache-Control" content="no-transform"><meta http-equiv="Cache-Control" content="no-siteapp"><link rel="preconnect" href="//cdn.jsdelivr.net"/><link rel="dns-prefetch" href="//cdn.jsdelivr.net"/><link rel="preconnect" href="https://hm.baidu.com"/><link rel="dns-prefetch" href="https://hm.baidu.com"/><link rel="preconnect" href="https://fonts.googleapis.com" crossorigin="crossorigin"/><link rel="dns-prefetch" href="https://fonts.googleapis.com"/><link rel="preconnect" href="//busuanzi.ibruce.info"/><link rel="dns-prefetch" href="//busuanzi.ibruce.info"/><meta name="baidu-site-verification" content="rPK0WSwqdm"/><meta name="twitter:card" content="summary"><meta name="twitter:title" content="Python监控Linux系统（1）"><meta name="twitter:description" content="一、使用开源库监控Linux 在这一小节，我们将介绍一个在Python生态中广泛使用的开源项目，即psutil。随后，我们将使用psutil重构前一小节编写的监控程序。另外，还会简单介绍psutil提供的进程管理功能。 1、psutil介绍  psutil &#x3D; process and system utilities   psutil是一个开源且跨平台的库，其提供了便利的函数用来获取操作系统的信息"><meta name="twitter:image" content="https://gitee.com/xgpqq/tuchuang/raw/master/img/qweq72p.jpg"><meta property="og:type" content="article"><meta property="og:title" content="Python监控Linux系统（1）"><meta property="og:url" content="https://wsdlxgp.top/posts/54c9.html"><meta property="og:site_name" content="Xgp &amp; Blog"><meta property="og:description" content="一、使用开源库监控Linux 在这一小节，我们将介绍一个在Python生态中广泛使用的开源项目，即psutil。随后，我们将使用psutil重构前一小节编写的监控程序。另外，还会简单介绍psutil提供的进程管理功能。 1、psutil介绍  psutil &#x3D; process and system utilities   psutil是一个开源且跨平台的库，其提供了便利的函数用来获取操作系统的信息"><meta property="og:image" content="https://gitee.com/xgpqq/tuchuang/raw/master/img/qweq72p.jpg"><meta property="article:published_time" content="2019-09-13T16:27:00.000Z"><meta property="article:modified_time" content="2020-06-30T06:55:31.070Z"><script src="https://cdn.jsdelivr.net/npm/js-cookie/dist/js.cookie.min.js"></script><script>var autoChangeMode = '1'
var t = Cookies.get("theme")
if (autoChangeMode == '1'){
  var isDarkMode = window.matchMedia("(prefers-color-scheme: dark)").matches
  var isLightMode = window.matchMedia("(prefers-color-scheme: light)").matches
  var isNotSpecified = window.matchMedia("(prefers-color-scheme: no-preference)").matches
  var hasNoSupport = !isDarkMode && !isLightMode && !isNotSpecified

  if (t === undefined){
    if (isLightMode) activateLightMode()
    else if (isDarkMode) activateDarkMode()
    else if (isNotSpecified || hasNoSupport){
      console.log('You specified no preference for a color scheme or your browser does not support it. I Schedule dark mode during night time.')
      var now = new Date()
      var hour = now.getHours()
      var isNight = hour < 6 || hour >= 18
      isNight ? activateDarkMode() : activateLightMode()
  }
  } else if (t == 'light') activateLightMode()
  else activateDarkMode()

} else if (autoChangeMode == '2'){
  now = new Date();
  hour = now.getHours();
  isNight = hour < 6 || hour >= 18
  if(t === undefined) isNight? activateDarkMode() : activateLightMode()
  else if (t === 'light') activateLightMode()
  else activateDarkMode() 
} else {
  if ( t == 'dark' ) activateDarkMode()
  else if ( t == 'light') activateLightMode()
}

function activateDarkMode(){
  document.documentElement.setAttribute('data-theme', 'dark')
  if (document.querySelector('meta[name="theme-color"]') !== null){
    document.querySelector('meta[name="theme-color"]').setAttribute('content','#000')
  }
}
function activateLightMode(){
  document.documentElement.setAttribute('data-theme', 'light')
  if (document.querySelector('meta[name="theme-color"]') !== null){
  document.querySelector('meta[name="theme-color"]').setAttribute('content','#fff')
  }
}</script><link rel="stylesheet" href="/css/index.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free/css/all.min.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fancyapps/fancybox@latest/dist/jquery.fancybox.min.css"><link rel="canonical" href="https://wsdlxgp.top/posts/54c9.html"><link rel="prev" title="python的文件处理" href="https://wsdlxgp.top/posts/e80d.html"><link rel="next" title="Python监控Linux系统（2）" href="https://wsdlxgp.top/posts/10c9.html"><script>var _hmt = _hmt || [];
(function() {
  var hm = document.createElement("script");
  hm.src = "https://hm.baidu.com/hm.js?cad0cd04042fcca2c687648c42a45fc9";
  var s = document.getElementsByTagName("script")[0]; 
  s.parentNode.insertBefore(hm, s);
})();
</script><link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Titillium+Web"><script>var GLOBAL_CONFIG = { 
  root: '/',
  algolia: undefined,
  localSearch: {"path":"search.xml","languages":{"hits_empty":"找不到您查询的内容:${query}"}},
  translate: {"defaultEncoding":2,"translateDelay":0,"cookieDomain":"https://xxx/","msgToTraditionalChinese":"繁","msgToSimplifiedChinese":"簡"},
  copy: {
    success: '复制成功',
    error: '复制错误',
    noSupport: '浏览器不支持'
  },
  bookmark: {
    message_prev: '按',
    message_next: '键将本页加入书签'
  },
  runtime_unit: '天',
  runtime: true,
  copyright: undefined,
  ClickShowText: undefined,
  medium_zoom: false,
  fancybox: true,
  Snackbar: undefined,
  baiduPush: false,
  highlightCopy: true,
  highlightLang: true,
  highlightShrink: 'false',
  isFontAwesomeV5: true,
  isPhotoFigcaption: false,
  islazyload: false,
  isanchor: false
  
}</script><script>var GLOBAL_CONFIG_SITE = { 
  isPost: true,
  isHome: false,
  isSidebar: true  
  }</script><noscript><style>
#page-header {
  opacity: 1
}
.justified-gallery img{
  opacity: 1
}
</style></noscript><meta name="generator" content="Hexo 4.2.0"><link rel="alternate" href="/atom.xml" title="Xgp & Blog" type="application/atom+xml">
</head><body><div id="loading-box"><div class="loading-left-bg"></div><div class="loading-right-bg"></div><div class="spinner-box"><div class="configure-border-1"><div class="configure-core"></div></div><div class="configure-border-2"><div class="configure-core"></div></div><div class="loading-word">加载中...</div></div></div><canvas class="fireworks"></canvas><div id="mobile-sidebar"><div id="menu_mask"></div><div id="mobile-sidebar-menus"><div class="mobile_author_icon"><img class="avatar-img" src="https://gitee.com/xgpqq/tuchuang/raw/master/img/666.jpg" onerror="onerror=null;src='/img/friend_404.gif'" alt="avatar"/></div><div class="mobile_post_data"><div class="mobile_data_item is-center"><div class="mobile_data_link"><a href="/archives/"><div class="headline">文章</div><div class="length_num">125</div></a></div></div><div class="mobile_data_item is-center">      <div class="mobile_data_link"><a href="/tags/"><div class="headline">标签</div><div class="length_num">84</div></a></div></div><div class="mobile_data_item is-center">     <div class="mobile_data_link"><a href="/categories/"><div class="headline">分类</div><div class="length_num">4</div></a></div></div></div><hr/><div class="menus_items"><div class="menus_item"><a class="site-page" href="/"><i class="fa-fw fa fa-home"></i><span> 主页</span></a></div><div class="menus_item"><a class="site-page" href="/archives/"><i class="fa-fw fa fa-archive"></i><span> 归档</span></a></div><div class="menus_item"><a class="site-page" href="/tags/"><i class="fa-fw fa fa-tags"></i><span> 标签</span></a></div><div class="menus_item"><a class="site-page" href="/categories/"><i class="fa-fw fa fa-folder-open"></i><span> 分类</span></a></div><div class="menus_item"><a class="site-page" href="/link/"><i class="fa-fw fa fa-link"></i><span> 链接</span></a></div><div class="menus_item"><a class="site-page" href="/about/"><i class="fa-fw fa fa-heart"></i><span> 我</span></a></div><div class="menus_item"><a class="site-page"><i class="fa-fw fa fa-list" aria-hidden="true"></i><span> 其他</span><i class="fa fa-chevron-down menus-expand" aria-hidden="true"></i></a><ul class="menus_item_child"><li><a class="site-page" href="/music/"><i class="fa-fw fa fa-music"></i><span> 音乐</span></a></li><li><a class="site-page" href="/movies/"><i class="fa-fw fa fa-film"></i><span> 视频</span></a></li></ul></div></div></div></div><i class="fa fa-arrow-right on" id="toggle-sidebar" aria-hidden="true">     </i><div id="sidebar"><div class="sidebar-toc"><div class="sidebar-toc__title">目录</div><div class="sidebar-toc__progress"><span class="progress-notice">你已经读了</span><span class="progress-num">0</span><span class="progress-percentage">%</span><div class="sidebar-toc__progress-bar">     </div></div><div class="sidebar-toc__content"><ol class="toc"><li class="toc-item toc-level-1"><a class="toc-link" href="#"><span class="toc-number">1.</span> <span class="toc-text">一、使用开源库监控Linux</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#1、psutil介绍"><span class="toc-number">1.1.</span> <span class="toc-text">1、psutil介绍</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#pip安装psutil"><span class="toc-number">1.1.1.</span> <span class="toc-text">pip安装psutil</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#2、psutil提供的功能函数"><span class="toc-number">1.2.</span> <span class="toc-text">2、psutil提供的功能函数</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#（1）CPU"><span class="toc-number">1.2.1.</span> <span class="toc-text">（1）CPU</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#与CPU相关的功能函数如下："><span class="toc-number">1.2.1.1.</span> <span class="toc-text">与CPU相关的功能函数如下：</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#1）cpu-count"><span class="toc-number">1.2.1.2.</span> <span class="toc-text">1）cpu_count</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#2）cpu-percent"><span class="toc-number">1.2.1.3.</span> <span class="toc-text">2）cpu_percent</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#3）cpu-times"><span class="toc-number">1.2.1.4.</span> <span class="toc-text">3）cpu_times</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#4）cpu-stats"><span class="toc-number">1.2.1.5.</span> <span class="toc-text">4）cpu_stats</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#5）cpu-freq"><span class="toc-number">1.2.1.6.</span> <span class="toc-text">5）cpu_freq</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#（2）内存"><span class="toc-number">1.2.2.</span> <span class="toc-text">（2）内存</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#与内存相关的功能函数如下："><span class="toc-number">1.2.2.1.</span> <span class="toc-text">与内存相关的功能函数如下：</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#1）virtual-memory"><span class="toc-number">1.2.2.2.</span> <span class="toc-text">1）virtual_memory</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#单位转换"><span class="toc-number">1.2.2.3.</span> <span class="toc-text">单位转换</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#运行结果如下所示："><span class="toc-number">1.2.2.3.1.</span> <span class="toc-text">运行结果如下所示：</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#分析一下"><span class="toc-number">1.2.2.3.2.</span> <span class="toc-text">分析一下</span></a></li></ol></li><li class="toc-item toc-level-4"><a class="toc-link" href="#2）swap-memory"><span class="toc-number">1.2.2.4.</span> <span class="toc-text">2）swap_memory</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#（3）磁盘"><span class="toc-number">1.2.3.</span> <span class="toc-text">（3）磁盘</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#1）psutil-disk-io-counters"><span class="toc-number">1.2.3.1.</span> <span class="toc-text">1）psutil.disk_io_counters</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#2）psutil-disk-partitions"><span class="toc-number">1.2.3.2.</span> <span class="toc-text">2）psutil.disk_partitions</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#3）psutil-disk-usage"><span class="toc-number">1.2.3.3.</span> <span class="toc-text">3）psutil.disk_usage</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#（4）网络"><span class="toc-number">1.2.4.</span> <span class="toc-text">（4）网络</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#1）psutil-net-io-counter"><span class="toc-number">1.2.4.1.</span> <span class="toc-text">1）psutil.net_io_counter</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#2）net-connections"><span class="toc-number">1.2.4.2.</span> <span class="toc-text">2）net_connections</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#3）net-if-addrs"><span class="toc-number">1.2.4.3.</span> <span class="toc-text">3）net_if_addrs</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#4）psutil-net-if-stats"><span class="toc-number">1.2.4.4.</span> <span class="toc-text">4）psutil.net_if_stats</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#（5）其他"><span class="toc-number">1.2.5.</span> <span class="toc-text">（5）其他</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#1）users"><span class="toc-number">1.2.5.1.</span> <span class="toc-text">1）users</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#2）boot-time"><span class="toc-number">1.2.5.2.</span> <span class="toc-text">2）boot_time</span></a></li></ol></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#3、综合案例：使用psutil实现监控程序"><span class="toc-number">1.3.</span> <span class="toc-text">3、综合案例：使用psutil实现监控程序</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#执行结果如下"><span class="toc-number">1.3.0.0.1.</span> <span class="toc-text">执行结果如下</span></a></li></ol></li></ol></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#4、psutil进程管理"><span class="toc-number">1.4.</span> <span class="toc-text">4、psutil进程管理</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#1）Process类"><span class="toc-number">1.4.1.</span> <span class="toc-text">1）Process类</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#2）pids"><span class="toc-number">1.4.2.</span> <span class="toc-text">2）pids</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#3）pid-exists"><span class="toc-number">1.4.3.</span> <span class="toc-text">3）pid_exists</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#4）process-iter"><span class="toc-number">1.4.4.</span> <span class="toc-text">4）process_iter</span></a></li></ol></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#"><span class="toc-number">2.</span> <span class="toc-text">二、使用Python监控MongoDB</span></a></li></ol></div></div></div><div id="body-wrap"><div class="post-bg" id="nav" style="background-image: url(https://gitee.com/xgpqq/tuchuang/raw/master/img/qweq72p.jpg)"><div id="page-header"><span class="pull_left" id="blog_name"><a class="blog_title" id="site-name" href="/">Xgp &amp; Blog</a></span><span class="pull_right menus"><div id="search_button"><a class="site-page social-icon search"><i class="fa fa-search fa-fw"></i><span> 搜索</span></a></div><div class="menus_items"><div class="menus_item"><a class="site-page" href="/"><i class="fa-fw fa fa-home"></i><span> 主页</span></a></div><div class="menus_item"><a class="site-page" href="/archives/"><i class="fa-fw fa fa-archive"></i><span> 归档</span></a></div><div class="menus_item"><a class="site-page" href="/tags/"><i class="fa-fw fa fa-tags"></i><span> 标签</span></a></div><div class="menus_item"><a class="site-page" href="/categories/"><i class="fa-fw fa fa-folder-open"></i><span> 分类</span></a></div><div class="menus_item"><a class="site-page" href="/link/"><i class="fa-fw fa fa-link"></i><span> 链接</span></a></div><div class="menus_item"><a class="site-page" href="/about/"><i class="fa-fw fa fa-heart"></i><span> 我</span></a></div><div class="menus_item"><a class="site-page"><i class="fa-fw fa fa-list" aria-hidden="true"></i><span> 其他</span><i class="fa fa-chevron-down menus-expand" aria-hidden="true"></i></a><ul class="menus_item_child"><li><a class="site-page" href="/music/"><i class="fa-fw fa fa-music"></i><span> 音乐</span></a></li><li><a class="site-page" href="/movies/"><i class="fa-fw fa fa-film"></i><span> 视频</span></a></li></ul></div></div><span class="toggle-menu close"><a class="site-page"><i class="fa fa-bars fa-fw" aria-hidden="true"></i></a></span></span></div><div id="post-info"><div id="post-title"><div class="posttitle">Python监控Linux系统（1）</div></div><div id="post-meta"><div class="meta-firstline"><time class="post-meta__date"><span class="post-meta__date-created" title="发表于 2019-09-14 00:27:00"><i class="fa fa-calendar" aria-hidden="true"></i> 发表于 2019-09-14</span><span class="post-meta__separator">|</span><span class="post-meta__date-updated" title="更新于 2020-06-30 14:55:31"><i class="fa fa-history" aria-hidden="true"></i> 更新于 2020-06-30</span></time><span class="post-meta__categories"><span class="post-meta__separator">|</span><i class="fa fa-inbox post-meta__icon" aria-hidden="true"></i><a class="post-meta__categories" href="/categories/python/">python</a></span></div><div class="meta-secondline"> <span class="post-meta-wordcount"><i class="post-meta__icon far fa-file-word" aria-hidden="true"></i><span>字数总计:</span><span class="word-count">4.1k</span><span class="post-meta__separator">|</span><i class="post-meta__icon far fa-clock" aria-hidden="true"></i><span>阅读时长: 17 分钟</span></span></div><div class="meta-thirdline"><span class="post-meta-pv-cv"><span class="post-meta__separator">|</span><i class="fa fa-eye post-meta__icon" aria-hidden="true"> </i><span>阅读量:</span><span id="busuanzi_value_page_pv"></span></span><span class="post-meta-commentcount"></span></div></div></div></div><main class="layout_post" id="content-inner"><article id="post"><div class="post-content" id="article-container"><h1>一、使用开源库监控Linux</h1>
<p><strong>在这一小节，我们将介绍一个在Python生态中广泛使用的开源项目，即psutil。随后，我们将使用psutil重构前一小节编写的监控程序。另外，还会简单介绍psutil提供的进程管理功能。</strong></p>
<h2 id="1、psutil介绍">1、psutil介绍</h2>
<blockquote>
<p>psutil = process and system utilities</p>
</blockquote>
<ul>
<li><strong>psutil是一个开源且跨平台的库，其提供了便利的函数用来获取操作系统的信息，比如CPU，内存，磁盘，网络等。此外，psutil还可以用来进行进程管理，包括判断进程是否存在、获取进程列表、获取进程详细信息等。而且psutil还提供了许多命令行工具提供的功能，包括：ps，top，lsof，netstat，ifconfig， who，df，kill，free，nice，ionice，iostat，iotop，uptime，pidof，tty，taskset，pmap。</strong></li>
<li><strong><code>psutil是一个跨平台的库</code>，支持Linux、Windows、OSX、FreeBSD、OpenBSD、NetBSD、Sun Solaris、AIX等操作系统。同时，psutil也支持32位与64位的系统架构，支持Python2.6到Python3.x之间的所有Python版本。</strong></li>
<li><strong>psutil具有简单易用、功能强大、跨平台等诸多优点，广泛应用于开源项目中，比较有名的有glances、Facebook的osquery、Google的grr等。psutil不但广泛应用于Python语言开发的开源项目中，还被移植到了其他编程语言中，如Go语言的gopsutil、C语言的cpslib、Rust语言的rust-psutil、Ruby语言的posixpsutil等。</strong></li>
</ul>
<h3 id="pip安装psutil">pip安装psutil</h3>
<p><strong>psutil是一个第三方的开源项目，因此，需要先安装才能够使用。如果安装了Anaconda，psutil就已经可用了。否则，需要在命令行下通过pip安装：</strong></p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><code class="hljs shell">[root@localhost ~]# pip3 install psutil<br>Collecting psutil<br>  Downloading psutil-5.7.0.tar.gz (449 kB)<br>     |████████████████████████████████| 449 kB 4.6 kB/s <br>Installing collected packages: psutil<br>    Running setup.py install for psutil ... done<br>Successfully installed psutil-5.7.0<br>[root@python scripts]# ipython            #打开ipython<br></code></pre></td></tr></table></figure>
<p><strong>psutil包含了异常、类、功能函数和常量，其中功能函数用来获取系统的信息，如CPU、磁盘、内存、网络等。类用来实现进程的管理功能。</strong></p>
<h2 id="2、psutil提供的功能函数">2、psutil提供的功能函数</h2>
<p><strong>根据函数的功能，主要分为CPU、磁盘、内存、网络几类，下面将会总几个方面来介绍psutil提供的功能函数。在这一小节，我们也将学习如何使用psutil来简化使用shell脚本获取监控信息的程序，并获取CPU、内存、磁盘和网络等不同维度。</strong></p>
<h3 id="（1）CPU">（1）CPU</h3>
<h4 id="与CPU相关的功能函数如下："><strong>与CPU相关的功能函数如下：</strong></h4>
<table>
<thead>
<tr>
<th>函数</th>
<th>描述</th>
</tr>
</thead>
<tbody>
<tr>
<td>psutil.cpu_count()</td>
<td>cpu_count(,[logical]):默认返回逻辑CPU的个数,当设置logical的参数为False时，返回物理CPU的个数。</td>
</tr>
<tr>
<td>psutil.cpu_percent()</td>
<td>cpu_percent(,[percpu],[interval])：返回CPU的利用率,percpu为True时显示所有物理核心的利用率,interval不为0时,则阻塞时显示interval执行的时间内的平均利用率</td>
</tr>
<tr>
<td>psutil.cpu_times()</td>
<td>cpu_times(,[percpu])：以命名元组(namedtuple)的形式返回cpu的时间花费,percpu=True表示获取每个CPU的时间花费</td>
</tr>
<tr>
<td>psutil.cpu_times_percent()</td>
<td>cpu_times_percent(,[percpu])：功能和cpu_times大致相同，看字面意思就能知道，该函数返回的是耗时比例。</td>
</tr>
<tr>
<td>psutil.cpu_stats()</td>
<td>cpu_stats()以命名元组的形式返回CPU的统计信息，包括上下文切换，中断，软中断和系统调用次数。</td>
</tr>
<tr>
<td>psutil.cpu_freq()</td>
<td>cpu_freq([percpu])：返回cpu频率</td>
</tr>
</tbody>
</table>
<h4 id="1）cpu-count">1）cpu_count</h4>
<blockquote>
<p><strong>默认返回逻辑CPU的个数,当设置logical的参数为False时，返回物理CPU的个数。</strong></p>
</blockquote>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><code class="hljs python">In [<span class="hljs-number">1</span>]: <span class="hljs-keyword">import</span> psutil                                            <br><br>In [<span class="hljs-number">2</span>]: psutil.cpu_count()                    <span class="hljs-comment">#查看处理器内核数</span><br>Out[<span class="hljs-number">2</span>]: <span class="hljs-number">1</span><br><br>In [<span class="hljs-number">3</span>]: psutil.cpu_count(logical=<span class="hljs-literal">False</span>)       <span class="hljs-comment">#查看目前使用的处理器内核数                   </span><br>Out[<span class="hljs-number">3</span>]: <span class="hljs-number">1</span><br></code></pre></td></tr></table></figure>
<h4 id="2）cpu-percent">2）cpu_percent</h4>
<blockquote>
<p><strong>返回CPU的利用率，percpu为True时显示所有物理核心的利用率，interval不为0时，则阻塞时显示interval执行的时间内的平均利用率。</strong></p>
</blockquote>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><code class="hljs python">In [<span class="hljs-number">5</span>]: psutil.cpu_percent()                	<span class="hljs-comment">#查看每个内核使用率 </span><br>Out[<span class="hljs-number">5</span>]: <span class="hljs-number">0.2</span><br><br>In [<span class="hljs-number">6</span>]: psutil.cpu_percent(percpu=<span class="hljs-literal">True</span>)                          <br>Out[<span class="hljs-number">6</span>]: [<span class="hljs-number">0.5</span>]<br><br>In [<span class="hljs-number">7</span>]: psutil.cpu_percent(percpu=<span class="hljs-literal">True</span>,interval=<span class="hljs-number">2</span>)               <br>Out[<span class="hljs-number">7</span>]: [<span class="hljs-number">0.0</span>]<br></code></pre></td></tr></table></figure>
<h4 id="3）cpu-times">3）cpu_times</h4>
<blockquote>
<p><strong>以命名元组(namedtuple)的形式返回cpu的时间花费，percpu=True表示获取每个CPU的时间花费。</strong></p>
</blockquote>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><code class="hljs python">In [<span class="hljs-number">8</span>]: psutil.cpu_times()                                       <br>Out[<span class="hljs-number">8</span>]: scputimes(user=<span class="hljs-number">11.1</span>, nice=<span class="hljs-number">0.0</span>, system=<span class="hljs-number">14.05</span>, idle=<span class="hljs-number">3252.64</span>, iowait=<span class="hljs-number">0.98</span>, irq=<span class="hljs-number">0.0</span>, softirq=<span class="hljs-number">0.18</span>, steal=<span class="hljs-number">0.0</span>, guest=<span class="hljs-number">0.0</span>, guest_nice=<span class="hljs-number">0.0</span>)<br><br>In [<span class="hljs-number">9</span>]: psutil.cpu_times_percent()                               <br>Out[<span class="hljs-number">9</span>]: scputimes(user=<span class="hljs-number">0.2</span>, nice=<span class="hljs-number">0.0</span>, system=<span class="hljs-number">0.1</span>, idle=<span class="hljs-number">99.6</span>, iowait=<span class="hljs-number">0.0</span>, irq=<span class="hljs-number">0.0</span>, softirq=<span class="hljs-number">0.0</span>, steal=<span class="hljs-number">0.0</span>, guest=<span class="hljs-number">0.0</span>, guest_nice=<span class="hljs-number">0.0</span>)<br></code></pre></td></tr></table></figure>
<h4 id="4）cpu-stats">4）cpu_stats</h4>
<blockquote>
<p><strong>以命名元组的形式返回CPU的统计信息，包括上下文切换，中断，软中断和系统调用次数。</strong></p>
</blockquote>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs python">In [<span class="hljs-number">10</span>]: psutil.cpu_stats()                                      <br>Out[<span class="hljs-number">10</span>]: scpustats(ctx_switches=<span class="hljs-number">403960</span>, interrupts=<span class="hljs-number">214204</span>, soft_interrupts=<span class="hljs-number">217258</span>, syscalls=<span class="hljs-number">0</span>)<br></code></pre></td></tr></table></figure>
<h4 id="5）cpu-freq">5）cpu_freq</h4>
<blockquote>
<p><strong>返回cpu频率。</strong></p>
</blockquote>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs python">In [<span class="hljs-number">11</span>]: psutil.cpu_freq()                                       <br>Out[<span class="hljs-number">11</span>]: scpufreq(current=<span class="hljs-number">1799.453</span>, min=<span class="hljs-number">0.0</span>, max=<span class="hljs-number">0.0</span>)<br></code></pre></td></tr></table></figure>
<h3 id="（2）内存">（2）内存</h3>
<h4 id="与内存相关的功能函数如下：">与内存相关的功能函数如下：</h4>
<h4 id="1）virtual-memory">1）virtual_memory</h4>
<p><strong>以命名元组的形式返回内存使用情况，包括总内存、可用内存、内存利用率、buffer和cache等。除了内存利用率，其它字段都以字节为单位返回。</strong></p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs python">In [<span class="hljs-number">1</span>]: <span class="hljs-keyword">import</span> psutil                                                              <br><br>In [<span class="hljs-number">12</span>]: psutil.virtual_memory()                                 <br>Out[<span class="hljs-number">12</span>]: svmem(total=<span class="hljs-number">1023934464</span>, available=<span class="hljs-number">383610880</span>, percent=<span class="hljs-number">62.5</span>, used=<span class="hljs-number">481861632</span>, free=<span class="hljs-number">67833856</span>, active=<span class="hljs-number">436379648</span>, inactive=<span class="hljs-number">340885504</span>, buffers=<span class="hljs-number">2166784</span>, cached=<span class="hljs-number">472072192</span>, shared=<span class="hljs-number">7598080</span>, slab=<span class="hljs-number">79253504</span>)<br></code></pre></td></tr></table></figure>
<h4 id="单位转换"><strong>单位转换</strong></h4>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-comment">#/usr/bin/python</span><br><span class="hljs-comment">#-*- conding:utf-8 _*_</span><br><br><span class="hljs-keyword">import</span> psutil<br><br><span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">bytes2human</span><span class="hljs-params">(n)</span>:</span><br>     symbols = (<span class="hljs-string">'K'</span>,<span class="hljs-string">'M'</span>,<span class="hljs-string">'G'</span>,<span class="hljs-string">'T'</span>,<span class="hljs-string">'P'</span>,<span class="hljs-string">'E'</span>,<span class="hljs-string">'Z'</span>,<span class="hljs-string">'Y'</span>)<br>     prefix = &#123;&#125;<br>     <span class="hljs-keyword">for</span> i,s <span class="hljs-keyword">in</span> enumerate(symbols):<br>         prefix[s] = <span class="hljs-number">1</span> &lt;&lt; (i + <span class="hljs-number">1</span>) * <span class="hljs-number">10</span><br>         print(prefix[s])<br>     print(<span class="hljs-string">'============'</span>)<br>     <span class="hljs-keyword">for</span> s <span class="hljs-keyword">in</span> reversed(symbols):<br>         <span class="hljs-keyword">if</span> n &gt;= prefix[s]:<br>             value = float(n) / prefix[s]<br>             <span class="hljs-keyword">return</span> <span class="hljs-string">'%.1f%s'</span> % (value,s)<br>             <span class="hljs-comment"># return '&#123;0&#125;.1f&#123;1&#125;'.format(value, s)</span><br>     <span class="hljs-keyword">return</span> <span class="hljs-string">"%sB"</span> % n<br>     <span class="hljs-comment"># return "&#123;0&#125;B" .format(n)</span><br><br><br>print(<span class="hljs-string">"总内存："</span>+bytes2human(psutil.virtual_memory().total))<br></code></pre></td></tr></table></figure>
<h5 id="运行结果如下所示：">运行结果如下所示：</h5>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><code class="hljs shell">[root@python scripts]# python3 monitor_mem.py <br>1024<br>1048576<br>1073741824<br>1099511627776<br>1125899906842624<br>1152921504606846976<br>1180591620717411303424<br>1208925819614629174706176<br>============<br>总内存：976.5M<br></code></pre></td></tr></table></figure>
<h5 id="分析一下">分析一下</h5>
<p><img src="https://gitee.com/xgpqq/tuchuang/raw/master/img/image-20200506155100111.png" alt="image-20200506155100111"></p>
<h4 id="2）swap-memory">2）swap_memory</h4>
<p><strong>以命名元组的形式返回swap/memory使用情况，包含swap中页的换入和换出。</strong></p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs python">In [<span class="hljs-number">13</span>]: psutil.swap_memory()                                    <br>Out[<span class="hljs-number">13</span>]: sswap(total=<span class="hljs-number">2147479552</span>, used=<span class="hljs-number">0</span>, free=<span class="hljs-number">2147479552</span>, percent=<span class="hljs-number">0.0</span>, sin=<span class="hljs-number">0</span>, sout=<span class="hljs-number">0</span>)<br></code></pre></td></tr></table></figure>
<h3 id="（3）磁盘">（3）磁盘</h3>
<p><strong>与磁盘相关的功能如下：</strong></p>
<table>
<thead>
<tr>
<th>函数</th>
<th>描述</th>
</tr>
</thead>
<tbody>
<tr>
<td>psutil.disk_io_counters()</td>
<td>disk_io_counters([perdisk])：以命名元组的形式返回磁盘io统计信息(汇总的)，包括读、写的次数，读、写的字节数等。 当perdisk的值为True，则分别列出单个磁盘的统计信息(字典：key为磁盘名称，value为统计的namedtuple)。</td>
</tr>
<tr>
<td>psutil.disk_partitions()</td>
<td>disk_partitions([all=False])：以命名元组的形式返回所有已挂载的磁盘，包含磁盘名称，挂载点，文件系统类型等信息。 当all等于True时，返回包含/proc等特殊文件系统的挂载信息</td>
</tr>
<tr>
<td>psutil.disk_usage()</td>
<td>disk_usage(path)：以命名元组的形式返回path所在磁盘的使用情况，包括磁盘的容量、已经使用的磁盘容量、磁盘的空间利用率等。</td>
</tr>
</tbody>
</table>
<h4 id="1）psutil-disk-io-counters">1）psutil.disk_io_counters</h4>
<p><strong>以命名元组的形式返回磁盘io统计信息(汇总的)，包括读、写的次数，读、写的字节数等。 当perdisk的值为True，则分别列出单个磁盘的统计信息(字典：key为磁盘名称，value为统计的namedtuple)。有了disk_io_counters函数，省去了解析/proc/diskstats文件的烦恼。</strong></p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><code class="hljs python">In [<span class="hljs-number">1</span>]: <span class="hljs-keyword">import</span> psutil                                                              <br><br>In [<span class="hljs-number">2</span>]: psutil.disk_io_counters()                              <br>Out[<span class="hljs-number">2</span>]: sdiskio(read_count=<span class="hljs-number">86913</span>, write_count=<span class="hljs-number">46560</span>, read_bytes=<span class="hljs-number">5038501376</span>, write_bytes=<span class="hljs-number">408987648</span>, read_time=<span class="hljs-number">77974</span>, write_time=<span class="hljs-number">79557</span>, read_merged_count=<span class="hljs-number">5933</span>, write_merged_count=<span class="hljs-number">35916</span>, busy_time=<span class="hljs-number">42153</span>)<br><br>In [<span class="hljs-number">3</span>]: psutil.disk_io_counters(perdisk=Tru<br>Out[<span class="hljs-number">3</span>]: <br>&#123;<span class="hljs-string">'sda'</span>: sdiskio(read_count=<span class="hljs-number">41472</span>, write_count=<span class="hljs-number">5340</span>, read_bytes=<span class="hljs-number">2524417024</span>, write_bytes=<span class="hljs-number">205662720</span>, read_time=<span class="hljs-number">38302</span>, write_time=<span class="hljs-number">4484</span>, read_merged_count=<span class="hljs-number">5933</span>, write_merged_count=<span class="hljs-number">35916</span>, busy_time=<span class="hljs-number">21074</span>),<br> <span class="hljs-string">'sda1'</span>: sdiskio(read_count=<span class="hljs-number">1854</span>, write_count=<span class="hljs-number">4</span>, read_bytes=<span class="hljs-number">6441472</span>, write_bytes=<span class="hljs-number">2097152</span>, read_time=<span class="hljs-number">370</span>, write_time=<span class="hljs-number">35</span>, read_merged_count=<span class="hljs-number">0</span>, write_merged_count=<span class="hljs-number">0</span>, busy_time=<span class="hljs-number">396</span>),<br> <span class="hljs-string">'sda2'</span>: sdiskio(read_count=<span class="hljs-number">39587</span>, write_count=<span class="hljs-number">5337</span>, read_bytes=<span class="hljs-number">2516263424</span>, write_bytes=<span class="hljs-number">203570688</span>, read_time=<span class="hljs-number">37925</span>, write_time=<span class="hljs-number">4449</span>, read_merged_count=<span class="hljs-number">5933</span>, write_merged_count=<span class="hljs-number">35916</span>, busy_time=<span class="hljs-number">20675</span>),<br> <span class="hljs-string">'sr0'</span>: sdiskio(read_count=<span class="hljs-number">0</span>, write_count=<span class="hljs-number">0</span>, read_bytes=<span class="hljs-number">0</span>, write_bytes=<span class="hljs-number">0</span>, read_time=<span class="hljs-number">0</span>, write_time=<span class="hljs-number">0</span>, read_merged_count=<span class="hljs-number">0</span>, write_merged_count=<span class="hljs-number">0</span>, busy_time=<span class="hljs-number">0</span>),<br> <span class="hljs-string">'dm-0'</span>: sdiskio(read_count=<span class="hljs-number">38566</span>, write_count=<span class="hljs-number">5197</span>, read_bytes=<span class="hljs-number">2483773952</span>, write_bytes=<span class="hljs-number">55885312</span>, read_time=<span class="hljs-number">37685</span>, write_time=<span class="hljs-number">3546</span>, read_merged_count=<span class="hljs-number">0</span>, write_merged_count=<span class="hljs-number">0</span>, busy_time=<span class="hljs-number">19410</span>),<br> <span class="hljs-string">'dm-1'</span>: sdiskio(read_count=<span class="hljs-number">6875</span>, write_count=<span class="hljs-number">36059</span>, read_bytes=<span class="hljs-number">30310400</span>, write_bytes=<span class="hljs-number">147697664</span>, read_time=<span class="hljs-number">1987</span>, write_time=<span class="hljs-number">71537</span>, read_merged_count=<span class="hljs-number">0</span>, write_merged_count=<span class="hljs-number">0</span>, busy_time=<span class="hljs-number">1673</span>)&#125;<br></code></pre></td></tr></table></figure>
<h4 id="2）psutil-disk-partitions">2）psutil.disk_partitions</h4>
<p><strong>以命名元组的形式返回所有已挂载的磁盘，包含磁盘名称，挂载点，文件系统类型等信息。当all等于True时，返回包含/proc等特殊文件系统的挂载信息。</strong></p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><code class="hljs python">In [<span class="hljs-number">4</span>]: psutil.disk_partitions()      <span class="hljs-comment">#查看挂载点信息                    </span><br>Out[<span class="hljs-number">4</span>]: <br>[sdiskpart(device=<span class="hljs-string">'/dev/mapper/centos-root'</span>, mountpoint=<span class="hljs-string">'/'</span>, fstype=<span class="hljs-string">'xfs'</span>, opts=<span class="hljs-string">'rw,seclabel,relatime,attr2,inode64,noquota'</span>),<br> sdiskpart(device=<span class="hljs-string">'/dev/sda1'</span>, mountpoint=<span class="hljs-string">'/boot'</span>, fstype=<span class="hljs-string">'xfs'</span>, opts=<span class="hljs-string">'rw,seclabel,relatime,attr2,inode64,noquota'</span>)]<br><br>In [<span class="hljs-number">5</span>]: [device <span class="hljs-keyword">for</span> device <span class="hljs-keyword">in</span> psutil.disk_partitions() <span class="hljs-keyword">if</span> device.mountpoint == <span class="hljs-string">'/'</span>]<br>Out[<span class="hljs-number">5</span>]: [sdiskpart(device=<span class="hljs-string">'/dev/mapper/centos-root'</span>, mountpoint=<span class="hljs-string">'/'</span>, fstype=<span class="hljs-string">'xfs'</span>, opts=<span class="hljs-string">'rw,seclabel,relatime,attr2,inode64,noquota'</span>)]<br><br>In [<span class="hljs-number">6</span>]: <span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">get_disk_via_mountpoint</span><span class="hljs-params">(point)</span>:</span>      <span class="hljs-comment">#创建一个函数</span><br>    ...:     disk = [item <span class="hljs-keyword">for</span> item <span class="hljs-keyword">in</span> psutil.disk_partitions() <span class="hljs-keyword">if</span> item.mountpoint == point] <br>    ...:     <span class="hljs-keyword">return</span> disk[<span class="hljs-number">0</span>].device <br>//没有任何输出                           <br><br>In [<span class="hljs-number">7</span>]: get_disk_via_mountpoint(<span class="hljs-string">'/'</span>)   <span class="hljs-comment">#调用get_disk_via_mountpoint查看“/”的挂载点</span><br>Out[<span class="hljs-number">7</span>]: <span class="hljs-string">'/dev/mapper/cl-root'</span><br><br>    <br>In [<span class="hljs-number">8</span>]: get_disk_via_mountpoint(<span class="hljs-string">'/boot'</span>) <span class="hljs-comment">#调用get_disk_via_mountpoint查看“/boot”的挂载点</span><br>Out[<span class="hljs-number">8</span>]: <span class="hljs-string">'/dev/sda1'</span><br></code></pre></td></tr></table></figure>
<h4 id="3）psutil-disk-usage">3）psutil.disk_usage</h4>
<p><strong>以命名元组的形式返回path所在磁盘的使用情况，包括磁盘的容量、已经使用的磁盘容量、磁盘的空间利用率等。</strong></p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><code class="hljs python">In [<span class="hljs-number">9</span>]: psutil.disk_usage(<span class="hljs-string">'/'</span>)       <br>Out[<span class="hljs-number">9</span>]: sdiskusage(total=<span class="hljs-number">18238930944</span>, used=<span class="hljs-number">6775488512</span>, free=<span class="hljs-number">11463442432</span>, percent=<span class="hljs-number">37.1</span>)<br><br>In [<span class="hljs-number">10</span>]: psutil.disk_usage(<span class="hljs-string">'/'</span>).percent<br>Out[<span class="hljs-number">10</span>]: <span class="hljs-number">37.2</span><br><br>In [<span class="hljs-number">11</span>]: type(psutil.disk_usage(<span class="hljs-string">'/'</span>).percent)<br>Out[<span class="hljs-number">11</span>]: float<br></code></pre></td></tr></table></figure>
<h3 id="（4）网络">（4）网络</h3>
<p><strong>与网络相关的函数如下：</strong></p>
<table>
<thead>
<tr>
<th>函数</th>
<th>详情</th>
</tr>
</thead>
<tbody>
<tr>
<td>psutil.net_io_counter([pernic])</td>
<td>以命名元组的形式返回当前系统中每块网卡的网络io统计信息，包括收发字节数，收发包的数量、出错的情况和删包情况。当pernic为True时，则列出所有网卡的统计信息。</td>
</tr>
<tr>
<td>psutil.net_connections([kind])</td>
<td>以列表的形式返回每个网络连接的详细信息(namedtuple)。命名元组包含fd, family, type, laddr, raddr, status, pid等信息。kind表示过滤的连接类型，支持的值如下：(默认为inet)</td>
</tr>
<tr>
<td>psutil.net_if_addrs()</td>
<td>以字典的形式返回网卡的配置信息，包括IP地址和mac地址、子网掩码和广播地址。</td>
</tr>
<tr>
<td>psutil.net_if_stats()</td>
<td>返回网卡的详细信息，包括是否启动、通信类型、传输速度与mtu。</td>
</tr>
<tr>
<td>psutil.users()</td>
<td>以命名元组的方式返回当前登陆用户的信息，包括用户名，登陆时间，终端，与主机信息</td>
</tr>
<tr>
<td>psutil.boot_time()</td>
<td>以时间戳的形式返回系统的启动时间</td>
</tr>
</tbody>
</table>
<h4 id="1）psutil-net-io-counter">1）psutil.net_io_counter</h4>
<p><strong>以命名元组的形式返回当前系统中每块网卡的网络io统计信息，包括收发字节数，收发包的数量、出错的情况和删包情况。当pernic为True时，则列出所有网卡的统计信息。使用net_io_counter函数与自己解析/proc/net/dev文件内容实现的功能相同。</strong></p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><code class="hljs python">In [<span class="hljs-number">1</span>]: <span class="hljs-keyword">import</span> psutil                <br><br>In [<span class="hljs-number">2</span>]: psutil.net_io_counters()     <br>Out[<span class="hljs-number">2</span>]: snetio(bytes_sent=<span class="hljs-number">720405</span>, bytes_recv=<span class="hljs-number">3661606</span>, packets_sent=<span class="hljs-number">5520</span>, packets_recv=<span class="hljs-number">14886</span>, errin=<span class="hljs-number">0</span>, errout=<span class="hljs-number">0</span>, dropin=<span class="hljs-number">0</span>, dropout=<span class="hljs-number">0</span>)<br><br>In [<span class="hljs-number">3</span>]: psutil.net_io_counters(pernic=<span class="hljs-literal">True</span>) <br>Out[<span class="hljs-number">3</span>]: <br>&#123;<span class="hljs-string">'ens37'</span>: snetio(bytes_sent=<span class="hljs-number">724145</span>, bytes_recv=<span class="hljs-number">3365944</span>, packets_sent=<span class="hljs-number">5538</span>, packets_recv=<span class="hljs-number">10017</span>, errin=<span class="hljs-number">0</span>, errout=<span class="hljs-number">0</span>, dropin=<span class="hljs-number">0</span>, dropout=<span class="hljs-number">0</span>),<br> <span class="hljs-string">'lo'</span>: snetio(bytes_sent=<span class="hljs-number">0</span>, bytes_recv=<span class="hljs-number">0</span>, packets_sent=<span class="hljs-number">0</span>, packets_recv=<span class="hljs-number">0</span>, errin=<span class="hljs-number">0</span>, errout=<span class="hljs-number">0</span>, dropin=<span class="hljs-number">0</span>, dropout=<span class="hljs-number">0</span>),<br> <span class="hljs-string">'virbr0-nic'</span>: snetio(bytes_sent=<span class="hljs-number">0</span>, bytes_recv=<span class="hljs-number">0</span>, packets_sent=<span class="hljs-number">0</span>, packets_recv=<span class="hljs-number">0</span>, errin=<span class="hljs-number">0</span>, errout=<span class="hljs-number">0</span>, dropin=<span class="hljs-number">0</span>, dropout=<span class="hljs-number">0</span>),<br> <span class="hljs-string">'virbr0'</span>: snetio(bytes_sent=<span class="hljs-number">0</span>, bytes_recv=<span class="hljs-number">0</span>, packets_sent=<span class="hljs-number">0</span>, packets_recv=<span class="hljs-number">0</span>, errin=<span class="hljs-number">0</span>, errout=<span class="hljs-number">0</span>, dropin=<span class="hljs-number">0</span>, dropout=<span class="hljs-number">0</span>),<br> <span class="hljs-string">'ens33'</span>: snetio(bytes_sent=<span class="hljs-number">0</span>, bytes_recv=<span class="hljs-number">298202</span>, packets_sent=<span class="hljs-number">0</span>, packets_recv=<span class="hljs-number">4899</span>, errin=<span class="hljs-number">0</span>, errout=<span class="hljs-number">0</span>, dropin=<span class="hljs-number">0</span>, dropout=<span class="hljs-number">0</span>)&#125;<br></code></pre></td></tr></table></figure>
<h4 id="2）net-connections">2）net_connections</h4>
<p><strong>以列表的形式返回每个网络连接的详细信息(namedtuple)，可以使用该函数查看网络连接状态，统计连接个数以及处于特定状态的网络连接个数。</strong></p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><code class="hljs python">In [<span class="hljs-number">4</span>]: psutil.net_connections()      <br>Out[<span class="hljs-number">4</span>]: <br>[sconn(fd=<span class="hljs-number">6</span>, family=&lt;AddressFamily.AF_INET6: <span class="hljs-number">10</span>&gt;, type=&lt;SocketKind.SOCK_STREAM: <span class="hljs-number">1</span>&gt;, laddr=addr(ip=<span class="hljs-string">'::'</span>, port=<span class="hljs-number">111</span>), raddr=(), status=<span class="hljs-string">'LISTEN'</span>, pid=<span class="hljs-number">6558</span>),<br> sconn(fd=<span class="hljs-number">7</span>, family=&lt;AddressFamily.AF_INET6: <span class="hljs-number">10</span>&gt;, type=&lt;SocketKind.SOCK_DGRAM: <span class="hljs-number">2</span>&gt;, laddr=addr(ip=<span class="hljs-string">'::'</span>, port=<span class="hljs-number">111</span>), raddr=(), status=<span class="hljs-string">'NONE'</span>, pid=<span class="hljs-number">6558</span>),<br> sconn(fd=<span class="hljs-number">8</span>, family=&lt;AddressFamily.AF_INET6: <span class="hljs-number">10</span>&gt;, type=&lt;SocketKind.SOCK_STREAM: <span class="hljs-number">1</span>&gt;, laddr=addr(ip=<span class="hljs-string">'::1'</span>, port=<span class="hljs-number">6010</span>), raddr=(), status=<span class="hljs-string">'LISTEN'</span>, pid=<span class="hljs-number">9047</span>),<br> sconn(fd=<span class="hljs-number">6</span>, family=&lt;AddressFamily.AF_INET: <span class="hljs-number">2</span>&gt;, type=&lt;SocketKind.SOCK_STREAM: <span class="hljs-number">1</span>&gt;,<br>......<br><br>In [<span class="hljs-number">5</span>]: conns = psutil.net_connections()<br><br>In [<span class="hljs-number">6</span>]: len([conn <span class="hljs-keyword">for</span> conn <span class="hljs-keyword">in</span> conns <span class="hljs-keyword">if</span> conn.status == <span class="hljs-string">'TIME_WAIT'</span>])   <br>Out[<span class="hljs-number">6</span>]: <span class="hljs-number">0</span><br></code></pre></td></tr></table></figure>
<h4 id="3）net-if-addrs">3）net_if_addrs</h4>
<p><strong>以字典的形式返回网卡的配置信息，包括IP地址和mac地址、子网掩码和广播地址。</strong></p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><code class="hljs python">In [<span class="hljs-number">7</span>]: psutil.net_if_addrs()                                                     Out[<span class="hljs-number">7</span>]: <br>&#123;<span class="hljs-string">'lo'</span>: [snicaddr(family=&lt;AddressFamily.AF_INET: <span class="hljs-number">2</span>&gt;, address=<span class="hljs-string">'127.0.0.1'</span>, netmask=<span class="hljs-string">'255.0.0.0'</span>, broadcast=<span class="hljs-literal">None</span>, ptp=<span class="hljs-literal">None</span>),<br>  snicaddr(family=&lt;AddressFamily.AF_INET6: <span class="hljs-number">10</span>&gt;, address=<span class="hljs-string">'::1'</span>, netmask=<span class="hljs-string">'ffff:ffff:ffff:ffff:ffff:ffff:ffff:ffff'</span>, broadcast=<span class="hljs-literal">None</span>, ptp=<span class="hljs-literal">None</span>),<br>  snicaddr(family=&lt;AddressFamily.AF_PACKET: <span class="hljs-number">17</span>&gt;, address=<span class="hljs-string">'00:00:00:00:00:00'</span>, netmask=<span class="hljs-literal">None</span>, broadcast=<span class="hljs-literal">None</span>, ptp=<span class="hljs-literal">None</span>)],<br> <span class="hljs-string">'ens37'</span>: [snicaddr(family=&lt;AddressFamily.AF_INET: <span class="hljs-number">2</span>&gt;, address=<span class="hljs-string">'192.168.1.131'</span>, netmask=<span class="hljs-string">'255.255.255.255'</span>, broadcast=<span class="hljs-string">'192.168.1.131'</span>, ptp=<span class="hljs-literal">None</span>),<br>  snicaddr(family=&lt;AddressFamily.AF_INET6: <span class="hljs-number">10</span>&gt;, address=<span class="hljs-string">'240e:82:e03:7342:4378:7be3:558c:fc88'</span>, netmask=<span class="hljs-string">'ffff:ffff:ffff:ffff::'</span>, broadcast=<span class="hljs-literal">None</span>, ptp=<span class="hljs-literal">None</span>)<br>......<br></code></pre></td></tr></table></figure>
<h4 id="4）psutil-net-if-stats">4）psutil.net_if_stats</h4>
<p><strong>返回网卡的详细信息，包括是否启动、通信类型、传输速度与mtu。</strong></p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><code class="hljs python">In [<span class="hljs-number">8</span>]: psutil.net_if_stats()        <br>Out[<span class="hljs-number">8</span>]: <br>&#123;<span class="hljs-string">'ens37'</span>: snicstats(isup=<span class="hljs-literal">True</span>, duplex=&lt;NicDuplex.NIC_DUPLEX_FULL: <span class="hljs-number">2</span>&gt;, speed=<span class="hljs-number">1000</span>, mtu=<span class="hljs-number">1500</span>),<br> <span class="hljs-string">'lo'</span>: snicstats(isup=<span class="hljs-literal">True</span>, duplex=&lt;NicDuplex.NIC_DUPLEX_UNKNOWN: <span class="hljs-number">0</span>&gt;, speed=<span class="hljs-number">0</span>, mtu=<span class="hljs-number">65536</span>),<br> <span class="hljs-string">'virbr0-nic'</span>: snicstats(isup=<span class="hljs-literal">False</span>, duplex=&lt;NicDuplex.NIC_DUPLEX_FULL: <span class="hljs-number">2</span>&gt;, speed=<span class="hljs-number">10</span>, mtu=<span class="hljs-number">1500</span>),<br> <span class="hljs-string">'virbr0'</span>: snicstats(isup=<span class="hljs-literal">True</span>, duplex=&lt;NicDuplex.NIC_DUPLEX_UNKNOWN: <span class="hljs-number">0</span>&gt;, speed=<span class="hljs-number">0</span>, mtu=<span class="hljs-number">1500</span>),<br> <span class="hljs-string">'ens33'</span>: snicstats(isup=<span class="hljs-literal">True</span>, duplex=&lt;NicDuplex.NIC_DUPLEX_FULL: <span class="hljs-number">2</span>&gt;, speed=<span class="hljs-number">1000</span>, mtu=<span class="hljs-number">1500</span>)&#125;<br></code></pre></td></tr></table></figure>
<p><img src="https://gitee.com/xgpqq/tuchuang/raw/master/img/image-20200506164244803.png" alt="image-20200506164244803"></p>
<h3 id="（5）其他">（5）其他</h3>
<h4 id="1）users">1）users</h4>
<p><strong>以命名元组的方式返回当前登陆用户的信息，包括用户名，登陆时间，终端，与主机信息。</strong></p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><code class="hljs python">In [<span class="hljs-number">9</span>]: psutil.users()              <br>Out[<span class="hljs-number">9</span>]: <br>[suser(name=<span class="hljs-string">'root'</span>, terminal=<span class="hljs-string">':0'</span>, host=<span class="hljs-string">'localhost'</span>, started=<span class="hljs-number">1582366080.0</span>, pid=<span class="hljs-number">7991</span>),<br> suser(name=<span class="hljs-string">'root'</span>, terminal=<span class="hljs-string">'pts/0'</span>, host=<span class="hljs-string">'localhost'</span>, started=<span class="hljs-number">1582366208.0</span>, pid=<span class="hljs-number">8927</span>),<br> suser(name=<span class="hljs-string">'root'</span>, terminal=<span class="hljs-string">'pts/1'</span>, host=<span class="hljs-string">'192.168.1.4'</span>, started=<span class="hljs-number">1582370816.0</span>, pid=<span class="hljs-number">10099</span>),<br> suser(name=<span class="hljs-string">'root'</span>, terminal=<span class="hljs-string">'pts/3'</span>, host=<span class="hljs-string">'192.168.1.4'</span>, started=<span class="hljs-number">1582369408.0</span>, pid=<span class="hljs-number">9787</span>)]<br></code></pre></td></tr></table></figure>
<h4 id="2）boot-time">2）boot_time</h4>
<p><strong>以时间戳的形式返回系统的启动时间。</strong></p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><code class="hljs python">In [<span class="hljs-number">9</span>]: <span class="hljs-keyword">import</span> datetime<br><br>In [<span class="hljs-number">10</span>]: psutil.boot_time()    <br>Out[<span class="hljs-number">10</span>]: <span class="hljs-number">1582527367.0</span><br>    <br>In [<span class="hljs-number">11</span>]: datetime.datetime.fromtimestamp(psutil.boot_time()).strftime(<span class="hljs-string">'%Y-%m-%d %H:%M:%S'</span>)                                  <br>Out[<span class="hljs-number">11</span>]: <span class="hljs-string">'2020-02-24 14:56:07'</span><br></code></pre></td></tr></table></figure>
<h2 id="3、综合案例：使用psutil实现监控程序">3、综合案例：使用psutil实现监控程序</h2>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-comment"># coding=utf-8</span><br><span class="hljs-comment"># !/usr/bin/python</span><br><br><span class="hljs-keyword">import</span> psutil<br><span class="hljs-keyword">import</span> datetime<br><br><br><span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">bytes2human</span><span class="hljs-params">(n)</span>:</span><br>    <span class="hljs-string">'''内存单位转换的方法'''</span><br>    symbols = (<span class="hljs-string">'K'</span>, <span class="hljs-string">'M'</span>, <span class="hljs-string">'G'</span>, <span class="hljs-string">'T'</span>, <span class="hljs-string">'P'</span>, <span class="hljs-string">'E'</span>, <span class="hljs-string">'Z'</span>, <span class="hljs-string">'Y'</span>)<br>    prefix = &#123;&#125;<br>    <span class="hljs-keyword">for</span> i, s <span class="hljs-keyword">in</span> enumerate(symbols):<br>        prefix[s] = <span class="hljs-number">1</span> &lt;&lt; (i + <span class="hljs-number">1</span>) * <span class="hljs-number">10</span><br>    <span class="hljs-keyword">for</span> s <span class="hljs-keyword">in</span> reversed(symbols):<br>        <span class="hljs-keyword">if</span> n &gt;= prefix[s]:<br>            value = float(n) / prefix[s]<br>            <span class="hljs-keyword">return</span> <span class="hljs-string">'%.1f%s'</span> % (value, s)<br>    <span class="hljs-keyword">return</span> <span class="hljs-string">"%sB"</span> % n<br><br><br><span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">get_cpu_info</span><span class="hljs-params">()</span>:</span><br>    <span class="hljs-string">'''获取CPU使用率'''</span><br>    cpu_count = psutil.cpu_count()<br>    cpu_percent = psutil.cpu_percent(interval=<span class="hljs-number">1</span>)<br>    <span class="hljs-keyword">return</span> dict(cpu_count=cpu_count, cpu_percent=cpu_percent)<br><br><br><span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">get_memory_info</span><span class="hljs-params">()</span>:</span><br>    <span class="hljs-string">'''获取内存信息'''</span><br>    virtual_mem = psutil.virtual_memory()<br>    mem_total = bytes2human(virtual_mem.total)<br>    mem_percent = virtual_mem.percent<br>    mem_free = bytes2human(virtual_mem.free + virtual_mem.buffers + virtual_mem.cached)<br>    mem_used = bytes2human(virtual_mem.total * mem_percent / <span class="hljs-number">100</span>)<br>    <span class="hljs-keyword">return</span> dict(mem_total=mem_total, mem_percent=mem_percent, mem_free=mem_free, mem_used=mem_used)<br><br><br><span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">get_disk_info</span><span class="hljs-params">()</span>:</span><br>    <span class="hljs-string">'''获取磁盘信息'''</span><br>    disk_usage = psutil.disk_usage(<span class="hljs-string">'/'</span>)<br>    disk_total = bytes2human(disk_usage.total)<br>    disk_percent = disk_usage.percent<br>    disk_free = bytes2human(disk_usage.free)<br>    disk_used = bytes2human(disk_usage.used)<br>    <span class="hljs-keyword">return</span> dict(disk_total=disk_total, disk_percent=disk_percent, disk_free=disk_free, disk_used=disk_used)<br><br><br><span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">get_boot_info</span><span class="hljs-params">()</span>:</span><br>    <span class="hljs-string">'''获取启动时间'''</span><br>    boot_time = datetime.datetime.fromtimestamp(psutil.boot_time()).strftime(<span class="hljs-string">"%Y-%m-%d %H:%M:%S"</span>)<br>    <span class="hljs-keyword">return</span> dict(boot_time=boot_time)<br><br><br><span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">collect_monitor_data</span><span class="hljs-params">()</span>:</span><br>    <span class="hljs-string">'''集中监控硬件信息'''</span><br>    data = &#123;&#125;<br>    data.update(get_boot_info())<br>    data.update(get_cpu_info())<br>    data.update(get_memory_info())<br>    data.update(get_disk_info())<br>    print(data)<br>    <span class="hljs-keyword">return</span> data<br><br><br>collect_monitor_data()<br></code></pre></td></tr></table></figure>
<h5 id="执行结果如下">执行结果如下</h5>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs shell">[root@python scripts]# python3 monitor_psutil.py<br>&#123;'boot_time': '2020-05-06 16:23:37', 'cpu_count': 1, 'cpu_percent': 0.0, 'mem_total': '976.5M', 'mem_percent': 71.4, 'mem_free': '448.0M', 'mem_used': '697.2M', 'disk_total': '17.0G', 'disk_percent': 30.4, 'disk_free': '11.8G', 'disk_used': '5.2G'&#125;<br></code></pre></td></tr></table></figure>
<h2 id="4、psutil进程管理">4、psutil进程管理</h2>
<p><strong>psutil还提供了作为进程管理的功能函数，包括获取进程列表，判断是否存在，以及进程管理的类封装</strong>。</p>
<table>
<thead>
<tr>
<th>函数</th>
<th>详情</th>
</tr>
</thead>
<tbody>
<tr>
<td>psutil.Process()</td>
<td>对进程进行封装，可以使用该类的方法获取进行的详细信息，或者给进程发送信号。</td>
</tr>
<tr>
<td>psutil.pids()</td>
<td>以列表的形式返回当前正在运行的进程</td>
</tr>
<tr>
<td>psutil.pid_exists(1)</td>
<td>判断给点定的pid是否存在</td>
</tr>
<tr>
<td>psutil.process_iter()</td>
<td>迭代当前正在运行的进程，返回的是每个进程的Process对象</td>
</tr>
</tbody>
</table>
<h3 id="1）Process类">1）Process类</h3>
<p><strong>对进程进行封装，可以使用该类的方法获取进行的详细信息，或者给进程发送信号。</strong></p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><code class="hljs python">In [<span class="hljs-number">1</span>]: <span class="hljs-keyword">import</span> psutil                 <br><br>In [<span class="hljs-number">2</span>]: init_process = psutil.Process()<br><br>In [<span class="hljs-number">3</span>]: init_process.cmdline()      <br>Out[<span class="hljs-number">3</span>]: [<span class="hljs-string">'/usr/local/python38/bin/python3.8'</span>, <span class="hljs-string">'/usr/local/python38/bin/ipython'</span>]<br></code></pre></td></tr></table></figure>
<p><strong>Process类包含很多方法来获取进程的详细信息。下面是几个较常用的方法：</strong></p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><code class="hljs text">name：获取进程的名称<br>cmdline：获取启动进程的命令行参数<br>create_time：获取进程的创建时间(时间戳格式)<br>num_fds：进程打开的文件个数<br>num_threads：进程的子进程个数<br>is_running：判断进程是否正在运行<br>send_signal：给进程发送信号，类似与os.kill等<br>kill：发送SIGKILL信号结束进程<br>terminate：发送SIGTEAM信号结束进程<br></code></pre></td></tr></table></figure>
<h3 id="2）pids">2）pids</h3>
<p><strong>以列表的形式返回当前正在运行的进程。</strong></p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><code class="hljs python">In [<span class="hljs-number">1</span>]: <span class="hljs-keyword">import</span> psutil                 <br><br>In [<span class="hljs-number">2</span>]: init_process = psutil.Process()<br><br>In [<span class="hljs-number">3</span>]: init_process.cmdline()       <br>Out[<span class="hljs-number">3</span>]: [<span class="hljs-string">'/usr/local/python38/bin/python3.8'</span>, <span class="hljs-string">'/usr/local/python38/bin/ipython'</span>]<br><br>In [<span class="hljs-number">4</span>]: psutil.pids()[:<span class="hljs-number">5</span>]            <br>Out[<span class="hljs-number">4</span>]: [<span class="hljs-number">1</span>, <span class="hljs-number">2</span>, <span class="hljs-number">3</span>, <span class="hljs-number">5</span>, <span class="hljs-number">7</span>]<br></code></pre></td></tr></table></figure>
<h3 id="3）pid-exists">3）pid_exists</h3>
<p><strong>判断给点定的pid是否存在。</strong></p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><code class="hljs python">In [<span class="hljs-number">5</span>]: psutil.pid_exists(<span class="hljs-number">1</span>)          <br>Out[<span class="hljs-number">5</span>]: <span class="hljs-literal">True</span><br><br>In [<span class="hljs-number">6</span>]: psutil.pid_exists(<span class="hljs-number">10245</span>)                              <br>Out[<span class="hljs-number">6</span>]: <span class="hljs-literal">False</span><br></code></pre></td></tr></table></figure>
<h3 id="4）process-iter">4）process_iter</h3>
<p><strong>迭代当前正在运行的进程，返回的是每个进程的Process对象，而pids返回的是进程的列表。</strong></p>
<h1>二、使用Python监控MongoDB</h1>
<p><strong>对于MongoDB数据库来说，获取监控的方法比较简单，因为MongoDB本身流返回给我们一个字典形式的数据。如下所示：</strong></p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs python">pip install -i https://pypi.tuna.tsinghua.edu.cn/simple pymongo<br></code></pre></td></tr></table></figure>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-comment">#/usr/bin/python</span><br><span class="hljs-comment">#_*_ coding:utf-8 _*_</span><br><br><span class="hljs-keyword">from</span> __future__ <span class="hljs-keyword">import</span> print_function<br><span class="hljs-keyword">import</span> pymongo<br><br><br>client = pymongo.MongoClient(host=<span class="hljs-string">'127.0.0.1:27017'</span>)<br>client.admin.authenticate(<span class="hljs-string">'laoyu'</span>,<span class="hljs-string">'laoyu'</span>)<br>rs = client.admin.command(<span class="hljs-string">'replSetGetStatus'</span>)<br><br>print(<span class="hljs-string">"set:"</span>,rs[<span class="hljs-string">'set'</span>])<br>print(<span class="hljs-string">"myState:"</span>,rs[<span class="hljs-string">'myState'</span>])<br>print(<span class="hljs-string">'num of members:'</span>,len(rs[<span class="hljs-string">'members'</span>]))<br></code></pre></td></tr></table></figure>
</div><div class="post-copyright"><div class="post-copyright__author"><span class="post-copyright-meta">文章作者: </span><span class="post-copyright-info"><a href="mailto:undefined">Wu Shao Dong</a></span></div><div class="post-copyright__type"><span class="post-copyright-meta">文章链接: </span><span class="post-copyright-info"><a href="https://wsdlxgp.top/posts/54c9.html">https://wsdlxgp.top/posts/54c9.html</a></span></div><div class="post-copyright__notice"><span class="post-copyright-meta">版权声明: </span><span class="post-copyright-info">本博客所有文章除特别声明外，均采用 <a href="https://creativecommons.org/licenses/by-nc-sa/4.0/" target="_blank">CC BY-NC-SA 4.0</a> 许可协议。转载请注明来自 <a href="https://wsdlxgp.top" target="_blank">Xgp & Blog</a>！</span></div></div><div class="tag_share"><div class="post-meta__tag-list"><a class="post-meta__tags" href="/tags/nfs/">nfs</a><a class="post-meta__tags" href="/tags/pv/">pv</a><a class="post-meta__tags" href="/tags/pvc/">pvc</a><a class="post-meta__tags" href="/tags/Storage-Class/">Storage Class</a><a class="post-meta__tags" href="/tags/dashboard/">dashboard</a><a class="post-meta__tags" href="/tags/helm/">helm</a><a class="post-meta__tags" href="/tags/deployment/">deployment</a></div><div class="post_share"><div class="social-share" data-image="https://gitee.com/xgpqq/tuchuang/raw/master/img/aaaaaaaa.jpg" data-sites="facebook,twitter,wechat,weibo,qq"></div><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/social-share.js/dist/css/share.min.css"/><script src="https://cdn.jsdelivr.net/npm/social-share.js/dist/js/social-share.min.js"></script></div></div><div class="post-reward"><a class="reward-button button--primary button--animated"> <i class="fa fa-qrcode"></i> 打赏<div class="reward-main"><ul class="reward-all"><li class="reward-item"><img class="post-qr-code__img" src="http://xgp-cunchu.test.upcdn.net/k8s/3.jpg" alt="微信"/><div class="post-qr-code__desc">微信</div></li><li class="reward-item"><img class="post-qr-code__img" src="http://xgp-cunchu.test.upcdn.net/k8s/1.jpg" alt="支付寶"/><div class="post-qr-code__desc">支付寶</div></li><li class="reward-item"><img class="post-qr-code__img" src="http://xgp-cunchu.test.upcdn.net/k8s/2.jpg" alt="QQ支付"/><div class="post-qr-code__desc">QQ支付</div></li></ul></div></a></div><nav class="pagination_post" id="pagination"><div class="prev-post pull_left"><a href="/posts/e80d.html"><img class="prev_cover" src="https://gitee.com/xgpqq/tuchuang/raw/master/img/qweq73p.jpg" onerror="onerror=null;src='/img/404.jpg'"><div class="pagination-info"><div class="label">上一篇</div><div class="prev_info">python的文件处理</div></div></a></div><div class="next-post pull_right"><a href="/posts/10c9.html"><img class="next_cover" src="https://gitee.com/xgpqq/tuchuang/raw/master/img/qweq71p.jpg" onerror="onerror=null;src='/img/404.jpg'"><div class="pagination-info"><div class="label">下一篇</div><div class="next_info">Python监控Linux系统（2）</div></div></a></div></nav><div class="relatedPosts"><div class="relatedPosts_headline"><i class="fa fa-fw fa-thumbs-up" aria-hidden="true"></i><span> 相关推荐</span></div><div class="relatedPosts_list"><div class="relatedPosts_item"><a href="/posts/e939.html" title="初识python"><img class="relatedPosts_cover" src="https://gitee.com/xgpqq/tuchuang/raw/master/img/qweq46p.jpg"><div class="relatedPosts_main is-center"><div class="relatedPosts_date"><i class="fa fa-history fa-fw" aria-hidden="true"></i> 2020-06-30</div><div class="relatedPosts_title">初识python</div></div></a></div><div class="relatedPosts_item"><a href="/posts/5641.html" title="python文本文件的（读、写、追加）"><img class="relatedPosts_cover" src="https://gitee.com/xgpqq/tuchuang/raw/master/img/qweq58p.jpg"><div class="relatedPosts_main is-center"><div class="relatedPosts_date"><i class="fa fa-history fa-fw" aria-hidden="true"></i> 2020-06-30</div><div class="relatedPosts_title">python文本文件的（读、写、追加）</div></div></a></div><div class="relatedPosts_item"><a href="/posts/6618.html" title="python的正则表达式"><img class="relatedPosts_cover" src="https://gitee.com/xgpqq/tuchuang/raw/master/img/qweq57p.jpg"><div class="relatedPosts_main is-center"><div class="relatedPosts_date"><i class="fa fa-history fa-fw" aria-hidden="true"></i> 2020-06-30</div><div class="relatedPosts_title">python的正则表达式</div></div></a></div><div class="relatedPosts_item"><a href="/posts/ed47.html" title="python数据可视化"><img class="relatedPosts_cover" src="https://gitee.com/xgpqq/tuchuang/raw/master/img/qweq59p.jpg"><div class="relatedPosts_main is-center"><div class="relatedPosts_date"><i class="fa fa-history fa-fw" aria-hidden="true"></i> 2020-06-30</div><div class="relatedPosts_title">python数据可视化</div></div></a></div><div class="relatedPosts_item"><a href="/posts/10c6.html" title="初识Django和宝塔面板"><img class="relatedPosts_cover" src="https://gitee.com/xgpqq/tuchuang/raw/master/img/qweq61p.jpg"><div class="relatedPosts_main is-center"><div class="relatedPosts_date"><i class="fa fa-history fa-fw" aria-hidden="true"></i> 2020-06-30</div><div class="relatedPosts_title">初识Django和宝塔面板</div></div></a></div><div class="relatedPosts_item"><a href="/posts/1b1f.html" title="PyCharm实现（Django的模型、表单、管理工具、引入静态文件）"><img class="relatedPosts_cover" src="https://gitee.com/xgpqq/tuchuang/raw/master/img/qweq63p.jpg"><div class="relatedPosts_main is-center"><div class="relatedPosts_date"><i class="fa fa-history fa-fw" aria-hidden="true"></i> 2020-06-30</div><div class="relatedPosts_title">PyCharm实现（Django的模型、表单、管理工具、引入静态文件）</div></div></a></div></div><div class="clear_both"></div></div><hr><div id="post-comment"><div class="comment_headling"><i class="fa fa-comments fa-fw" aria-hidden="true"></i><span> 评论</span></div><div id="lv-container" data-id="city" data-uid="MTAyMC80OTM0NS8yNTgzNw=="><script>(function(d, s) {
    var j, e = d.getElementsByTagName(s)[0];
    if (typeof LivereTower === 'function') { return; }
    j = d.createElement(s);
    j.src = 'https://cdn-city.livere.com/js/embed.dist.js';
    j.async = true;
    e.parentNode.insertBefore(j, e);
})(document, 'script');</script></div></div></article></main><footer id="footer" style="background-image: url(https://gitee.com/xgpqq/tuchuang/raw/master/img/qweq72p.jpg)" data-type="photo"><div id="footer-wrap"><div class="copyright">&copy;2019 - 2020 By Wu Shao Dong</div><div class="framework-info"><span>驱动 </span><a href="https://hexo.io" target="_blank" rel="noopener"><span>Hexo</span></a><span class="footer-separator">|</span><span>主题 </span><a href="https://github.com/jerryc127/hexo-theme-butterfly" target="_blank" rel="noopener"><span>Butterfly</span></a></div><div class="ypy"><a href="https://console.upyun.com/services/file/" target="_blank" rel="noopener"><img class="icp-icon" src="/img/1591433700(1).png"/><span></span></a></div></div></footer></div><section class="rightside" id="rightside"><div id="rightside-config-hide"><i class="fa fa-book" id="readmode" title="阅读模式"></i><i class="fa fa-plus" id="font_plus" title="放大字体"></i><i class="fa fa-minus" id="font_minus" title="缩小字体"></i><a class="translate_chn_to_cht" id="translateLink" href="javascript:translatePage();" title="简繁转换" target="_self">繁</a><i class="darkmode far fa-moon" id="darkmode" title="夜间模式"></i></div><div id="rightside-config-show"><div id="rightside_config" title="设置"><i class="fa fa-cog" aria-hidden="true"></i></div><a id="to_comment" href="#post-comment" title="直达评论"><i class="scroll_to_comment fa fa-comments">  </i></a><i class="fa fa-list-ul close" id="mobile-toc-button" title="目录" aria-hidden="true"></i><i class="fa fa-arrow-up" id="go-up" title="回到顶部" aria-hidden="true"></i></div></section><div class="search-dialog" id="local-search"><div class="search-dialog__title" id="local-search-title">本地搜索</div><div id="local-input-panel"><div id="local-search-input"><div class="local-search-box"><input class="local-search-box--input" placeholder="搜索文章" type="text"/></div></div></div><hr/><div id="local-search-results"><div id="local-hits"></div><div id="local-stats"><div class="local-search-stats__hr" id="hr"><span>由</span> <a href="https://github.com/wzpan/hexo-generator-search" target="_blank" rel="noopener" style="color:#49B1F5;">hexo-generator-search</a>
 <span>提供支持</span></div></div></div><span class="search-close-button"><i class="fa fa-times"></i></span></div><div class="search-mask"></div><script src="https://cdn.jsdelivr.net/npm/jquery@latest/dist/jquery.min.js"></script><script src="/js/utils.js"></script><script src="/js/main.js"></script><script src="/js/tw_cn.js"></script><script src="https://cdn.jsdelivr.net/npm/@fancyapps/fancybox@latest/dist/jquery.fancybox.min.js"></script><script src="https://cdn.jsdelivr.net/npm/animejs@latest/anime.min.js"></script><script src="/js/third-party/fireworks.js"></script><script id="ribbon_piao" mobile="false" src="/js/third-party/piao.js"></script><script id="canvas_nest" color="0,0,255" opacity="0.7" zIndex="-1" count="99" mobile="false" src="/js/third-party/canvas-nest.js"></script><script src="/js/third-party/activate-power-mode.js"></script><script>POWERMODE.colorful = true;
POWERMODE.shake = true;
document.body.addEventListener('input', POWERMODE);
</script><script async src="//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script><script src="https://cdn.jsdelivr.net/npm/instant.page@3/instantpage.min.js" type="module"></script><script src="/js/search/local-search.js"></script><script>var endLoading = function () {
  document.body.style.overflow = 'auto';
  document.getElementById('loading-box').classList.add("loaded")
}
window.addEventListener('load',endLoading)</script><script src="/live2dw/lib/L2Dwidget.min.js?094cbace49a39548bed64abff5988b05"></script><script>L2Dwidget.init({"log":false,"pluginJsPath":"lib/","pluginModelPath":"assets/","pluginRootPath":"live2dw/","tagMode":false});</script></body></html>