<!DOCTYPE html><html lang="zh-Hans" data-theme="light"><head><meta charset="UTF-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width,initial-scale=1"><title>06 pod资源对象 | Xgp &amp; Blog</title><meta name="description" content="一，k8s的资源对象Deployment、Service、Pod是k8s最核心的3个资源对象  Deployment：最常见的无状态应用的控制器，支持应用的扩缩容、滚动升级等操作。 Service：为弹性变动且存在生命周期的Pod对象提供了一个固定的访问接口，用于服务发现和服务访问。 Pod：是运行容器以及调度的最小单位。同一个pod可以同时运行多个容器，这些容器共享net、UTS、IPC，除此之"><meta name="author" content="Wu Shao Dong"><meta name="copyright" content="Wu Shao Dong"><meta name="format-detection" content="telephone=no"><link rel="shortcut icon" href="/img/favicon.ico"><meta http-equiv="Cache-Control" content="no-transform"><meta http-equiv="Cache-Control" content="no-siteapp"><link rel="preconnect" href="//cdn.jsdelivr.net"/><link rel="dns-prefetch" href="//cdn.jsdelivr.net"/><link rel="preconnect" href="https://fonts.googleapis.com" crossorigin="crossorigin"/><link rel="dns-prefetch" href="https://fonts.googleapis.com"/><link rel="preconnect" href="//busuanzi.ibruce.info"/><link rel="dns-prefetch" href="//busuanzi.ibruce.info"/><meta name="twitter:card" content="summary"><meta name="twitter:title" content="06 pod资源对象"><meta name="twitter:description" content="一，k8s的资源对象Deployment、Service、Pod是k8s最核心的3个资源对象  Deployment：最常见的无状态应用的控制器，支持应用的扩缩容、滚动升级等操作。 Service：为弹性变动且存在生命周期的Pod对象提供了一个固定的访问接口，用于服务发现和服务访问。 Pod：是运行容器以及调度的最小单位。同一个pod可以同时运行多个容器，这些容器共享net、UTS、IPC，除此之"><meta name="twitter:image" content="https://wsdlxgp.top/img/post.jpg"><meta property="og:type" content="article"><meta property="og:title" content="06 pod资源对象"><meta property="og:url" content="https://wsdlxgp.top/posts/cf38.html"><meta property="og:site_name" content="Xgp &amp; Blog"><meta property="og:description" content="一，k8s的资源对象Deployment、Service、Pod是k8s最核心的3个资源对象  Deployment：最常见的无状态应用的控制器，支持应用的扩缩容、滚动升级等操作。 Service：为弹性变动且存在生命周期的Pod对象提供了一个固定的访问接口，用于服务发现和服务访问。 Pod：是运行容器以及调度的最小单位。同一个pod可以同时运行多个容器，这些容器共享net、UTS、IPC，除此之"><meta property="og:image" content="https://wsdlxgp.top/img/post.jpg"><meta property="article:published_time" content="2020-04-25T03:29:33.598Z"><meta property="article:modified_time" content="2020-04-25T03:41:46.889Z"><script src="https://cdn.jsdelivr.net/npm/js-cookie/dist/js.cookie.min.js"></script><script>var autoChangeMode = '1'
var t = Cookies.get("theme")
if (autoChangeMode == '1'){
  var isDarkMode = window.matchMedia("(prefers-color-scheme: dark)").matches
  var isLightMode = window.matchMedia("(prefers-color-scheme: light)").matches
  var isNotSpecified = window.matchMedia("(prefers-color-scheme: no-preference)").matches
  var hasNoSupport = !isDarkMode && !isLightMode && !isNotSpecified

  if (t === undefined){
    if (isLightMode) activateLightMode()
    else if (isDarkMode) activateDarkMode()
    else if (isNotSpecified || hasNoSupport){
      console.log('You specified no preference for a color scheme or your browser does not support it. I Schedule dark mode during night time.')
      var now = new Date()
      var hour = now.getHours()
      var isNight = hour < 6 || hour >= 18
      isNight ? activateDarkMode() : activateLightMode()
  }
  } else if (t == 'light') activateLightMode()
  else activateDarkMode()

} else if (autoChangeMode == '2'){
  now = new Date();
  hour = now.getHours();
  isNight = hour < 6 || hour >= 18
  if(t === undefined) isNight? activateDarkMode() : activateLightMode()
  else if (t === 'light') activateLightMode()
  else activateDarkMode() 
} else {
  if ( t == 'dark' ) activateDarkMode()
  else if ( t == 'light') activateLightMode()
}

function activateDarkMode(){
  document.documentElement.setAttribute('data-theme', 'dark')
  if (document.querySelector('meta[name="theme-color"]') !== null){
    document.querySelector('meta[name="theme-color"]').setAttribute('content','#000')
  }
}
function activateLightMode(){
  document.documentElement.setAttribute('data-theme', 'light')
  if (document.querySelector('meta[name="theme-color"]') !== null){
  document.querySelector('meta[name="theme-color"]').setAttribute('content','#fff')
  }
}</script><link rel="stylesheet" href="/css/index.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/font-awesome@latest/css/font-awesome.min.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fancyapps/fancybox@latest/dist/jquery.fancybox.min.css"><link rel="canonical" href="https://wsdlxgp.top/posts/cf38.html"><link rel="prev" title="08 ReplicaSet、DaemonSet" href="https://wsdlxgp.top/posts/7772.html"><link rel="next" title="05 Delpoyment、service" href="https://wsdlxgp.top/posts/936d.html"><link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Titillium+Web"><script>var GLOBAL_CONFIG = { 
  root: '/',
  algolia: undefined,
  localSearch: undefined,
  translate: {"defaultEncoding":2,"translateDelay":0,"cookieDomain":"https://xxx/","msgToTraditionalChinese":"繁","msgToSimplifiedChinese":"簡"},
  copy: {
    success: 'Copy successfully',
    error: 'Copy error',
    noSupport: 'The browser does not support'
  },
  bookmark: {
    message_prev: 'Press',
    message_next: 'to bookmark this page'
  },
  runtime_unit: 'days',
  runtime: true,
  copyright: undefined,
  ClickShowText: undefined,
  medium_zoom: false,
  fancybox: true,
  Snackbar: undefined,
  baiduPush: false,
  highlightCopy: true,
  highlightLang: true,
  highlightShrink: 'false',
  isFontAwesomeV5: false,
  isPhotoFigcaption: false
  
}</script><script>var GLOBAL_CONFIG_SITE = { 
  isPost: true,
  isHome: false,
  isSidebar: true  
  }</script><noscript><style>
#page-header {
  opacity: 1
}
.justified-gallery img{
  opacity: 1
}
</style></noscript><meta name="generator" content="Hexo 4.2.0"><link rel="stylesheet" href="/css/prism-tomorrow.css" type="text/css"><link rel="alternate" href="/atom.xml" title="Xgp & Blog" type="application/atom+xml">
</head><body><canvas class="fireworks"></canvas><div id="mobile-sidebar"><div id="menu_mask"></div><div id="mobile-sidebar-menus"><div class="mobile_author_icon"><img class="avatar-img" src="/img/avatar.png" onerror="onerror=null;src='/img/friend_404.gif'" alt="avatar"/></div><div class="mobile_post_data"><div class="mobile_data_item is-center"><div class="mobile_data_link"><a href="/archives/"><div class="headline">Articles</div><div class="length_num">16</div></a></div></div><div class="mobile_data_item is-center">      <div class="mobile_data_link"><a href="/tags/"><div class="headline">Tags</div><div class="length_num">3</div></a></div></div><div class="mobile_data_item is-center">     <div class="mobile_data_link"><a href="/categories/"><div class="headline">Categories</div><div class="length_num">2</div></a></div></div></div><hr/><div class="menus_items"><div class="menus_item"><a class="site-page" href="/"><i class="fa-fw fa fa-home"></i><span> Home</span></a></div><div class="menus_item"><a class="site-page" href="/archives/"><i class="fa-fw fa fa-archive"></i><span> Archives</span></a></div><div class="menus_item"><a class="site-page" href="/tags/"><i class="fa-fw fa fa-tags"></i><span> Tags</span></a></div><div class="menus_item"><a class="site-page" href="/categories/"><i class="fa-fw fa fa-folder-open"></i><span> Categories</span></a></div><div class="menus_item"><a class="site-page" href="/link/"><i class="fa-fw fa fa-link"></i><span> Link</span></a></div><div class="menus_item"><a class="site-page" href="/about/"><i class="fa-fw fa fa-heart"></i><span> About</span></a></div><div class="menus_item"><a class="site-page"><i class="fa-fw fa fa-list" aria-hidden="true"></i><span> List</span><i class="fa fa-chevron-down menus-expand" aria-hidden="true"></i></a><ul class="menus_item_child"><li><a class="site-page" href="/music/"><i class="fa-fw fa fa-music"></i><span> Music</span></a></li><li><a class="site-page" href="/movies/"><i class="fa-fw fa fa-film"></i><span> Movie</span></a></li></ul></div></div></div></div><i class="fa fa-arrow-right on" id="toggle-sidebar" aria-hidden="true">     </i><div id="sidebar"><div class="sidebar-toc"><div class="sidebar-toc__title">Catalog</div><div class="sidebar-toc__progress"><span class="progress-notice">You've read</span><span class="progress-num">0</span><span class="progress-percentage">%</span><div class="sidebar-toc__progress-bar">     </div></div><div class="sidebar-toc__content"><ol class="toc"><li class="toc-item toc-level-1"><a class="toc-link" href="#一，k8s的资源对象"><span class="toc-number">1.</span> <span class="toc-text">一，k8s的资源对象</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#Pod的生命周期被定义为以下几个阶段。"><span class="toc-number">1.1.</span> <span class="toc-text">Pod的生命周期被定义为以下几个阶段。</span></a></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#环境介绍"><span class="toc-number">2.</span> <span class="toc-text">环境介绍</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#二，Namespace：名称空间"><span class="toc-number">3.</span> <span class="toc-text">二，Namespace：名称空间</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#1-查看名称空间"><span class="toc-number">3.1.</span> <span class="toc-text">1.查看名称空间</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#2-查看名称空间详细信息"><span class="toc-number">3.2.</span> <span class="toc-text">2.查看名称空间详细信息</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#3-创建名称空间"><span class="toc-number">3.3.</span> <span class="toc-text">3.创建名称空间</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#查看一下"><span class="toc-number">3.3.1.</span> <span class="toc-text">查看一下</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#4-创建namespace的yaml文件"><span class="toc-number">3.4.</span> <span class="toc-text">4.创建namespace的yaml文件</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#（1）查看格式"><span class="toc-number">3.4.1.</span> <span class="toc-text">（1）查看格式</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#（2）创建namespace的yaml文件"><span class="toc-number">3.4.2.</span> <span class="toc-text">（2）创建namespace的yaml文件</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#（3）运行namespace的yaml文件"><span class="toc-number">3.4.3.</span> <span class="toc-text">（3）运行namespace的yaml文件</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#（4）查看一下"><span class="toc-number">3.4.4.</span> <span class="toc-text">（4）查看一下</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#4-删除名称空间"><span class="toc-number">3.5.</span> <span class="toc-text">4.删除名称空间</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#5-查看指定名称空间"><span class="toc-number">3.6.</span> <span class="toc-text">5.查看指定名称空间</span></a></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#三，Pod"><span class="toc-number">4.</span> <span class="toc-text">三，Pod</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#1-编写一个pod的yaml文件"><span class="toc-number">4.1.</span> <span class="toc-text">1.编写一个pod的yaml文件</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#（1）运行一下"><span class="toc-number">4.1.1.</span> <span class="toc-text">（1）运行一下</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#（2）查看一下"><span class="toc-number">4.1.2.</span> <span class="toc-text">（2）查看一下</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#2-指定pod的namespace名称空间"><span class="toc-number">4.2.</span> <span class="toc-text">2.指定pod的namespace名称空间</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#（1）修改pod的yaml文件"><span class="toc-number">4.2.1.</span> <span class="toc-text">（1）修改pod的yaml文件</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#执行一下"><span class="toc-number">4.2.1.0.1.</span> <span class="toc-text">执行一下</span></a></li></ol></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#（2）查看一下-1"><span class="toc-number">4.2.2.</span> <span class="toc-text">（2）查看一下</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#3-pod中镜像获取策略"><span class="toc-number">4.3.</span> <span class="toc-text">3.pod中镜像获取策略</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#4-观察pod和service的不同并关联"><span class="toc-number">4.4.</span> <span class="toc-text">4.观察pod和service的不同并关联</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#（1）pod的yaml文件（指定端口）"><span class="toc-number">4.4.1.</span> <span class="toc-text">（1）pod的yaml文件（指定端口）</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#lt-1-gt-删除之前的pod"><span class="toc-number">4.4.1.1.</span> <span class="toc-text">&lt;1&gt;删除之前的pod</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#lt-2-gt-执行一下"><span class="toc-number">4.4.1.2.</span> <span class="toc-text">&lt;2&gt;执行一下</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#lt-3-gt-查看一下"><span class="toc-number">4.4.1.3.</span> <span class="toc-text">&lt;3&gt;查看一下</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#（2）pod的yaml文件（修改端口）"><span class="toc-number">4.4.2.</span> <span class="toc-text">（2）pod的yaml文件（修改端口）</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#lt-1-gt-删除之前的pod-1"><span class="toc-number">4.4.2.1.</span> <span class="toc-text">&lt;1&gt;删除之前的pod</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#lt-2-gt-执行一下-1"><span class="toc-number">4.4.2.2.</span> <span class="toc-text">&lt;2&gt;执行一下</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#lt-3-gt-查看一下-1"><span class="toc-number">4.4.2.3.</span> <span class="toc-text">&lt;3&gt;查看一下</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#lt-4-gt-访问一下"><span class="toc-number">4.4.2.4.</span> <span class="toc-text">&lt;4&gt;访问一下</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#（3）pod的yaml文件（添加标签）"><span class="toc-number">4.4.3.</span> <span class="toc-text">（3）pod的yaml文件（添加标签）</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#————————————–pod———————————————"><span class="toc-number">4.4.3.1.</span> <span class="toc-text">————————————–pod———————————————</span></a></li></ol></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#（4）编写一个service的yaml文件"><span class="toc-number">4.5.</span> <span class="toc-text">（4）编写一个service的yaml文件</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#lt-1-gt-执行一下"><span class="toc-number">4.5.0.1.</span> <span class="toc-text">&lt;1&gt;执行一下</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#lt-2-gt-查看一下"><span class="toc-number">4.5.0.2.</span> <span class="toc-text">&lt;2&gt;查看一下</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#lt-4-gt-访问一下-1"><span class="toc-number">4.5.0.3.</span> <span class="toc-text">&lt;4&gt;访问一下</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#————————————–service———————————————"><span class="toc-number">4.5.0.4.</span> <span class="toc-text">————————————–service———————————————</span></a></li></ol></li></ol></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#四，容器的重启策略"><span class="toc-number">5.</span> <span class="toc-text">四，容器的重启策略</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#五，pod的默认健康检查"><span class="toc-number">6.</span> <span class="toc-text">五，pod的默认健康检查</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#（1）编写健康检查的yaml文件"><span class="toc-number">6.1.</span> <span class="toc-text">（1）编写健康检查的yaml文件</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#lt-1-gt-执行一下-1"><span class="toc-number">6.1.1.</span> <span class="toc-text">&lt;1&gt;执行一下</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#lt-2-gt-查看一下-1"><span class="toc-number">6.1.2.</span> <span class="toc-text">&lt;2&gt;查看一下</span></a></li></ol></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#六，小实验"><span class="toc-number">7.</span> <span class="toc-text">六，小实验</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#1）以自己的名称创建一个k8s名称空间，以下所有操作都在此名称空间中。"><span class="toc-number">7.1.</span> <span class="toc-text">1）以自己的名称创建一个k8s名称空间，以下所有操作都在此名称空间中。</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#（1）创建名称空间"><span class="toc-number">7.1.1.</span> <span class="toc-text">（1）创建名称空间</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#（2）查看一下-2"><span class="toc-number">7.1.2.</span> <span class="toc-text">（2）查看一下</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#2）创建一个Pod资源对象，使用的是私有仓库中私有镜像，其镜像的下载策略为：NEVER。-Pod的重启策略为：-Never"><span class="toc-number">7.2.</span> <span class="toc-text">2）创建一个Pod资源对象，使用的是私有仓库中私有镜像，其镜像的下载策略为：NEVER。 Pod的重启策略为： Never.</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#3）创建出容器之后，执行非正常退出，查看Pod的最终状态。"><span class="toc-number">7.3.</span> <span class="toc-text">3）创建出容器之后，执行非正常退出，查看Pod的最终状态。</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#（1）执行一下上面pod的yaml文件"><span class="toc-number">7.3.1.</span> <span class="toc-text">（1）执行一下上面pod的yaml文件</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#（2）动态查看ns中test-pod的信息"><span class="toc-number">7.3.2.</span> <span class="toc-text">（2）动态查看ns中test-pod的信息</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#4-创建一个Service资源对象，与上述Pod对象关联，验证他们的关联性。"><span class="toc-number">7.4.</span> <span class="toc-text">4) 创建一个Service资源对象，与上述Pod对象关联，验证他们的关联性。</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#（1）修改pod的yaml文件-1"><span class="toc-number">7.4.1.</span> <span class="toc-text">（1）修改pod的yaml文件</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#（1）编写service的yaml文件"><span class="toc-number">7.4.2.</span> <span class="toc-text">（1）编写service的yaml文件</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#（2）执行一下"><span class="toc-number">7.4.3.</span> <span class="toc-text">（2）执行一下</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#（3）查看一下"><span class="toc-number">7.4.4.</span> <span class="toc-text">（3）查看一下</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#（4）访问一下"><span class="toc-number">7.4.5.</span> <span class="toc-text">（4）访问一下</span></a></li></ol></li></ol></li></ol></div></div></div><div id="body-wrap"><div class="post-bg" id="nav" style="background-image: url(/img/post.jpg)"><div id="page-header"><span class="pull_left" id="blog_name"><a class="blog_title" id="site-name" href="/">Xgp &amp; Blog</a></span><span class="pull_right menus"><div class="menus_items"><div class="menus_item"><a class="site-page" href="/"><i class="fa-fw fa fa-home"></i><span> Home</span></a></div><div class="menus_item"><a class="site-page" href="/archives/"><i class="fa-fw fa fa-archive"></i><span> Archives</span></a></div><div class="menus_item"><a class="site-page" href="/tags/"><i class="fa-fw fa fa-tags"></i><span> Tags</span></a></div><div class="menus_item"><a class="site-page" href="/categories/"><i class="fa-fw fa fa-folder-open"></i><span> Categories</span></a></div><div class="menus_item"><a class="site-page" href="/link/"><i class="fa-fw fa fa-link"></i><span> Link</span></a></div><div class="menus_item"><a class="site-page" href="/about/"><i class="fa-fw fa fa-heart"></i><span> About</span></a></div><div class="menus_item"><a class="site-page"><i class="fa-fw fa fa-list" aria-hidden="true"></i><span> List</span><i class="fa fa-chevron-down menus-expand" aria-hidden="true"></i></a><ul class="menus_item_child"><li><a class="site-page" href="/music/"><i class="fa-fw fa fa-music"></i><span> Music</span></a></li><li><a class="site-page" href="/movies/"><i class="fa-fw fa fa-film"></i><span> Movie</span></a></li></ul></div></div><span class="toggle-menu close"><a class="site-page"><i class="fa fa-bars fa-fw" aria-hidden="true"></i></a></span></span></div><div id="post-info"><div id="post-title"><div class="posttitle">06 pod资源对象</div></div><div id="post-meta"><div class="meta-firstline"><time class="post-meta__date"><span class="post-meta__date-created" title="Created 2020-04-25 11:29:33"><i class="fa fa-calendar" aria-hidden="true"></i> Created 2020-04-25</span><span class="post-meta__separator">|</span><span class="post-meta__date-updated" title="Updated 2020-04-25 11:41:46"><i class="fa fa-history" aria-hidden="true"></i> Updated 2020-04-25</span></time></div><div class="meta-secondline"> <span class="post-meta-wordcount"><i class="post-meta__icon fa fa-file-word-o" aria-hidden="true"></i><span>Word count:</span><span class="word-count">2.8k</span><span class="post-meta__separator">|</span><i class="post-meta__icon fa fa-clock-o" aria-hidden="true"></i><span>Reading time: 11 min</span></span></div><div class="meta-thirdline"><span class="post-meta-pv-cv"><span class="post-meta__separator">|</span><i class="fa fa-eye post-meta__icon" aria-hidden="true"> </i><span>Post View:</span><span id="busuanzi_value_page_pv"></span></span><span class="post-meta-commentcount"></span></div></div></div></div><main class="layout_post" id="content-inner"><article id="post"><div id="article-container"><h1 id="一，k8s的资源对象"><a href="#一，k8s的资源对象" class="headerlink" title="一，k8s的资源对象"></a>一，k8s的资源对象</h1><p><strong><em>Deployment、Service、Pod是k8s最核心的3个资源对象</em></strong></p>
<blockquote>
<p><strong>Deployment：</strong>最常见的无状态应用的控制器，支持应用的扩缩容、滚动升级等操作。</p>
<p><strong>Service：</strong>为弹性变动且存在生命周期的Pod对象提供了一个固定的访问接口，用于服务发现和服务访问。</p>
<p><strong>Pod：</strong>是运行容器以及调度的最小单位。同一个pod可以同时运行多个容器，这些容器共享net、UTS、IPC，除此之外还有USER、PID、MOUNT。</p>
<p><strong>ReplicationController：</strong>用于确保每个Pod副本在任意时刻都能满足目标数量，简单来说，它用于每个容器或容器组总是运行并且可以访问的：老一代无状态的Pod应用控制器。</p>
<p><strong>RwplicatSet：</strong>新一代的无状态的Pod应用控制器，它与RC的不同之处在于支持的标签选择器不同，RC只支持等值选择器（键值对），RS还额外支持基于集合的选择器。</p>
<p><strong>StatefulSet：</strong>用于管理有状态的持久化应用，如database服务程序，它与Deployment不同之处在于，它会为每一个pod创建一个独有的持久性标识符，并确保每个pod之间的顺序性。</p>
<p><strong>DaemonSet：</strong>用于确保每一个节点都运行了某个pod的一个副本，新增的节点一样会被添加到此类pod，在节点移除时，此pod会被回收。</p>
<p><strong>Job：</strong>用于管理运行完成后即可终止的应用，例如批量处理做作业任务；</p>
<p><strong>volume：</strong>pv pvc<br><strong>ConfigMap：</strong><br><strong>Secret：</strong><br><strong>Role：</strong><br><strong>ClusterRole：</strong><br><strong>RoleBinding：</strong><br><strong>cluster RoleBinding：</strong><br><strong>service account：</strong><br><strong>Helm：</strong></p>
</blockquote>
<h2 id="Pod的生命周期被定义为以下几个阶段。"><a href="#Pod的生命周期被定义为以下几个阶段。" class="headerlink" title="Pod的生命周期被定义为以下几个阶段。"></a>Pod的生命周期被定义为以下几个阶段。</h2><blockquote>
<ul>
<li><strong>Pending：Pod已经被创建，但是一个或者多个容器还未创建，这包括Pod调度阶段，以及容器镜像的下载过程。</strong></li>
<li><strong>Running：Pod已经被调度到Node，所有容器已经创建，并且至少一个容器在运行或者正在重启。</strong></li>
<li><strong>Succeeded：Pod中所有容器正常退出。</strong></li>
<li><strong>Failed：Pod中所有容器退出，至少有一个容器是一次退出的。</strong></li>
</ul>
</blockquote>
<h1 id="环境介绍"><a href="#环境介绍" class="headerlink" title="环境介绍"></a>环境介绍</h1><table>
<thead>
<tr>
<th>主机</th>
<th>IP地址</th>
<th>服务</th>
</tr>
</thead>
<tbody><tr>
<td>master</td>
<td>192.168.1.21</td>
<td>k8s</td>
</tr>
<tr>
<td>node01</td>
<td>192.168.1.22</td>
<td>k8s</td>
</tr>
<tr>
<td>node02</td>
<td>192.168.1.23</td>
<td>k8s</td>
</tr>
</tbody></table>
<h1 id="二，Namespace：名称空间"><a href="#二，Namespace：名称空间" class="headerlink" title="二，Namespace：名称空间"></a>二，Namespace：名称空间</h1><p><strong>默认的名称空间：</strong></p>
<blockquote>
<p><strong>Namespace（命名空间）是kubernetes系统中的另一个重要的概念，通过将系统内部的对象“分配”到不同的Namespace中，形成逻辑上分组的不同项目、小组或用户组，便于不同的分组在共享使用整个集群的资源的同时还能被分别管理。</strong></p>
<p>   <strong>Kubernetes集群在启动后，会创建一个名为“default”的Namespace，如果不特别指明Namespace，则用户创建的Pod、RC、Service都被系统创建到“default”的Namespace中。</strong></p>
</blockquote>
<h2 id="1-查看名称空间"><a href="#1-查看名称空间" class="headerlink" title="1.查看名称空间"></a>1.查看名称空间</h2><pre><code>[root@master ~]# kubectl get namespaces</code></pre><p>![image-20200109094700728](E:\软件\博客\Blog\blog\source_posts\06 pod资源对象.assets\image-20200109094700728.png)</p>
<h2 id="2-查看名称空间详细信息"><a href="#2-查看名称空间详细信息" class="headerlink" title="2.查看名称空间详细信息"></a>2.查看名称空间详细信息</h2><pre><code>[root@master ~]# kubectl describe ns default</code></pre><p>![image-20200109095006067](E:\软件\博客\Blog\blog\source_posts\06 pod资源对象.assets\image-20200109095006067.png)</p>
<h2 id="3-创建名称空间"><a href="#3-创建名称空间" class="headerlink" title="3.创建名称空间"></a>3.创建名称空间</h2><pre><code>[root@master ~]# kubectl create ns bdqn</code></pre><h3 id="查看一下"><a href="#查看一下" class="headerlink" title="查看一下"></a>查看一下</h3><pre><code>[root@master ~]# kubectl get namespaces</code></pre><p>![image-20200109095153448](E:\软件\博客\Blog\blog\source_posts\06 pod资源对象.assets\image-20200109095153448.png)</p>
<h2 id="4-创建namespace的yaml文件"><a href="#4-创建namespace的yaml文件" class="headerlink" title="4.创建namespace的yaml文件"></a>4.创建namespace的yaml文件</h2><h3 id="（1）查看格式"><a href="#（1）查看格式" class="headerlink" title="（1）查看格式"></a>（1）查看格式</h3><pre><code>[root@master ~]# kubectl explain ns
//查看nasespace的yaml文件的格式</code></pre><h3 id="（2）创建namespace的yaml文件"><a href="#（2）创建namespace的yaml文件" class="headerlink" title="（2）创建namespace的yaml文件"></a>（2）创建namespace的yaml文件</h3><pre><code>[root@master ~]# vim test-ns.yaml
apiVersion: v1
kind: Namespace
metadata:
  name: test</code></pre><h3 id="（3）运行namespace的yaml文件"><a href="#（3）运行namespace的yaml文件" class="headerlink" title="（3）运行namespace的yaml文件"></a>（3）运行namespace的yaml文件</h3><pre><code>[root@master ~]# kubectl apply -f test-ns.yaml </code></pre><h3 id="（4）查看一下"><a href="#（4）查看一下" class="headerlink" title="（4）查看一下"></a>（4）查看一下</h3><pre><code>[root@master ~]# kubectl get ns</code></pre><p>![image-20200109095808777](E:\软件\博客\Blog\blog\source_posts\06 pod资源对象.assets\image-20200109095808777.png)</p>
<h2 id="4-删除名称空间"><a href="#4-删除名称空间" class="headerlink" title="4.删除名称空间"></a>4.删除名称空间</h2><pre><code>[root@master ~]# kubectl delete ns test 
[root@master ~]# kubectl delete -f test-ns.yaml </code></pre><p><strong>注意：namespace资源对象进用于资源对象的隔离，并不能隔绝不同名称空间的Pod之间的通信。那是网络策略资源的功能。</strong></p>
<h2 id="5-查看指定名称空间"><a href="#5-查看指定名称空间" class="headerlink" title="5.查看指定名称空间"></a>5.查看指定名称空间</h2><p><strong>可使用–namespace或-n选项</strong></p>
<pre><code>[root@master ~]# kubectl get pod -n kube-system 
[root@master ~]# kubectl get pod --namespace kube-system </code></pre><h1 id="三，Pod"><a href="#三，Pod" class="headerlink" title="三，Pod"></a>三，Pod</h1><h2 id="1-编写一个pod的yaml文件"><a href="#1-编写一个pod的yaml文件" class="headerlink" title="1.编写一个pod的yaml文件"></a>1.编写一个pod的yaml文件</h2><pre><code>[root@master ~]# vim pod.yaml
kind: Pod
apiVersion: v1
metadata:
  name: test-pod
spec:
  containers:
  - name: test-app
    image: 192.168.1.21:5000/web:v1</code></pre><p><strong><em>pod的yaml文件不支持replicas字段</em></strong></p>
<h3 id="（1）运行一下"><a href="#（1）运行一下" class="headerlink" title="（1）运行一下"></a>（1）运行一下</h3><pre><code>[root@master ~]# kubectl apply -f pod.yaml </code></pre><h3 id="（2）查看一下"><a href="#（2）查看一下" class="headerlink" title="（2）查看一下"></a>（2）查看一下</h3><pre><code>[root@master ~]# kubectl get pod</code></pre><p>![image-20200109100836911](E:\软件\博客\Blog\blog\source_posts\06 pod资源对象.assets\image-20200109100836911.png)</p>
<p><strong><em>ps：这个pod因为是自己创建的，所以删除之后k8s并不会自动生成，相当于docker中创建</em></strong></p>
<h2 id="2-指定pod的namespace名称空间"><a href="#2-指定pod的namespace名称空间" class="headerlink" title="2.指定pod的namespace名称空间"></a>2.指定pod的namespace名称空间</h2><h3 id="（1）修改pod的yaml文件"><a href="#（1）修改pod的yaml文件" class="headerlink" title="（1）修改pod的yaml文件"></a>（1）修改pod的yaml文件</h3><pre><code>[root@master ~]# vim pod.yaml
kind: Pod        #资源类型
apiVersion: v1   #api版本
metadata:
  name: test-pod    #指定控制器名称
  namespace: bdqn   #指定namespace（名称空间）
spec:
  containers:      #容器
  - name: test-app  #容器名称
    image: 192.168.1.21:5000/web:v1  #镜像</code></pre><h5 id="执行一下"><a href="#执行一下" class="headerlink" title="执行一下"></a>执行一下</h5><pre><code>[root@master ~]# kubectl apply -f pod.yaml </code></pre><h3 id="（2）查看一下-1"><a href="#（2）查看一下-1" class="headerlink" title="（2）查看一下"></a>（2）查看一下</h3><pre><code>[root@master ~]#  kubectl get pod -n bdqn 
//根据namespace名称查看</code></pre><p>![image-20200109101521992](E:\软件\博客\Blog\blog\source_posts\06 pod资源对象.assets\image-20200109101521992.png)</p>
<h2 id="3-pod中镜像获取策略"><a href="#3-pod中镜像获取策略" class="headerlink" title="3.pod中镜像获取策略"></a>3.pod中镜像获取策略</h2><blockquote>
<p><strong>Always：</strong>镜像标签为“laster”或镜像不存在时，总是从指定的仓库中获取镜像。</p>
<p><strong>IfNotPresent：</strong>仅当本地镜像不存在时才从目标仓库下载。</p>
<p><strong>Never：</strong>禁止从仓库中下载镜像，即只使用本地镜像。</p>
</blockquote>
<p><strong><em>注意：对于标签为“laster”或者标签不存在，其默认的镜像下载策略为“Always”，而对于其他的标签镜像，默认策略为“IfNotPresent”。</em></strong></p>
<h2 id="4-观察pod和service的不同并关联"><a href="#4-观察pod和service的不同并关联" class="headerlink" title="4.观察pod和service的不同并关联"></a>4.观察pod和service的不同并关联</h2><h3 id="（1）pod的yaml文件（指定端口）"><a href="#（1）pod的yaml文件（指定端口）" class="headerlink" title="（1）pod的yaml文件（指定端口）"></a>（1）pod的yaml文件（指定端口）</h3><pre><code>[root@master ~]# vim pod.yaml 
kind: Pod          #资源类型
apiVersion: v1      #api版本
metadata:
  name: test-pod       #指定控制器名称
  namespace: bdqn   #指定namespace（名称空间）
spec:
  containers:                          #容器
  - name: test-app                    #容器名称
    image: 192.168.1.21:5000/web:v1   #镜像
    imagePullPolicy: IfNotPresent   #获取的策略
    ports:
    - protocol: TCP
      containerPort: 80  </code></pre><h4 id="lt-1-gt-删除之前的pod"><a href="#lt-1-gt-删除之前的pod" class="headerlink" title="<1>删除之前的pod"></a>&lt;1&gt;删除之前的pod</h4><pre><code>[root@master ~]# kubectl delete pod -n bdqn test-pod </code></pre><h4 id="lt-2-gt-执行一下"><a href="#lt-2-gt-执行一下" class="headerlink" title="<2>执行一下"></a>&lt;2&gt;执行一下</h4><pre><code>[root@master ~]# kubectl apply -f pod.yaml </code></pre><h4 id="lt-3-gt-查看一下"><a href="#lt-3-gt-查看一下" class="headerlink" title="<3>查看一下"></a>&lt;3&gt;查看一下</h4><pre><code>[root@master ~]# kubectl get pod -n bdqn </code></pre><p>![image-20200109110215669](E:\软件\博客\Blog\blog\source_posts\06 pod资源对象.assets\image-20200109110215669.png)</p>
<h3 id="（2）pod的yaml文件（修改端口）"><a href="#（2）pod的yaml文件（修改端口）" class="headerlink" title="（2）pod的yaml文件（修改端口）"></a>（2）pod的yaml文件（修改端口）</h3><pre><code>[root@master ~]# vim pod.yaml 
kind: Pod
apiVersion: v1
metadata:
  name: test-pod
  namespace: bdqn
spec:
  containers:
  - name: test-app
    image: 192.168.1.21:5000/web:v1
    imagePullPolicy: IfNotPresent
    ports:
    - protocol: TCP
      containerPort: 90   #改一下端口</code></pre><h4 id="lt-1-gt-删除之前的pod-1"><a href="#lt-1-gt-删除之前的pod-1" class="headerlink" title="<1>删除之前的pod"></a>&lt;1&gt;删除之前的pod</h4><pre><code>[root@master ~]# kubectl delete pod -n bdqn test-pod </code></pre><h4 id="lt-2-gt-执行一下-1"><a href="#lt-2-gt-执行一下-1" class="headerlink" title="<2>执行一下"></a>&lt;2&gt;执行一下</h4><pre><code>[root@master ~]# kubectl apply -f pod.yaml </code></pre><h4 id="lt-3-gt-查看一下-1"><a href="#lt-3-gt-查看一下-1" class="headerlink" title="<3>查看一下"></a>&lt;3&gt;查看一下</h4><pre><code>[root@master ~]# kubectl get pod -n bdqn -o wide</code></pre><p>![image-20200109110409584](E:\软件\博客\Blog\blog\source_posts\06 pod资源对象.assets\image-20200109110409584.png)</p>
<h4 id="lt-4-gt-访问一下"><a href="#lt-4-gt-访问一下" class="headerlink" title="<4>访问一下"></a>&lt;4&gt;访问一下</h4><p>![image-20200109110430334](E:\软件\博客\Blog\blog\source_posts\06 pod资源对象.assets\image-20200109110430334.png)</p>
<p><strong>会发现修改的90端口并不生效，他只是一个提示字段并不生效。</strong></p>
<h3 id="（3）pod的yaml文件（添加标签）"><a href="#（3）pod的yaml文件（添加标签）" class="headerlink" title="（3）pod的yaml文件（添加标签）"></a>（3）pod的yaml文件（添加标签）</h3><pre><code>[root@master ~]# vim pod.yaml 
kind: Pod
apiVersion: v1
metadata:
  name: test-pod
  namespace: bdqn
  labels:                 #标签
    app: test-web          #标签名称
spec:
  containers:
  - name: test-app
    image: 192.168.1.21:5000/web:v1
    imagePullPolicy: IfNotPresent
    ports:
    - protocol: TCP
      containerPort: 90   #改一下端口</code></pre><h4 id="————————————–pod———————————————"><a href="#————————————–pod———————————————" class="headerlink" title="————————————–pod———————————————"></a>————————————–pod———————————————</h4><h2 id="（4）编写一个service的yaml文件"><a href="#（4）编写一个service的yaml文件" class="headerlink" title="（4）编写一个service的yaml文件"></a>（4）编写一个service的yaml文件</h2><pre><code>[root@master ~]# vim test-svc.yaml 
apiVersion: v1      #api版本
kind: Service          #资源类型
metadata:
  name: test-svc       #指定控制器名称
  namespace: bdqn   #指定namespace（名称空间）
spec:
  selector:          #标签
    app: test-web    #标签名称（须和pod的标签名称一致）
  ports:              
  - port: 80          #宿主机端口
    targetPort: 80    #容器端口</code></pre><p><strong><em>会发现添加的80端口生效了，所以不能乱改。</em></strong></p>
<h4 id="lt-1-gt-执行一下"><a href="#lt-1-gt-执行一下" class="headerlink" title="<1>执行一下"></a>&lt;1&gt;执行一下</h4><pre><code>[root@master ~]# kubectl apply -f test-svc.yaml</code></pre><h4 id="lt-2-gt-查看一下"><a href="#lt-2-gt-查看一下" class="headerlink" title="<2>查看一下"></a>&lt;2&gt;查看一下</h4><pre><code>[root@master ~]# kubectl get svc -n bdqn </code></pre><p>![image-20200109121106859](E:\软件\博客\Blog\blog\source_posts\06 pod资源对象.assets\image-20200109121106859.png)</p>
<pre><code>[root@master ~]# kubectl describe svc -n bdqn test-svc </code></pre><p>![image-20200109121139399](E:\软件\博客\Blog\blog\source_posts\06 pod资源对象.assets\image-20200109121139399.png)</p>
<h4 id="lt-4-gt-访问一下-1"><a href="#lt-4-gt-访问一下-1" class="headerlink" title="<4>访问一下"></a>&lt;4&gt;访问一下</h4><pre><code>[root@master ~]# curl 10.98.57.97 </code></pre><p>![image-20200109121205607](E:\软件\博客\Blog\blog\source_posts\06 pod资源对象.assets\image-20200109121205607.png)</p>
<h4 id="————————————–service———————————————"><a href="#————————————–service———————————————" class="headerlink" title="————————————–service———————————————"></a>————————————–service———————————————</h4><h1 id="四，容器的重启策略"><a href="#四，容器的重启策略" class="headerlink" title="四，容器的重启策略"></a>四，容器的重启策略</h1><p><strong>Pod的重启策略（RestartPolicy）应用与Pod内所有容器，并且仅在Pod所处的Node上由kubelet进行判断和重启操作。当某个容器异常退出或者健康检查失败时，kubelet将根据RestartPolicy的设置来进行相应的操作。</strong></p>
<blockquote>
<p><strong>Always：</strong>（默认情况下使用）但凡Pod对象终止就将其重启；<br><strong>OnFailure：</strong>仅在Pod对象出现错误时才将其重启；<br><strong>Never：</strong>从不重启；</p>
</blockquote>
<h1 id="五，pod的默认健康检查"><a href="#五，pod的默认健康检查" class="headerlink" title="五，pod的默认健康检查"></a>五，pod的默认健康检查</h1><p><strong>每个容器启动时都会执行一个进程，此进程由 Dockerfile 的 CMD 或 ENTRYPOINT 指定。如果进程退出时返回码非零，则认为容器发生故障，Kubernetes 就会根据 <code>restartPolicy</code> 重启容器。</strong></p>
<h2 id="（1）编写健康检查的yaml文件"><a href="#（1）编写健康检查的yaml文件" class="headerlink" title="（1）编写健康检查的yaml文件"></a>（1）编写健康检查的yaml文件</h2><p><strong>下面我们模拟一个容器发生故障的场景，Pod 配置文件如下：</strong></p>
<pre><code>[root@master ~]# vim healcheck.yaml 
apiVersion: v1
kind: Pod
metadata:
  labels:
    test: healcheck
  name:  healcheck
spec:
  restartPolicy: OnFailure  #指定重启策略
  containers:
  - name:  healcheck
    image: busybox:latest
    args:                   #生成pod时运行的命令
    - /bin/sh
    - -c
    - sleep 20; exit 1 </code></pre><h3 id="lt-1-gt-执行一下-1"><a href="#lt-1-gt-执行一下-1" class="headerlink" title="<1>执行一下"></a>&lt;1&gt;执行一下</h3><pre><code>[root@master ~]# kubectl apply -f  healcheck.yaml</code></pre><h3 id="lt-2-gt-查看一下-1"><a href="#lt-2-gt-查看一下-1" class="headerlink" title="<2>查看一下"></a>&lt;2&gt;查看一下</h3><pre><code>[root@master ~]# kubectl get pod -o wide</code></pre><p>![image-20200109121809350](E:\软件\博客\Blog\blog\source_posts\06 pod资源对象.assets\image-20200109121809350.png)</p>
<pre><code>[root@master ~]# kubectl get pod -w | grep healcheck</code></pre><p>![image-20200109121817775](E:\软件\博客\Blog\blog\source_posts\06 pod资源对象.assets\image-20200109121817775.png)</p>
<p><strong>在上面的例子中，容器进程返回值非零，Kubernetes 则认为容器发生故障，需要重启。但有不少情况是发生了故障，但进程并不会退出。</strong></p>
<h1 id="六，小实验"><a href="#六，小实验" class="headerlink" title="六，小实验"></a>六，小实验</h1><h2 id="1）以自己的名称创建一个k8s名称空间，以下所有操作都在此名称空间中。"><a href="#1）以自己的名称创建一个k8s名称空间，以下所有操作都在此名称空间中。" class="headerlink" title="1）以自己的名称创建一个k8s名称空间，以下所有操作都在此名称空间中。"></a>1）以自己的名称创建一个k8s名称空间，以下所有操作都在此名称空间中。</h2><h3 id="（1）创建名称空间"><a href="#（1）创建名称空间" class="headerlink" title="（1）创建名称空间"></a>（1）创建名称空间</h3><pre><code>[root@master ~]# kubectl create ns xgp</code></pre><h3 id="（2）查看一下-2"><a href="#（2）查看一下-2" class="headerlink" title="（2）查看一下"></a>（2）查看一下</h3><pre><code>[root@master ~]# kubectl get ns xgp </code></pre><p>![image-20200109133106300](E:\软件\博客\Blog\blog\source_posts\06 pod资源对象.assets\image-20200109133106300.png)</p>
<h2 id="2）创建一个Pod资源对象，使用的是私有仓库中私有镜像，其镜像的下载策略为：NEVER。-Pod的重启策略为：-Never"><a href="#2）创建一个Pod资源对象，使用的是私有仓库中私有镜像，其镜像的下载策略为：NEVER。-Pod的重启策略为：-Never" class="headerlink" title="2）创建一个Pod资源对象，使用的是私有仓库中私有镜像，其镜像的下载策略为：NEVER。 Pod的重启策略为： Never."></a>2）创建一个Pod资源对象，使用的是私有仓库中私有镜像，其镜像的下载策略为：NEVER。 Pod的重启策略为： Never.</h2><pre><code>[root@master ~]# vim pod.yaml
kind: Pod
apiVersion: v1
metadata:
  name: test-pod
  namespace: xgp
  labels:
    app: test-web
spec:
  restartPolicy: Never
  containers:
  - name: www
    image: 192.168.1.21:5000/web:v1
    imagePullPolicy: Never
    args:                   
    - /bin/sh
    - -c
    - sleep 90; exit 1
    ports:
    - protocol: TCP
      containerPort: 80</code></pre><h2 id="3）创建出容器之后，执行非正常退出，查看Pod的最终状态。"><a href="#3）创建出容器之后，执行非正常退出，查看Pod的最终状态。" class="headerlink" title="3）创建出容器之后，执行非正常退出，查看Pod的最终状态。"></a>3）创建出容器之后，执行非正常退出，查看Pod的最终状态。</h2><h3 id="（1）执行一下上面pod的yaml文件"><a href="#（1）执行一下上面pod的yaml文件" class="headerlink" title="（1）执行一下上面pod的yaml文件"></a>（1）执行一下上面pod的yaml文件</h3><pre><code>[root@master ~]# kubectl apply -f pod.yaml </code></pre><h3 id="（2）动态查看ns中test-pod的信息"><a href="#（2）动态查看ns中test-pod的信息" class="headerlink" title="（2）动态查看ns中test-pod的信息"></a>（2）动态查看ns中test-pod的信息</h3><pre><code>[root@master ~]# kubectl get pod -n xgp  -w | grep test-pod</code></pre><p>![image-20200109135543482](E:\软件\博客\Blog\blog\source_posts\06 pod资源对象.assets\image-20200109135543482.png)</p>
<blockquote>
<p><strong>删除test-pod</strong></p>
<pre><code>[root@master ~]# kubectl delete pod -n xgp test-pod </code></pre></blockquote>
<h2 id="4-创建一个Service资源对象，与上述Pod对象关联，验证他们的关联性。"><a href="#4-创建一个Service资源对象，与上述Pod对象关联，验证他们的关联性。" class="headerlink" title="4) 创建一个Service资源对象，与上述Pod对象关联，验证他们的关联性。"></a>4) 创建一个Service资源对象，与上述Pod对象关联，验证他们的关联性。</h2><h3 id="（1）修改pod的yaml文件-1"><a href="#（1）修改pod的yaml文件-1" class="headerlink" title="（1）修改pod的yaml文件"></a>（1）修改pod的yaml文件</h3><pre><code>[root@master ~]# vim pod.yaml
kind: Pod
apiVersion: v1
metadata:
  name: test-pod
  namespace: xgp
  labels:
    app: test-web
spec:
  restartPolicy: Never
  containers:
  - name: www
    image: 192.168.1.21:5000/web:v1
    imagePullPolicy: Never
    ports:
    - protocol: TCP
      containerPort: 80</code></pre><h3 id="（1）编写service的yaml文件"><a href="#（1）编写service的yaml文件" class="headerlink" title="（1）编写service的yaml文件"></a>（1）编写service的yaml文件</h3><pre><code>[root@master ~]# vim svc.yaml 
apiVersion: v1
kind: Service
metadata:
  name: test-svc
  namespace: xgp
spec:
  selector:
    app: test-web
  ports:
  - port: 80
    targetPort: 80</code></pre><h3 id="（2）执行一下"><a href="#（2）执行一下" class="headerlink" title="（2）执行一下"></a>（2）执行一下</h3><pre><code>[root@master ~]# kubectl apply -f svc.yaml </code></pre><h3 id="（3）查看一下"><a href="#（3）查看一下" class="headerlink" title="（3）查看一下"></a>（3）查看一下</h3><pre><code>[root@master ~]# kubectl get  pod -o wide -n xgp </code></pre><p>![image-20200109141712910](E:\软件\博客\Blog\blog\source_posts\06 pod资源对象.assets\image-20200109141712910.png)</p>
<h3 id="（4）访问一下"><a href="#（4）访问一下" class="headerlink" title="（4）访问一下"></a>（4）访问一下</h3><pre><code>[root@master ~]# curl 10.244.1.21</code></pre><p>![image-20200109141749352](E:\软件\博客\Blog\blog\source_posts\06 pod资源对象.assets\image-20200109141749352.png)</p>
<script>
        document.querySelectorAll('.github-emoji')
          .forEach(el => {
            if (!el.dataset.src) { return; }
            const img = document.createElement('img');
            img.style = 'display:none !important;';
            img.src = el.dataset.src;
            img.addEventListener('error', () => {
              img.remove();
              el.style.color = 'inherit';
              el.style.backgroundImage = 'none';
              el.style.background = 'none';
            });
            img.addEventListener('load', () => {
              img.remove();
            });
            document.body.appendChild(img);
          });
      </script></div><div class="post-copyright"><div class="post-copyright__author"><span class="post-copyright-meta">Author: </span><span class="post-copyright-info"><a href="mailto:undefined">Wu Shao Dong</a></span></div><div class="post-copyright__type"><span class="post-copyright-meta">Link: </span><span class="post-copyright-info"><a href="https://wsdlxgp.top/posts/cf38.html">https://wsdlxgp.top/posts/cf38.html</a></span></div><div class="post-copyright__notice"><span class="post-copyright-meta">Copyright Notice: </span><span class="post-copyright-info">All articles in this blog are licensed under <a href="https://creativecommons.org/licenses/by-nc-sa/4.0/" target="_blank" rel="noopener">CC BY-NC-SA 4.0</a> unless stating additionally.</span></div></div><div class="tag_share"><div class="post-meta__tag-list"></div><div class="post_share"><div class="social-share" data-image="/img/post.jpg" data-sites="facebook,twitter,wechat,weibo,qq"></div><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/social-share.js/dist/css/share.min.css"/><script src="https://cdn.jsdelivr.net/npm/social-share.js/dist/js/social-share.min.js"></script></div></div><div class="post-reward"><a class="reward-button button--primary button--animated"> <i class="fa fa-qrcode"></i> Donate<div class="reward-main"><ul class="reward-all"><li class="reward-item"><img class="lazyload post-qr-code__img" src="/img/wechat.jpg" alt="微信"/><div class="post-qr-code__desc">微信</div></li><li class="reward-item"><img class="lazyload post-qr-code__img" src="/img/alipay.jpg" alt="支付寶"/><div class="post-qr-code__desc">支付寶</div></li></ul></div></a></div><nav class="pagination_post" id="pagination"><div class="prev-post pull_left"><a href="/posts/7772.html"><img class="prev_cover lazyload" data-src="/img/post.jpg" onerror="onerror=null;src='/img/404.jpg'"><div class="pagination-info"><div class="label">Previous Post</div><div class="prev_info">08 ReplicaSet、DaemonSet</div></div></a></div><div class="next-post pull_right"><a href="/posts/936d.html"><img class="next_cover lazyload" data-src="/img/post.jpg" onerror="onerror=null;src='/img/404.jpg'"><div class="pagination-info"><div class="label">Next Post</div><div class="next_info">05 Delpoyment、service</div></div></a></div></nav></article></main><footer id="footer" data-type="color"><div id="footer-wrap"><div class="copyright">&copy;2020 By Wu Shao Dong</div><div class="framework-info"><span>Driven </span><a href="https://hexo.io" target="_blank" rel="noopener"><span>Hexo</span></a><span class="footer-separator">|</span><span>Theme </span><a href="https://github.com/jerryc127/hexo-theme-butterfly" target="_blank" rel="noopener"><span>Butterfly</span></a></div></div></footer></div><section class="rightside" id="rightside"><div id="rightside-config-hide"><i class="fa fa-book" id="readmode" title="Read Mode"></i><i class="fa fa-plus" id="font_plus" title="Increase font size"></i><i class="fa fa-minus" id="font_minus" title="Decrease font size"></i><a class="translate_chn_to_cht" id="translateLink" href="javascript:translatePage();" title="Traditional Chinese and Simplified Chinese Conversion" target="_self">繁</a><i class="darkmode fa fa-moon-o" id="darkmode" title="Dark Mode"></i></div><div id="rightside-config-show"><div id="rightside_config" title="Setting"><i class="fa fa-cog" aria-hidden="true"></i></div><i class="fa fa-list-ul close" id="mobile-toc-button" title="Table of Contents" aria-hidden="true"></i><i class="fa fa-arrow-up" id="go-up" title="Back to top" aria-hidden="true"></i></div></section><script src="https://cdn.jsdelivr.net/npm/jquery@latest/dist/jquery.min.js"></script><script src="/js/utils.js"></script><script src="/js/main.js"></script><script src="/js/tw_cn.js"></script><script src="https://cdn.jsdelivr.net/npm/@fancyapps/fancybox@latest/dist/jquery.fancybox.min.js"></script><script src="https://cdn.jsdelivr.net/npm/animejs@latest/anime.min.js"></script><script src="/js/third-party/fireworks.js"></script><script src="/js/third-party/activate-power-mode.js"></script><script>POWERMODE.colorful = true;
POWERMODE.shake = true;
document.body.addEventListener('input', POWERMODE);
</script><script async src="//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script><script src="https://cdn.jsdelivr.net/npm/instant.page@latest/instantpage.min.js" type="module"></script><script src="https://cdn.jsdelivr.net/npm/lazysizes@latest/lazysizes.min.js" async=""></script></body></html>