<!DOCTYPE html><html lang="zh-CN" data-theme="light"><head><meta charset="UTF-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width,initial-scale=1"><title>Xgp &amp; Blog - Today is still beautiful</title><meta name="description" content="Small steel gun article"><meta name="author" content="Wu Shao Dong"><meta name="copyright" content="Wu Shao Dong"><meta name="format-detection" content="telephone=no"><link rel="shortcut icon" href="/img/favicon.png"><link rel="canonical" href="https://wsdlxgp.top/page/10/"><meta http-equiv="Cache-Control" content="no-transform"><meta http-equiv="Cache-Control" content="no-siteapp"><link rel="preconnect" href="//cdn.jsdelivr.net"/><link rel="preconnect" href="//fonts.googleapis.com" crossorigin="crossorigin"/><link rel="preconnect" href="//busuanzi.ibruce.info"/><meta property="og:type" content="website"><meta property="og:title" content="Xgp &amp; Blog"><meta property="og:url" content="https://wsdlxgp.top/page/10/"><meta property="og:site_name" content="Xgp &amp; Blog"><meta property="og:description" content="Small steel gun article"><meta property="og:image" content="https://wsdlxgp.top/img/avatar.png"><meta property="article:published_time" content="2020-07-11T03:20:29.393Z"><meta property="article:modified_time" content="2020-07-11T03:20:29.393Z"><meta name="twitter:card" content="summary"><script>var activateDarkMode = function () {
  document.documentElement.setAttribute('data-theme', 'dark')
  if (document.querySelector('meta[name="theme-color"]') !== null) {
    document.querySelector('meta[name="theme-color"]').setAttribute('content', '#000')
  }
}
var activateLightMode = function () {
  document.documentElement.setAttribute('data-theme', 'light')
  if (document.querySelector('meta[name="theme-color"]') !== null) {
    document.querySelector('meta[name="theme-color"]').setAttribute('content', '#fff')
  }
}

var getCookies = function (name) {
  const value = `; ${document.cookie}`
  const parts = value.split(`; ${name}=`)
  if (parts.length === 2) return parts.pop().split(';').shift()
}

var autoChangeMode = 'false'
var t = getCookies('theme')
if (autoChangeMode === '1') {
  var isDarkMode = window.matchMedia('(prefers-color-scheme: dark)').matches
  var isLightMode = window.matchMedia('(prefers-color-scheme: light)').matches
  var isNotSpecified = window.matchMedia('(prefers-color-scheme: no-preference)').matches
  var hasNoSupport = !isDarkMode && !isLightMode && !isNotSpecified

  if (t === undefined) {
    if (isLightMode) activateLightMode()
    else if (isDarkMode) activateDarkMode()
    else if (isNotSpecified || hasNoSupport) {
      console.log('You specified no preference for a color scheme or your browser does not support it. I Schedule dark mode during night time.')
      var now = new Date()
      var hour = now.getHours()
      var isNight = hour <= 6 || hour >= 18
      isNight ? activateDarkMode() : activateLightMode()
    }
    window.matchMedia('(prefers-color-scheme: dark)').addListener(function (e) {
      if (Cookies.get('theme') === undefined) {
        e.matches ? activateDarkMode() : activateLightMode()
      }
    })
  } else if (t === 'light') activateLightMode()
  else activateDarkMode()
} else if (autoChangeMode === '2') {
  now = new Date()
  hour = now.getHours()
  isNight = hour <= 6 || hour >= 18
  if (t === undefined) isNight ? activateDarkMode() : activateLightMode()
  else if (t === 'light') activateLightMode()
  else activateDarkMode()
} else {
  if (t === 'dark') activateDarkMode()
  else if (t === 'light') activateLightMode()
}</script><link rel="stylesheet" href="/css/index.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free/css/all.min.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fancyapps/fancybox@latest/dist/jquery.fancybox.min.css"><link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Titillium+Web&amp;display=swap"><script>var GLOBAL_CONFIG = { 
  root: '/',
  algolia: undefined,
  localSearch: undefined,
  translate: {"defaultEncoding":2,"translateDelay":0,"msgToTraditionalChinese":"繁","msgToSimplifiedChinese":"簡"},
  copy: {
    success: '复制成功',
    error: '复制错误',
    noSupport: '浏览器不支持'
  },
  bookmark: {
    message_prev: '按',
    message_next: '键将本页加入书签'
  },
  runtime_unit: '天',
  runtime: false,
  copyright: undefined,
  ClickShowText: undefined,
  medium_zoom: false,
  fancybox: true,
  Snackbar: undefined,
  justifiedGallery: {
    js: 'https://cdn.jsdelivr.net/npm/justifiedGallery/dist/js/jquery.justifiedGallery.min.js',
    css: 'https://cdn.jsdelivr.net/npm/justifiedGallery/dist/css/justifiedGallery.min.css'
  },
  baiduPush: false,
  highlightCopy: true,
  highlightLang: true,
  isPhotoFigcaption: false,
  islazyload: true,
  isanchor: false    
}</script><script>var GLOBAL_CONFIG_SITE = { 
  isPost: false,
  isHome: true,
  isHighlightShrink: false,
  isSidebar: false
  }</script><noscript><style>
#nav {
  opacity: 1
}
.justified-gallery img{
  opacity: 1
}
</style></noscript><meta name="generator" content="Hexo 4.2.0"><link rel="alternate" href="/atom.xml" title="Xgp & Blog" type="application/atom+xml">
<link rel="stylesheet" href="/css/prism.css" type="text/css"></head><body><div id="mobile-sidebar"><div id="menu_mask"></div><div id="mobile-sidebar-menus"><div class="mobile_author_icon"><img class="avatar-img" src="/img/avatar.png" onerror="onerror=null;src='/img/friend_404.gif'" alt="avatar"/></div><div class="mobile_post_data"><div class="mobile_data_item is-center"><div class="mobile_data_link"><a href="/archives/"><div class="headline">文章</div><div class="length_num">132</div></a></div></div><div class="mobile_data_item is-center">      <div class="mobile_data_link"><a href="/tags/"><div class="headline">标签</div><div class="length_num">76</div></a></div></div><div class="mobile_data_item is-center">     <div class="mobile_data_link"><a href="/categories/"><div class="headline">分类</div><div class="length_num">4</div></a></div></div></div><hr/><div class="menus_items"><div class="menus_item"><a class="site-page" href="/"><i class="fa-fw fas fa-home"></i><span> Home</span></a></div><div class="menus_item"><a class="site-page" href="/archives/"><i class="fa-fw fas fa-archive"></i><span> Archives</span></a></div><div class="menus_item"><a class="site-page" href="/tags/"><i class="fa-fw fas fa-tags"></i><span> Tags</span></a></div><div class="menus_item"><a class="site-page" href="/categories/"><i class="fa-fw fas fa-folder-open"></i><span> Categories</span></a></div><div class="menus_item"><a class="site-page"><i class="fa-fw fas fa-list"></i><span> List</span><i class="fas fa-chevron-down menus-expand"></i></a><ul class="menus_item_child"><li><a class="site-page" href="/music/"><i class="fa-fw fas fa-music"></i><span> Music</span></a></li><li><a class="site-page" href="/movies/"><i class="fa-fw fas fa-video"></i><span> Movie</span></a></li></ul></div><div class="menus_item"><a class="site-page" href="/link/"><i class="fa-fw fas fa-link"></i><span> Link</span></a></div><div class="menus_item"><a class="site-page" href="/about/"><i class="fa-fw fas fa-heart"></i><span> About</span></a></div></div></div></div><div id="body-wrap"><header class="full_page" id="page-header" style="background-image: url(https://i.loli.net/2020/05/01/IuWi8QbHvzjlOPw.jpg)"><nav id="nav"><span class="pull-left" id="blog_name"><a class="blog_title" id="site-name" href="/">Xgp &amp; Blog</a></span><span class="pull-right menus"><div class="menus_items"><div class="menus_item"><a class="site-page" href="/"><i class="fa-fw fas fa-home"></i><span> Home</span></a></div><div class="menus_item"><a class="site-page" href="/archives/"><i class="fa-fw fas fa-archive"></i><span> Archives</span></a></div><div class="menus_item"><a class="site-page" href="/tags/"><i class="fa-fw fas fa-tags"></i><span> Tags</span></a></div><div class="menus_item"><a class="site-page" href="/categories/"><i class="fa-fw fas fa-folder-open"></i><span> Categories</span></a></div><div class="menus_item"><a class="site-page"><i class="fa-fw fas fa-list"></i><span> List</span><i class="fas fa-chevron-down menus-expand"></i></a><ul class="menus_item_child"><li><a class="site-page" href="/music/"><i class="fa-fw fas fa-music"></i><span> Music</span></a></li><li><a class="site-page" href="/movies/"><i class="fa-fw fas fa-video"></i><span> Movie</span></a></li></ul></div><div class="menus_item"><a class="site-page" href="/link/"><i class="fa-fw fas fa-link"></i><span> Link</span></a></div><div class="menus_item"><a class="site-page" href="/about/"><i class="fa-fw fas fa-heart"></i><span> About</span></a></div></div><span class="toggle-menu close"><a class="site-page"><i class="fas fa-bars fa-fw"></i></a></span></span></nav><div id="site-info"><h1 id="site_title">Xgp &amp; Blog</h1><div id="site_subtitle"><span id="subtitle"></span></div><div id="site_social_icons"><a class="social-icon" href="https://github.com/xxxxx" target="_blank" title="Github"><i class="fab fa-github"></i></a><a class="social-icon" href="mailto:xxxxxx@gmail.com" target="_blank" title="Email"><i class="fas fa-envelope"></i></a></div></div><div id="scroll_down"><i class="fas fa-angle-down scroll-down-effects"></i></div></header><main class="layout_page" id="content-inner"><div class="recent-posts" id="recent-posts"><div class="recent-post-item"><div class="post_cover left_radius"><a href="/posts/5bc1.html" title="k8s中helm安装部署，升级和回滚（chart，helm，tiller，StorageClass）">     <img class="post_bg" data-src="https://gitee.com/xgpqq/tuchuang/raw/master/img/qweq42p.jpg" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="k8s中helm安装部署，升级和回滚（chart，helm，tiller，StorageClass）"></a></div><div class="recent-post-info"><a class="article-title" href="/posts/5bc1.html" title="k8s中helm安装部署，升级和回滚（chart，helm，tiller，StorageClass）">k8s中helm安装部署，升级和回滚（chart，helm，tiller，StorageClass）</a><div class="article-meta-wrap"><time class="post-meta__date" title="发表于 2019-09-11 00:00:00"><i class="far fa-calendar-alt"></i>2019-09-11</time><span class="article-meta"><span class="article-meta__separator">|</span><i class="fas fa-inbox article-meta__icon"></i><a class="article-meta__categories" href="/categories/Kubernetes/">Kubernetes</a></span></div><div class="content">一、Helm介绍
helm是基于kubernetes 的包管理器。它之于 kubernetes 就如 yum 之于 centos，pip 之于 python，npm 之于 javascript
那 helm 的引入对于管理集群有哪些帮助呢？

更方便地部署基础设施，如 gitlab，postgres，prometheus，grafana 等
更方便地部署自己的应用，为公司内部的项目配置 Chart，使用 helm 结合 CI，在 k8s 中部署应用一行命令般简单

1、Helm用途
Helm把Kubernetes资源(比如deployments、services或 ingress等) 打包到一个chart中，而chart被保存到chart仓库。通过chart仓库可用来存储和分享chart。Helm使发布可配置，支持发布应用配置的版本管理，简化了Kubernetes部署应用的版本控制、打包、发布、删除、更新等操作。
做为Kubernetes的一个包管理工具，用来管理charts——预先配置好的安装包资源，有点类似于Ubuntu的APT和CentOS中的yum。
Helm具有如下功能：

 ...</div></div></div><div class="recent-post-item"><div class="post_cover right_radius"><a href="/posts/5f70.html" title="k8s的HPA自动扩容与缩容">     <img class="post_bg" data-src="https://gitee.com/xgpqq/tuchuang/raw/master/img/qweq41p.jpg" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="k8s的HPA自动扩容与缩容"></a></div><div class="recent-post-info"><a class="article-title" href="/posts/5f70.html" title="k8s的HPA自动扩容与缩容">k8s的HPA自动扩容与缩容</a><div class="article-meta-wrap"><time class="post-meta__date" title="发表于 2019-09-10 00:00:00"><i class="far fa-calendar-alt"></i>2019-09-10</time><span class="article-meta"><span class="article-meta__separator">|</span><i class="fas fa-inbox article-meta__icon"></i><a class="article-meta__categories" href="/categories/Kubernetes/">Kubernetes</a></span></div><div class="content">HPA介绍
Kubernetes HPA（水平Pod自动缩放）Pod水平自动伸缩，通过此功能，只需简单的配置，即可便可以利用监控指标（cpu使用率、磁盘、内存等）自动的扩容或缩容服务中Pod数量，当业务需求增加时，系统将为您无缝地自动增加适量容器，提高系统稳定性。此处将详细讲解HPA的核心设计原理和基于Hepaster的使用方法。
前提条件
系统应该能否获取到当前Pod的资源使用情况 (意思是可以执行kubectl top pod命令,并且能够得到反馈信息)。
若要实现自动扩缩容的功能，还需要部署heapster服务，用来收集及统计资源的利用率，支持kubectl top命令，heapster服务集成在prometheus（普罗米修斯） MertricServer服务中，所以说，为了方便，我这里基于prometheus服务的环境上进行部署HPA（动态扩缩容）的服务。
实验环境



主机
IP地址
服务




master
192.168.1.21
k8s


node01
192.168.1.22
k8s


node02
192.168.1.23
k8s



基于https:/ ...</div></div></div><div class="recent-post-item"><div class="post_cover left_radius"><a href="/posts/4f99.html" title="k8s群集的三种的Web-UI界面部署（dashboard、weave-scope、Prometheus）">     <img class="post_bg" data-src="https://gitee.com/xgpqq/tuchuang/raw/master/img/qweq40p.jpg" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="k8s群集的三种的Web-UI界面部署（dashboard、weave-scope、Prometheus）"></a></div><div class="recent-post-info"><a class="article-title" href="/posts/4f99.html" title="k8s群集的三种的Web-UI界面部署（dashboard、weave-scope、Prometheus）">k8s群集的三种的Web-UI界面部署（dashboard、weave-scope、Prometheus）</a><div class="article-meta-wrap"><time class="post-meta__date" title="发表于 2019-09-09 00:00:00"><i class="far fa-calendar-alt"></i>2019-09-09</time><span class="article-meta"><span class="article-meta__separator">|</span><i class="fas fa-inbox article-meta__icon"></i><a class="article-meta__categories" href="/categories/Kubernetes/">Kubernetes</a></span></div><div class="content">一、k8s的UI访问界面-dashboard
在dashboard中，虽然可以做到创建、删除、修改资源等操作，但通常情况下，我们会把它当做健康k8s集群的软件。
作为Kubernetes的Web用户界面，用户可以通过Dashboard在Kubernetes集群中部署容器化的应用，对应用进行问题处理和管理，并对集群本身进行管理。通过Dashboard，用户可以查看集群中应用的运行情况，同时也能够基于Dashboard创建或修改部署、任务、服务等Kubernetes的资源。通过部署向导，用户能够对部署进行扩缩容，进行滚动更新、重启Pod和部署新应用。当然，通过Dashboard也能够查看Kubernetes资源的状态。
1、Dashboard提供的功能
在默认情况下，Dashboard显示默认(default)命名空间下的对象，也可以通过命名空间选择器选择其他的命名空间。在Dashboard用户界面中能够显示集群大部分的对象类型。
1）集群管理
集群管理视图用于对节点、命名空间、持久化存储卷、角色和存储类进行管理。 节点视图显示CPU和内存的使用情况，以及此节点的创建时间和运行状态。 命名 ...</div></div></div><div class="recent-post-item"><div class="post_cover right_radius"><a href="/posts/7f86.html" title="k8s中ingress资源的应用">     <img class="post_bg" data-src="https://gitee.com/xgpqq/tuchuang/raw/master/img/qweq39p.jpg" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="k8s中ingress资源的应用"></a></div><div class="recent-post-info"><a class="article-title" href="/posts/7f86.html" title="k8s中ingress资源的应用">k8s中ingress资源的应用</a><div class="article-meta-wrap"><time class="post-meta__date" title="发表于 2019-09-08 00:00:00"><i class="far fa-calendar-alt"></i>2019-09-08</time><span class="article-meta"><span class="article-meta__separator">|</span><i class="fas fa-inbox article-meta__icon"></i><a class="article-meta__categories" href="/categories/Kubernetes/">Kubernetes</a></span></div><div class="content">Ingress实现虚拟主机的方案
环境介绍



主机
IP地址
服务




master
192.168.1.21
k8s


node01
192.168.1.22
k8s


node02
192.168.1.23
k8s



基于 https://blog.51cto.com/14320361/2464655 的实验继续进行
1、首先确定要运行ingress-nginx-controller服务。
在gitbub上找到所需的ingress的yaml文件




4. master下载
1[root@master ingress]# wget https://raw.githubusercontent.com/kubernetes/ingress-nginx/nginx-0.29.0/deploy/static/mandatory.yaml
5. 修改 mandatory.yaml 文件
12[root@master ingress]# vim mandatory.yaml      hostNetwork: true   #213

（1）执行一下
1[root@maste ...</div></div></div><div class="recent-post-item"><div class="post_cover left_radius"><a href="/posts/c92f.html" title="K8S的inress-nginx">     <img class="post_bg" data-src="https://gitee.com/xgpqq/tuchuang/raw/master/img/qweq38p.jpg" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="K8S的inress-nginx"></a></div><div class="recent-post-info"><a class="article-title" href="/posts/c92f.html" title="K8S的inress-nginx">K8S的inress-nginx</a><div class="article-meta-wrap"><time class="post-meta__date" title="发表于 2019-09-07 00:00:00"><i class="far fa-calendar-alt"></i>2019-09-07</time><span class="article-meta"><span class="article-meta__separator">|</span><i class="fas fa-inbox article-meta__icon"></i><a class="article-meta__categories" href="/categories/Kubernetes/">Kubernetes</a></span></div><div class="content">一、Ingress 及 Ingress Controller 简介
Ingress简单的理解: 原先暴露的service,现在给定个统一的访问入口。
Ingress 是 k8s 资源对象，用于对外暴露服务，该资源对象定义了不同主机名（域名）及 URL 和对应后端 Service（k8s Service）的绑定，根据不同的路径路由 http 和 https 流量。而 Ingress Contoller 是一个 pod 服务，封装了一个 web 前端负载均衡器，同时在其基础上实现了动态感知 Ingress 并根据 Ingress 的定义动态生成 前端 web 负载均衡器的配置文件，比如 Nginx Ingress Controller 本质上就是一个 Nginx，只不过它能根据 Ingress 资源的定义动态生成 Nginx 的配置文件，然后动态 Reload。个人觉得 Ingress Controller 的重大作用是将前端负载均衡器和 Kubernetes 完美地结合了起来，一方面在云、容器平台下方便配置的管理，另一方面实现了集群统一的流量入口，而不是像 nodePort 那样给集群打 ...</div></div></div><div class="recent-post-item"><div class="post_cover right_radius"><a href="/posts/a387.html" title="k8s的Secret（密文）和configmap（明文）的使用教程">     <img class="post_bg" data-src="https://gitee.com/xgpqq/tuchuang/raw/master/img/qweq37p.jpg" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="k8s的Secret（密文）和configmap（明文）的使用教程"></a></div><div class="recent-post-info"><a class="article-title" href="/posts/a387.html" title="k8s的Secret（密文）和configmap（明文）的使用教程">k8s的Secret（密文）和configmap（明文）的使用教程</a><div class="article-meta-wrap"><time class="post-meta__date" title="发表于 2019-09-06 00:00:00"><i class="far fa-calendar-alt"></i>2019-09-06</time><span class="article-meta"><span class="article-meta__separator">|</span><i class="fas fa-inbox article-meta__icon"></i><a class="article-meta__categories" href="/categories/Kubernetes/">Kubernetes</a></span></div><div class="content">一、Secret
Secret :用来保存一些敏感信息，比如数据库的用户名密码或者秘钥。
概览
Secret是用来保存小片敏感数据的k8s资源，例如密码，token，或者秘钥。这类数据当然也可以存放在Pod或者镜像中，但是放在Secret中是为了更方便的控制如何使用数据，并减少暴露的风险。
用户可以创建自己的secret，系统也会有自己的secret。
Pod需要先引用才能使用某个secret，Pod有2种方式来使用secret：作为volume的一个域被一个或多个容器挂载；在拉取镜像的时候被kubelet引用。
內建的Secrets
由ServiceAccount创建的API证书附加的秘钥
k8s自动生成的用来访问apiserver的Secret，所有Pod会默认使用这个Secret与apiserver通信
1. Secret类型
Secret有三种类型：

Opaque：使用base64编码存储信息，可以通过base64 --decode解码获得原始数据，因此安全性弱。
kubernetes.io/dockerconfigjson：用于存储docker registry的认证信息。 ...</div></div></div><div class="recent-post-item"><div class="post_cover left_radius"><a href="/posts/af4b.html" title="k8s的StatefulSet（有状态服务）实现">     <img class="post_bg" data-src="https://gitee.com/xgpqq/tuchuang/raw/master/img/qweq36p.jpg" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="k8s的StatefulSet（有状态服务）实现"></a></div><div class="recent-post-info"><a class="article-title" href="/posts/af4b.html" title="k8s的StatefulSet（有状态服务）实现">k8s的StatefulSet（有状态服务）实现</a><div class="article-meta-wrap"><time class="post-meta__date" title="发表于 2019-09-05 00:00:00"><i class="far fa-calendar-alt"></i>2019-09-05</time><span class="article-meta"><span class="article-meta__separator">|</span><i class="fas fa-inbox article-meta__icon"></i><a class="article-meta__categories" href="/categories/Kubernetes/">Kubernetes</a></span></div><div class="content">StatefulSet介绍
遇到的问题：
使用Deployment创建的Pod是无状态的，当挂在Volume之后，如果该Pod挂了，Replication Controller会再run一个来保证可用性，但是由于是无状态的，Pod挂了的时候与之前的Volume的关系就已经断开了，新起来的Pod无法找到之前的Pod。但是对于用户而言，他们对底层的Pod挂了没有感知，但是当Pod挂了之后就无法再使用之前挂载的磁盘了。
StatefulSet: 是一种给Pod提供唯一标志的控制器，它可以保证部署和扩展的顺序。

Pod一致性：包含次序（启动、停止次序）、网络一致性。此一致性与Pod相关，与被调度到哪个node节点无关。
稳定的次序：对于N个副本的StatefulSet，每个Pod都在[0，N)的范围内分配一个数字序号，且是唯一的。
稳定的网络：Pod的hostname模式为(statefulset名称)- (序号)。
稳定的存储：通过VolumeClaimTemplate为每个Pod创建一个PV。删除、减少副本，不会删除相关的卷。

(1) RC、 RS、Deployment、DS。---- ...</div></div></div><div class="recent-post-item"><div class="post_cover right_radius"><a href="/posts/15ab.html" title="k8s的存储类">     <img class="post_bg" data-src="https://gitee.com/xgpqq/tuchuang/raw/master/img/qweq35p.jpg" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="k8s的存储类"></a></div><div class="recent-post-info"><a class="article-title" href="/posts/15ab.html" title="k8s的存储类">k8s的存储类</a><div class="article-meta-wrap"><time class="post-meta__date" title="发表于 2019-09-04 00:00:00"><i class="far fa-calendar-alt"></i>2019-09-04</time><span class="article-meta"><span class="article-meta__separator">|</span><i class="fas fa-inbox article-meta__icon"></i><a class="article-meta__categories" href="/categories/Kubernetes/">Kubernetes</a></span></div><div class="content">k8s有很多的服务，很多的资源对象。
如果要去创建服务，做数据持久化，需要预先知道可用PV有哪些?
如果为了这个服务去提前创建PV，那么我们还需要知道，这个服务，大概需要多大的空间?
环境介绍



主机
IP地址
服务




master
192.168.1.21
k8s


node01
192.168.1.22
k8s


node02
192.168.1.23
k8s



基于 https://blog.51cto.com/14320361/2464655 的实验继续进行
存储类介绍
Kubernetes集群管理员通过提供不同的存储类，可以满足用户不同的服务质量级别、备份策略和任意策略要求的存储需求。动态存储卷供应使用StorageClass进行实现，其允许存储卷按需被创建。如果没有动态存储供应，Kubernetes集群的管理员将不得不通过手工的方式类创建新的存储卷。通过动态存储卷，Kubernetes将能够按照用户的需要，自动创建其需要的存储。
基于StorageClass的动态存储供应整体过程如下图所示：


1）集群管理员预先创建存储类（StorageClass）；
 ...</div></div></div><div class="recent-post-item"><div class="post_cover left_radius"><a href="/posts/ba49.html" title="k8s存储方式的介绍及应用 （持久化，mysql对数据持久化的应用）">     <img class="post_bg" data-src="https://gitee.com/xgpqq/tuchuang/raw/master/img/qweq34p.jpg" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="k8s存储方式的介绍及应用 （持久化，mysql对数据持久化的应用）"></a></div><div class="recent-post-info"><a class="article-title" href="/posts/ba49.html" title="k8s存储方式的介绍及应用 （持久化，mysql对数据持久化的应用）">k8s存储方式的介绍及应用 （持久化，mysql对数据持久化的应用）</a><div class="article-meta-wrap"><time class="post-meta__date" title="发表于 2019-09-03 00:00:00"><i class="far fa-calendar-alt"></i>2019-09-03</time><span class="article-meta"><span class="article-meta__separator">|</span><i class="fas fa-inbox article-meta__icon"></i><a class="article-meta__categories" href="/categories/Kubernetes/">Kubernetes</a></span></div><div class="content">k8s存储: (持久化)
docker容器是有生命周期的。
volume
1，存储类（Storage class）是k8s资源类型的一种，它是有管理员为管理PV更加方便创建的一个逻辑组，可以按照存储系统的性能高低，或者综合服务质量，备份策略等分类。不过k8s本身不知道类别到底是什么，它这是作为一个描述。
2，存储类的好处之一就是支持PV的动态创建，当用户用到持久性存储时，不必再去提前创建PV，而是直接创建PVC就可以了，非常的方便。
3，存储类对象的名称很重要，并且出了名称之外，还有3个关键字段
Provisioner（供给方）:
及提供了存储资源的存储系统。k8s内建有多重供给方，这些供给方的名字都以“kubernetes.io”为前缀。并且还可以自定义。
Parameters(参数)：存储类使用参数描述要关联到的存储卷，注意不同的供给方参数也不同。
reclaimPolicy:PV的回收策略，可用值有Delete(默认)和Retain
简介
1, 由于容器本身是非持久化的，因此需要解决在容器中运行应用程序遇到的一些问题。首先，当容器崩溃时，kubelet将重新启动容器，但是写入容器 ...</div></div></div><div class="recent-post-item"><div class="post_cover right_radius"><a href="/posts/fehv.html" title="k8s复习">     <img class="post_bg" data-src="https://gitee.com/xgpqq/tuchuang/raw/master/img/qweq33p.jpg" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="k8s复习"></a></div><div class="recent-post-info"><a class="article-title" href="/posts/fehv.html" title="k8s复习">k8s复习</a><div class="article-meta-wrap"><time class="post-meta__date" title="发表于 2019-09-02 00:00:00"><i class="far fa-calendar-alt"></i>2019-09-02</time><span class="article-meta"><span class="article-meta__separator">|</span><i class="fas fa-inbox article-meta__icon"></i><a class="article-meta__categories" href="/categories/Kubernetes/">Kubernetes</a></span></div><div class="content">虚拟化
云计算的分类:

基础及服务: laas
平台及服务: paas
软件及服务: saas

**docker虚拟化的底层原理: ** Namespace + Cgroup
**Namespace六项隔离: **

IPC:  共享内存,消息列队
MNT:  挂载点 文件系统
NET:  网络栈
PID:  进程编号
USER:  用户 组
UTS:  主机名 域名
namespace 六项隔离 实现了容器与宿主机 容器与容器之间的隔离

**Cgroup 四项作用: **

**1） 资源的限制: **cgroup可以对进程组使用的资源总额进行限制
**2） 优先级分配: **通过分配的cpu时间片数量以及硬盘IO带宽的大小，实际上相当于控制了进程运行的优先级别
**3） 资源统计: ** group可以统计系统资源使用量，比如gpu使用时间，内存使用量等，用于按量计费。同时还支持挂起动能，也就是说通过cgroup把所有 资源限制起来,对资源都不能使用，注意着并不是说我们的程序不能使用了,知识不能使用资源，处于等待状态。
**4） 进程控制: **可以对进程组执行挂起、恢复等操 ...</div></div></div><nav id="pagination"><div class="pagination"><a class="extend prev" rel="prev" href="/page/9/"><i class="fas fa-chevron-left fa-fw"></i></a><a class="page-number" href="/">1</a><span class="space">&hellip;</span><a class="page-number" href="/page/9/">9</a><span class="page-number current">10</span><a class="page-number" href="/page/11/">11</a><span class="space">&hellip;</span><a class="page-number" href="/page/14/">14</a><a class="extend next" rel="next" href="/page/11/"><i class="fas fa-chevron-right fa-fw"></i></a></div></nav></div><div class="aside_content" id="aside_content"><div class="card-widget card-info"><div class="card-content"><div class="card-info-avatar is-center"><img class="avatar-img" src="/img/avatar.png" onerror="this.onerror=null;this.src='/img/friend_404.gif'" alt="avatar"/><div class="author-info__name">Wu Shao Dong</div><div class="author-info__description">Small steel gun article</div></div><div class="card-info-data"><div class="card-info-data-item is-center"><a href="/archives"><div class="headline">文章</div><div class="length_num">132</div></a></div><div class="card-info-data-item is-center">      <a href="/tags"><div class="headline">标签</div><div class="length_num">76</div></a></div><div class="card-info-data-item is-center">     <a href="/categories"><div class="headline">分类</div><div class="length_num">4</div></a></div></div><div class="card-info-bookmark is-center"><button class="button--animated" id="bookmark-it" title="加入书签"><i class="fas fa-bookmark"></i><span>加入书签</span></button></div><div class="card-info-social-icons is-center"><a class="social-icon" href="https://github.com/xxxxx" target="_blank" title="Github"><i class="fab fa-github"></i></a><a class="social-icon" href="mailto:xxxxxx@gmail.com" target="_blank" title="Email"><i class="fas fa-envelope"></i></a></div></div></div><div class="card-widget card-announcement"><div class="card-content"><div class="item-headline"><i class="fas fa-bullhorn card-announcement-animation"></i><span>公告</span></div><div class="announcement_content">This is my Blog</div></div></div><div class="card-widget card-recent-post"><div class="card-content"><div class="item-headline"><i class="fas fa-history"></i><span>最新文章</span></div><div class="aside-recent-item"><div class="aside-recent-post"><a href="/posts/eac4.html"><div class="aside-post-cover"><img class="aside-post-bg" data-src="https://i.loli.net/2020/05/01/gkihqEjXxJ5UZ1C.jpg" onerror="this.onerror=null;this.src='/img/404.jpg'" title="132" alt="132"/></div><div class="aside-post-title"><div class="aside-post_title" href="/posts/eac4.html" title="132">132</div><time class="aside-post_meta post-meta__date" title="发表于 2020-07-10 23:01:28">2020-07-10</time></div></a></div><div class="aside-recent-post"><a href="/posts/eb84.html"><div class="aside-post-cover"><img class="aside-post-bg" data-src="https://i.loli.net/2020/05/01/gkihqEjXxJ5UZ1C.jpg" onerror="this.onerror=null;this.src='/img/404.jpg'" title="131" alt="131"/></div><div class="aside-post-title"><div class="aside-post_title" href="/posts/eb84.html" title="131">131</div><time class="aside-post_meta post-meta__date" title="发表于 2020-07-10 23:01:28">2020-07-10</time></div></a></div><div class="aside-recent-post"><a href="/posts/fb33.html"><div class="aside-post-cover"><img class="aside-post-bg" data-src="https://i.loli.net/2020/05/01/gkihqEjXxJ5UZ1C.jpg" onerror="this.onerror=null;this.src='/img/404.jpg'" title="130 httpd" alt="130 httpd"/></div><div class="aside-post-title"><div class="aside-post_title" href="/posts/fb33.html" title="130 httpd">130 httpd</div><time class="aside-post_meta post-meta__date" title="发表于 2020-07-10 23:01:28">2020-07-10</time></div></a></div><div class="aside-recent-post"><a href="/posts/ber8.html"><div class="aside-post-cover"><img class="aside-post-bg" data-src="https://gitee.com/xgpqq/tuchuang/raw/master/img/20200707225218.png" onerror="this.onerror=null;this.src='/img/404.jpg'" title="MySQL高可用之MHA+keepalived/脚本启动虚拟ip" alt="MySQL高可用之MHA+keepalived/脚本启动虚拟ip"/></div><div class="aside-post-title"><div class="aside-post_title" href="/posts/ber8.html" title="MySQL高可用之MHA+keepalived/脚本启动虚拟ip">MySQL高可用之MHA+keepalived/脚本启动虚拟ip</div><time class="aside-post_meta post-meta__date" title="发表于 2020-07-02 00:02:00">2020-07-02</time></div></a></div><div class="aside-recent-post"><a href="/posts/ber7.html"><div class="aside-post-cover"><img class="aside-post-bg" data-src="https://gitee.com/xgpqq/tuchuang/raw/master/img/20200707225048.png" onerror="this.onerror=null;this.src='/img/404.jpg'" title="MySQL高可用之MHA(1)" alt="MySQL高可用之MHA(1)"/></div><div class="aside-post-title"><div class="aside-post_title" href="/posts/ber7.html" title="MySQL高可用之MHA(1)">MySQL高可用之MHA(1)</div><time class="aside-post_meta post-meta__date" title="发表于 2020-07-01 00:02:00">2020-07-01</time></div></a></div></div></div></div><div class="card-widget card-categories"><div class="card-content"><div class="item-headline"><i class="fas fa-folder-open"></i><span>分类</span></div><ul class="card-category-list">
            <li class="card-category-list-item "><a class="card-category-list-link" href="/categories/Kubernetes/"><span class="card-category-list-name">Kubernetes</span><span class="card-category-list-count">22</span></a></li><li class="card-category-list-item "><a class="card-category-list-link" href="/categories/docker/"><span class="card-category-list-name">docker</span><span class="card-category-list-count">23</span></a></li><li class="card-category-list-item "><a class="card-category-list-link" href="/categories/mysql/"><span class="card-category-list-name">mysql</span><span class="card-category-list-count">35</span></a></li><li class="card-category-list-item "><a class="card-category-list-link" href="/categories/python/"><span class="card-category-list-name">python</span><span class="card-category-list-count">49</span></a></li>
                       
            </ul></div></div><div class="card-widget card-tags"><div class="card-content"><div class="item-headline"><i class="fas fa-tags"></i><span>标签</span></div><div class="card-tag-cloud"><a href="/tags/prompt/" style="font-size: 16px; color: #999">--prompt</a> <a href="/tags/tee/" style="font-size: 16px; color: #999">--tee</a> <a href="/tags/CronJob/" style="font-size: 16px; color: #999">CronJob</a> <a href="/tags/Docker%E7%9B%91%E6%8E%A7/" style="font-size: 17.5px; color: #999da3">Docker监控</a> <a href="/tags/HPA/" style="font-size: 16px; color: #999">HPA</a> <a href="/tags/Job/" style="font-size: 16px; color: #999">Job</a> <a href="/tags/MySQL%E4%BC%98%E5%8C%96/" style="font-size: 19px; color: #99a1ac">MySQL优化</a> <a href="/tags/Namespace/" style="font-size: 16px; color: #999">Namespace</a> <a href="/tags/PodRestart/" style="font-size: 16px; color: #999">PodRestart</a> <a href="/tags/Policy/" style="font-size: 16px; color: #999">Policy</a> <a href="/tags/Prometheus/" style="font-size: 16px; color: #999">Prometheus</a> <a href="/tags/ReplicaSet/" style="font-size: 16px; color: #999">ReplicaSet</a> <a href="/tags/SetDaemonSet/" style="font-size: 16px; color: #999">SetDaemonSet</a> <a href="/tags/StatefulSet/" style="font-size: 16px; color: #999">StatefulSet</a> <a href="/tags/Storage-Class/" style="font-size: 19.75px; color: #99a3b1">Storage Class</a> <a href="/tags/StorageClass/" style="font-size: 20.5px; color: #99a5b6">StorageClass</a> <a href="/tags/Weave-Scope/" style="font-size: 16px; color: #999">Weave Scope</a> <a href="/tags/alertmanager/" style="font-size: 16px; color: #999">alertmanager</a> <a href="/tags/apiVersion/" style="font-size: 16px; color: #999">apiVersion</a> <a href="/tags/base/" style="font-size: 16px; color: #999">base</a> <a href="/tags/bash/" style="font-size: 16px; color: #999">bash</a> <a href="/tags/bind-mount/" style="font-size: 16px; color: #999">bind mount</a> <a href="/tags/ca/" style="font-size: 16px; color: #999">ca</a> <a href="/tags/configmap/" style="font-size: 16px; color: #999">configmap</a> <a href="/tags/consul/" style="font-size: 16px; color: #999">consul</a> <a href="/tags/dashboard/" style="font-size: 21.25px; color: #99a7ba">dashboard</a> <a href="/tags/deployment/" style="font-size: 21.25px; color: #99a7ba">deployment</a> <a href="/tags/docker/" style="font-size: 18.25px; color: #999fa7">docker</a> <a href="/tags/docker-manager-volu/" style="font-size: 16px; color: #999">docker manager volu</a> <a href="/tags/docker-compose/" style="font-size: 16.75px; color: #999b9e">docker-compose</a> <a href="/tags/docker-registry/" style="font-size: 16px; color: #999">docker-registry</a> <a href="/tags/dockerfile/" style="font-size: 16.75px; color: #999b9e">dockerfile</a> <a href="/tags/docker%E7%A7%81%E6%9C%89%E4%BB%93%E5%BA%93/" style="font-size: 16px; color: #999">docker私有仓库</a> <a href="/tags/docker%E7%BD%91%E7%BB%9C/" style="font-size: 17.5px; color: #999da3">docker网络</a> <a href="/tags/emptyDir/" style="font-size: 16px; color: #999">emptyDir</a> <a href="/tags/gitlab/" style="font-size: 16px; color: #999">gitlab</a> <a href="/tags/grafana/" style="font-size: 16px; color: #999">grafana</a> <a href="/tags/harbor/" style="font-size: 16px; color: #999">harbor</a> <a href="/tags/heapster/" style="font-size: 16px; color: #999">heapster</a> <a href="/tags/helm/" style="font-size: 22px; color: #99a9bf">helm</a></div></div></div><div class="card-widget card-archives"><div class="card-content"><div class="item-headline"><i class="fas fa-archive"></i><span>归档</span></div><ul class="card-archive-list"><li class="card-archive-list-item"><a class="card-archive-list-link" href="/archives/2020/07/"><span class="card-archive-list-date">七月 2020</span><span class="card-archive-list-count">5</span></a></li><li class="card-archive-list-item"><a class="card-archive-list-link" href="/archives/2020/06/"><span class="card-archive-list-date">六月 2020</span><span class="card-archive-list-count">33</span></a></li><li class="card-archive-list-item"><a class="card-archive-list-link" href="/archives/2019/11/"><span class="card-archive-list-date">十一月 2019</span><span class="card-archive-list-count">3</span></a></li><li class="card-archive-list-item"><a class="card-archive-list-link" href="/archives/2019/10/"><span class="card-archive-list-date">十月 2019</span><span class="card-archive-list-count">15</span></a></li><li class="card-archive-list-item"><a class="card-archive-list-link" href="/archives/2019/09/"><span class="card-archive-list-date">九月 2019</span><span class="card-archive-list-count">45</span></a></li><li class="card-archive-list-item"><a class="card-archive-list-link" href="/archives/2019/08/"><span class="card-archive-list-date">八月 2019</span><span class="card-archive-list-count">31</span></a></li></ul></div></div><div class="card-widget card-webinfo"><div class="card-content"><div class="item-headline"><i class="fas fa-chart-line"></i><span>网站资讯</span></div><div class="webinfo"><div class="webinfo-item"><div class="webinfo-article-name">文章数目 :</div><div class="webinfo-article-count">132</div></div><div class="webinfo-item">      <div class="webinfo-site-uv-name">本站访客数 :</div><div class="webinfo-site-uv-count" id="busuanzi_value_site_uv"></div></div><div class="webinfo-item"><div class="webinfo-site-name">本站总访问量 :</div><div class="webinfo-site-pv-count" id="busuanzi_value_site_pv"></div></div></div></div></div></div></main><footer id="footer" data-type="color"><div id="footer-wrap"><div class="copyright">&copy;2020 By Wu Shao Dong</div><div class="framework-info"><span>驱动 </span><a href="https://hexo.io" target="_blank" rel="noopener"><span>Hexo</span></a><span class="footer-separator">|</span><span>主题 </span><a href="https://github.com/jerryc127/hexo-theme-butterfly" target="_blank" rel="noopener"><span>Butterfly</span></a></div></div></footer></div><section class="rightside" id="rightside"><div id="rightside-config-hide"><button class="translate_chn_to_cht" id="translateLink" title="简繁转换">繁</button><button id="darkmode" title="浅色和深色模式转换"><i class="fas fa-adjust"></i></button></div><div id="rightside-config-show"><button id="rightside_config" title="设置"><i class="fas fa-cog"></i></button><button id="go-up" title="回到顶部"><i class="fas fa-arrow-up"></i></button></div></section><script src="https://cdn.jsdelivr.net/npm/jquery@latest/dist/jquery.min.js"></script><script src="/js/utils.js"></script><script src="/js/main.js"></script><script src="/js/tw_cn.js"></script><script src="https://cdn.jsdelivr.net/npm/@fancyapps/fancybox@latest/dist/jquery.fancybox.min.js"></script><script async src="//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script><script src="https://cdn.jsdelivr.net/npm/instant.page/instantpage.min.js" type="module" defer></script><script src="https://cdn.jsdelivr.net/npm/vanilla-lazyload/dist/lazyload.iife.min.js" async></script><script src="https://cdn.jsdelivr.net/npm/typed.js"></script><script>var subtitleEffect = true
if (subtitleEffect) { 
  var typed = new Typed("#subtitle", {
    strings: "今日事&#44;今日畢,Never put off till tomorrow what you can do today".split(","),
    startDelay: 300,
    typeSpeed: 150,
    loop: true,
    backSpeed: 50
  })
} else {
  document.getElementById("subtitle").innerHTML = '今日事&#44;今日畢'
}</script><script src="/live2dw/lib/L2Dwidget.min.js?094cbace49a39548bed64abff5988b05"></script><script>L2Dwidget.init({"log":false,"pluginJsPath":"lib/","pluginModelPath":"assets/","pluginRootPath":"live2dw/","tagMode":false});</script></body></html>