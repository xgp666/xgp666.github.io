<!DOCTYPE html>
<html lang="zh-Hans">

<!-- Head tag -->
<head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1">

    <!--Description-->
    
        <meta name="description" content="Small steel gun article">
    

    <!--Author-->
    
        <meta name="author" content="Wu Shao Dong">
    

    <!-- Title -->
    
    <title>a | Xgp &amp; Blog</title>

    <!-- Bootstrap Core CSS -->
    <link href="//cdn.bootcss.com/bootstrap/3.3.6/css/bootstrap.min.css" rel="stylesheet">

    <!-- Custom CSS -->
    
<link rel="stylesheet" href="/css/style.css">


    <!-- Custom Fonts -->
    <link href="//cdn.bootcss.com/font-awesome/4.5.0/css/font-awesome.min.css" rel="stylesheet" type="text/css">
    <link href='//fonts.googleapis.com/css?family=Open+Sans:300italic,400italic,600italic,700italic,800italic,400,300,600,700,800' rel='stylesheet' type='text/css'>
    <link href='//fonts.googleapis.com/css?family=Noto+Serif:300italic,400italic,600italic,700italic,800italic,400,300,600,700,800' rel='stylesheet' type='text/css'>

    <!-- jQuery -->
    <script src="//cdn.bootcss.com/jquery/2.2.1/jquery.min.js"></script>
    <!-- Bootstrap -->
    <script src="//cdn.bootcss.com/bootstrap/3.3.6/js/bootstrap.min.js"></script>

    <!-- HTML5 Shim and Respond.js IE8 support of HTML5 elements and media queries -->
    <!-- WARNING: Respond.js doesn't work if you view the page via file:// -->
    <!--[if lt IE 9]>
    <script src="https://oss.maxcdn.com/libs/html5shiv/3.7.0/html5shiv.js"></script>
    <script src="https://oss.maxcdn.com/libs/respond.js/1.4.2/respond.min.js"></script>
    <![endif]-->
<meta name="generator" content="Hexo 4.2.0"><link rel="alternate" href="/atom.xml" title="Xgp & Blog" type="application/atom+xml">
</head>

<body>

    <!-- Content -->
    <section class="article-container">
    <!-- Back Home -->
    <a class="nav-back" href="/">
    <i class="fa fa-puzzle-piece"></i>
</a>

        <!-- Page Header -->
        <header class="intro-header">
            <div class="container">
                <div class="row">
                    <div class="col-lg-8 col-lg-offset-2 col-md-10 col-md-offset-1">
                        <div class="post-heading">
                            <h1>
                                a
                            </h1>
                        </div>
                    </div>
                </div>
            </div>
        </header>

        <!-- Post Content -->
        <article>
            <div class="container">
                <div class="row">
                    <!-- Post Main Content -->
                    <div class="post-content col-lg-8 col-lg-offset-2 col-md-10 col-md-offset-1">
                        <h1 id="chartsçš„å››ç§å®‰è£…æ–¹å¼"><a href="#chartsçš„å››ç§å®‰è£…æ–¹å¼" class="headerlink" title="chartsçš„å››ç§å®‰è£…æ–¹å¼"></a>chartsçš„å››ç§å®‰è£…æ–¹å¼</h1><p><a href="https://hub.helm.sh/" target="_blank" rel="noopener">https://hub.helm.sh/</a></p>
<h2 id="1ã€å¼€å‘è‡ªå·±çš„chareåŒ…"><a href="#1ã€å¼€å‘è‡ªå·±çš„chareåŒ…" class="headerlink" title="1ã€å¼€å‘è‡ªå·±çš„chareåŒ…"></a>1ã€å¼€å‘è‡ªå·±çš„chareåŒ…</h2><figure class="highlight plain"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line">[root@master ~]# helm create mychare</span><br><span class="line">//åˆ›å»ºä¸€ä¸ªåä¸ºmychareçš„chareåŒ…</span><br><span class="line">[root@master ~]# tree -C mychare/</span><br><span class="line">//ä»¥æ ‘çŠ¶å›¾æŸ¥çœ‹ä¸€ä¸‹chareåŒ…</span><br><span class="line">mychare/</span><br><span class="line">â”œâ”€â”€ charts</span><br><span class="line">â”œâ”€â”€ Chart.yaml</span><br><span class="line">â”œâ”€â”€ templates</span><br><span class="line">â”‚   â”œâ”€â”€ deployment.yaml</span><br><span class="line">â”‚   â”œâ”€â”€ _helpers.tpl</span><br><span class="line">â”‚   â”œâ”€â”€ ingress.yaml</span><br><span class="line">â”‚   â”œâ”€â”€ NOTES.txt</span><br><span class="line">â”‚   â”œâ”€â”€ service.yaml</span><br><span class="line">â”‚   â””â”€â”€ tests</span><br><span class="line">â”‚       â””â”€â”€ test-connection.yaml</span><br><span class="line">â””â”€â”€ values.yaml</span><br></pre></td></tr></tbody></table></figure>

<h2 id="2ã€è°ƒè¯•chart"><a href="#2ã€è°ƒè¯•chart" class="headerlink" title="2ã€è°ƒè¯•chart"></a>2ã€è°ƒè¯•chart</h2><figure class="highlight plain"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">[root@master mychare]# cd</span><br><span class="line">[root@master ~]# helm install --dry-run --debug mychare</span><br><span class="line">//æ£€æŸ¥è¿™ä¸ªmychareæ˜¯å¦æœ‰é—®é¢˜</span><br></pre></td></tr></tbody></table></figure>

<h2 id="3ã€å®‰è£…chart"><a href="#3ã€å®‰è£…chart" class="headerlink" title="3ã€å®‰è£…chart"></a>3ã€å®‰è£…chart</h2><figure class="highlight plain"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">[root@node02 ~]# docker pull nginx:stable</span><br></pre></td></tr></tbody></table></figure>

<h3 id="ï¼ˆ1ï¼‰é€šè¿‡ä»“åº“å®‰è£…"><a href="#ï¼ˆ1ï¼‰é€šè¿‡ä»“åº“å®‰è£…" class="headerlink" title="ï¼ˆ1ï¼‰é€šè¿‡ä»“åº“å®‰è£…"></a>ï¼ˆ1ï¼‰é€šè¿‡ä»“åº“å®‰è£…</h3><figure class="highlight plain"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">[root@master mychare]# helm search redis</span><br><span class="line">//æœç´¢chareåŒ…</span><br></pre></td></tr></tbody></table></figure>

<figure class="highlight plain"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">[root@master mychare]# helm repo list</span><br><span class="line">//æŸ¥çœ‹æ˜¯å¦æœ‰èƒ½è®¿é—®ä»“åº“</span><br></pre></td></tr></tbody></table></figure>
<p><img src="https://s1.51cto.com/images/blog/202003/04/20389715f270929a825a18f36b6f08c4.png?x-oss-process=image/watermark,size_16,text_QDUxQ1RP5Y2a5a6i,color_FFFFFF,t_100,g_se,x_10,y_10,shadow_90,type_ZmFuZ3poZW5naGVpdGk=" alt=""></p>
<figure class="highlight plain"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">[root@master mychare]# helm install stable/redis</span><br><span class="line">//å®‰è£…</span><br></pre></td></tr></tbody></table></figure>

<h3 id="ï¼ˆ2ï¼‰é€šè¿‡taråŒ…å®‰è£…"><a href="#ï¼ˆ2ï¼‰é€šè¿‡taråŒ…å®‰è£…" class="headerlink" title="ï¼ˆ2ï¼‰é€šè¿‡taråŒ…å®‰è£…"></a>ï¼ˆ2ï¼‰é€šè¿‡taråŒ…å®‰è£…</h3><figure class="highlight plain"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line">[root@master ~]# helm fetch stable/redis</span><br><span class="line">//ç›´æ¥ä¸‹è½½chareåŒ…</span><br><span class="line">[root@master ~]# tar -zxf redis-1.1.15.tgz</span><br><span class="line">//è§£å‹ä¸‹è½½çš„chareåŒ…</span><br><span class="line">[root@master ~]# tree -C redis</span><br><span class="line">redis</span><br><span class="line">â”œâ”€â”€ Chart.yaml</span><br><span class="line">â”œâ”€â”€ README.md</span><br><span class="line">â”œâ”€â”€ templates</span><br><span class="line">â”‚   â”œâ”€â”€ deployment.yaml</span><br><span class="line">â”‚   â”œâ”€â”€ _helpers.tpl</span><br><span class="line">â”‚   â”œâ”€â”€ networkpolicy.yaml</span><br><span class="line">â”‚   â”œâ”€â”€ NOTES.txt</span><br><span class="line">â”‚   â”œâ”€â”€ pvc.yaml</span><br><span class="line">â”‚   â”œâ”€â”€ secrets.yaml</span><br><span class="line">â”‚   â””â”€â”€ svc.yaml</span><br><span class="line">â””â”€â”€ values.yaml</span><br></pre></td></tr></tbody></table></figure>

<h3 id="ï¼ˆ3ï¼‰é€šè¿‡chareæœ¬åœ°ç›®å½•å®‰è£…"><a href="#ï¼ˆ3ï¼‰é€šè¿‡chareæœ¬åœ°ç›®å½•å®‰è£…" class="headerlink" title="ï¼ˆ3ï¼‰é€šè¿‡chareæœ¬åœ°ç›®å½•å®‰è£…"></a>ï¼ˆ3ï¼‰é€šè¿‡chareæœ¬åœ°ç›®å½•å®‰è£…</h3><figure class="highlight plain"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">[root@master ~]# helm fetch stable/redis</span><br><span class="line">//ç›´æ¥ä¸‹è½½chareåŒ…</span><br><span class="line">[root@master ~]# tar -zxf redis-1.1.15.tgz</span><br><span class="line">//è§£å‹ä¸‹è½½çš„chareåŒ…</span><br><span class="line">[root@master ~]# helm install redis</span><br></pre></td></tr></tbody></table></figure>

<h3 id="ï¼ˆ4ï¼‰é€šè¿‡URLå®‰è£…"><a href="#ï¼ˆ4ï¼‰é€šè¿‡URLå®‰è£…" class="headerlink" title="ï¼ˆ4ï¼‰é€šè¿‡URLå®‰è£…"></a>ï¼ˆ4ï¼‰é€šè¿‡URLå®‰è£…</h3><figure class="highlight plain"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">[root@master ~]# helm install https://example.com/charts/foo-1.2.3.tgz</span><br></pre></td></tr></tbody></table></figure>

<h1 id="åˆ›å»ºè‡ªå·±çš„Repoä»“åº“"><a href="#åˆ›å»ºè‡ªå·±çš„Repoä»“åº“" class="headerlink" title="åˆ›å»ºè‡ªå·±çš„Repoä»“åº“"></a>åˆ›å»ºè‡ªå·±çš„Repoä»“åº“</h1><h2 id="1ï¼‰åˆ›å»ºhelmçš„ç§æœ‰ä»“åº“ï¼Œä»¥è‡ªå·±çš„åå­—å‘½åã€‚"><a href="#1ï¼‰åˆ›å»ºhelmçš„ç§æœ‰ä»“åº“ï¼Œä»¥è‡ªå·±çš„åå­—å‘½åã€‚" class="headerlink" title="1ï¼‰åˆ›å»ºhelmçš„ç§æœ‰ä»“åº“ï¼Œä»¥è‡ªå·±çš„åå­—å‘½åã€‚"></a>1ï¼‰åˆ›å»ºhelmçš„ç§æœ‰ä»“åº“ï¼Œä»¥è‡ªå·±çš„åå­—å‘½åã€‚</h2><h3 id="1ã€node01å¯åŠ¨ä¸€ä¸ªhttpdçš„å®¹å™¨"><a href="#1ã€node01å¯åŠ¨ä¸€ä¸ªhttpdçš„å®¹å™¨" class="headerlink" title="1ã€node01å¯åŠ¨ä¸€ä¸ªhttpdçš„å®¹å™¨"></a>1ã€node01å¯åŠ¨ä¸€ä¸ªhttpdçš„å®¹å™¨</h3><figure class="highlight plain"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">[root@node01 ~]# mkdir /var/xgp</span><br><span class="line">//åˆ›å»ºä¸€ä¸ªç›®å½•</span><br><span class="line">[root@node01 ~]# docker pull httpd</span><br><span class="line">//ä¸‹è½½httpdé•œåƒ</span><br><span class="line">[root@node02 ~]# docker run -d -p 8080:80 -v /var/xgp:/usr/local/apache2/htdocs httpd</span><br><span class="line">//å¯åŠ¨ä¸€ä¸ªhttpdçš„å®¹å™¨</span><br></pre></td></tr></tbody></table></figure>

<h3 id="3ã€ç”Ÿæˆä»“åº“çš„indexæ–‡ä»¶ã€‚"><a href="#3ã€ç”Ÿæˆä»“åº“çš„indexæ–‡ä»¶ã€‚" class="headerlink" title="3ã€ç”Ÿæˆä»“åº“çš„indexæ–‡ä»¶ã€‚"></a>3ã€ç”Ÿæˆä»“åº“çš„indexæ–‡ä»¶ã€‚</h3><figure class="highlight plain"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">[root@master ~]# mkdir xgprepo</span><br><span class="line">//åˆ›å»ºä¸€ä¸ªç›®å½•å­˜æ”¾æ‰“åŒ…çš„chare</span><br><span class="line">[root@master ~]# helm repo index xgprepo/ --url http://192.168.1.22:8080/charts</span><br><span class="line">//ç”Ÿæˆä»“åº“çš„indexæ–‡ä»¶</span><br></pre></td></tr></tbody></table></figure>

<h3 id="4ã€å°†ç”Ÿæˆçš„index-yamlä¸Šä¼ åˆ°node01çš„-var-www-chartsç›®å½•ä¸‹"><a href="#4ã€å°†ç”Ÿæˆçš„index-yamlä¸Šä¼ åˆ°node01çš„-var-www-chartsç›®å½•ä¸‹" class="headerlink" title="4ã€å°†ç”Ÿæˆçš„index.yamlä¸Šä¼ åˆ°node01çš„/var/www/chartsç›®å½•ä¸‹."></a>4ã€å°†ç”Ÿæˆçš„index.yamlä¸Šä¼ åˆ°node01çš„/var/www/chartsç›®å½•ä¸‹.</h3><h4 id="node01åˆ›å»ºç›®å½•"><a href="#node01åˆ›å»ºç›®å½•" class="headerlink" title="node01åˆ›å»ºç›®å½•"></a>node01åˆ›å»ºç›®å½•</h4><figure class="highlight plain"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">[root@node01 ~]# mkdir /var/xgp/charts</span><br></pre></td></tr></tbody></table></figure>

<h4 id="masterç§»åŠ¨åŠ¨åˆ°"><a href="#masterç§»åŠ¨åŠ¨åˆ°" class="headerlink" title="masterç§»åŠ¨åŠ¨åˆ°"></a>masterç§»åŠ¨åŠ¨åˆ°</h4><figure class="highlight plain"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">[root@master ~]# scp xgprepo/* node01:/var/xgp/charts/</span><br></pre></td></tr></tbody></table></figure>

<h4 id="node01æŸ¥çœ‹ä¸€ä¸‹"><a href="#node01æŸ¥çœ‹ä¸€ä¸‹" class="headerlink" title="node01æŸ¥çœ‹ä¸€ä¸‹"></a>node01æŸ¥çœ‹ä¸€ä¸‹</h4><figure class="highlight plain"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">[root@node01 ~]# ls /var/xgp/charts/</span><br><span class="line">index.yaml</span><br></pre></td></tr></tbody></table></figure>

<h3 id="5ã€æ·»åŠ æ–°çš„repoä»“åº“"><a href="#5ã€æ·»åŠ æ–°çš„repoä»“åº“" class="headerlink" title="5ã€æ·»åŠ æ–°çš„repoä»“åº“"></a>5ã€æ·»åŠ æ–°çš„repoä»“åº“</h3><figure class="highlight plain"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">[root@master ~]# helm repo add xgp http://192.168.1.22:8080/charts</span><br><span class="line">[root@master ~]# helm repo list</span><br></pre></td></tr></tbody></table></figure>

<p><img src="https://s1.51cto.com/images/blog/202003/04/a2e1f46e4005d33c4ea6c5c8180b8ad9.png?x-oss-process=image/watermark,size_16,text_QDUxQ1RP5Y2a5a6i,color_FFFFFF,t_100,g_se,x_10,y_10,shadow_90,type_ZmFuZ3poZW5naGVpdGk=" alt=""></p>
<h2 id="2ï¼‰-è‡ªå®šä¹‰ä¸€ä¸ªchartåŒ…ï¼Œè¦æ±‚è¿™ä¸ªåŒ…è¿è¡Œä¸€ä¸ªhttpdçš„æœåŠ¡ï¼Œä½¿ç”¨ç§æœ‰é•œåƒv1ç‰ˆæœ¬ã€‚3ä¸ªå‰¯æœ¬Podï¼Œserviceç±»å‹æ›´æ”¹ä¸ºNodePortï¼Œç«¯å£æŒ‡å®šä¸º-30000"><a href="#2ï¼‰-è‡ªå®šä¹‰ä¸€ä¸ªchartåŒ…ï¼Œè¦æ±‚è¿™ä¸ªåŒ…è¿è¡Œä¸€ä¸ªhttpdçš„æœåŠ¡ï¼Œä½¿ç”¨ç§æœ‰é•œåƒv1ç‰ˆæœ¬ã€‚3ä¸ªå‰¯æœ¬Podï¼Œserviceç±»å‹æ›´æ”¹ä¸ºNodePortï¼Œç«¯å£æŒ‡å®šä¸º-30000" class="headerlink" title="2ï¼‰ è‡ªå®šä¹‰ä¸€ä¸ªchartåŒ…ï¼Œè¦æ±‚è¿™ä¸ªåŒ…è¿è¡Œä¸€ä¸ªhttpdçš„æœåŠ¡ï¼Œä½¿ç”¨ç§æœ‰é•œåƒv1ç‰ˆæœ¬ã€‚3ä¸ªå‰¯æœ¬Podï¼Œserviceç±»å‹æ›´æ”¹ä¸ºNodePortï¼Œç«¯å£æŒ‡å®šä¸º:30000"></a>2ï¼‰ è‡ªå®šä¹‰ä¸€ä¸ªchartåŒ…ï¼Œè¦æ±‚è¿™ä¸ªåŒ…è¿è¡Œä¸€ä¸ªhttpdçš„æœåŠ¡ï¼Œä½¿ç”¨ç§æœ‰é•œåƒv1ç‰ˆæœ¬ã€‚3ä¸ªå‰¯æœ¬Podï¼Œserviceç±»å‹æ›´æ”¹ä¸ºNodePortï¼Œç«¯å£æŒ‡å®šä¸º:30000</h2><h4 id="è‡ªå®šä¹‰ä¸€ä¸ªchartåŒ…"><a href="#è‡ªå®šä¹‰ä¸€ä¸ªchartåŒ…" class="headerlink" title="è‡ªå®šä¹‰ä¸€ä¸ªchartåŒ…"></a>è‡ªå®šä¹‰ä¸€ä¸ªchartåŒ…</h4><figure class="highlight plain"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">[root@master ~]# helm create wsd</span><br><span class="line">//åˆ›å»ºä¸€ä¸ªåä¸ºwsdçš„charesåŒ…</span><br></pre></td></tr></tbody></table></figure>

<h4 id="æŒ‰ç…§è¦æ±‚ä¿®æ”¹é…ç½®æ–‡ä»¶"><a href="#æŒ‰ç…§è¦æ±‚ä¿®æ”¹é…ç½®æ–‡ä»¶" class="headerlink" title="æŒ‰ç…§è¦æ±‚ä¿®æ”¹é…ç½®æ–‡ä»¶"></a>æŒ‰ç…§è¦æ±‚ä¿®æ”¹é…ç½®æ–‡ä»¶</h4><figure class="highlight plain"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br></pre></td><td class="code"><pre><span class="line">[root@master ~]# cd wsd/</span><br><span class="line">//è¿›å…¥è¿™ä¸ªchartåŒ…</span><br><span class="line">[root@master wsd]# vim values.yaml</span><br><span class="line">//ä¿®æ”¹wsdçš„é…ç½®æ–‡ä»¶</span><br><span class="line">replicaCount: 3                         #ä¸‰ä¸ªå‰¯æœ¬</span><br><span class="line"></span><br><span class="line">image:</span><br><span class="line">  repository: 192.168.1.21:5000/web      #æ›´æ”¹é•œåƒä¸ºç§æœ‰é•œåƒ</span><br><span class="line">  tag: v1                                #é•œåƒæ ‡ç­¾v1</span><br><span class="line">  pullPolicy: IfNotPresent              </span><br><span class="line"></span><br><span class="line">imagePullSecrets: []</span><br><span class="line">nameOverride: ""</span><br><span class="line">fullnameOverride: ""</span><br><span class="line"></span><br><span class="line">service:</span><br><span class="line">  type: NodePort              #ä¿®æ”¹æ¨¡å¼ä¸ºæ˜ å°„ç«¯å£</span><br><span class="line">  port: 80</span><br><span class="line">  nodePort: 30000             #æ·»åŠ ç«¯å£</span><br><span class="line"></span><br><span class="line">[root@master wsd]# vim templates/service.yaml </span><br><span class="line"></span><br><span class="line">apiVersion: v1</span><br><span class="line">kind: Service</span><br><span class="line">metadata:</span><br><span class="line">  name: {{ include "wsd.fullname" . }}</span><br><span class="line">  labels:</span><br><span class="line">{{ include "wsd.labels" . | indent 4 }}</span><br><span class="line">spec:</span><br><span class="line">  type: {{ .Values.service.type }}</span><br><span class="line">  ports:</span><br><span class="line">    - port: {{ .Values.service.port }}</span><br><span class="line">      targetPort: http</span><br><span class="line">      protocol: TCP</span><br><span class="line">      name: http</span><br><span class="line">      nodePort: {{ .Values.service.nodePort }}    #â€œæ·»åŠ â€èƒ½è®©æœåŠ¡è¯†åˆ«åˆ°nodePortçš„ç«¯å£</span><br><span class="line">  selector:</span><br><span class="line">    app.kubernetes.io/name: {{ include "wsd.name" . }}</span><br><span class="line">    app.kubernetes.io/instance: {{ .Release.Name }}</span><br></pre></td></tr></tbody></table></figure>

<h4 id="æµ‹è¯•ä¸€ä¸‹"><a href="#æµ‹è¯•ä¸€ä¸‹" class="headerlink" title="æµ‹è¯•ä¸€ä¸‹"></a>æµ‹è¯•ä¸€ä¸‹</h4><figure class="highlight plain"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">[root@master ~]# helm install -n wsd  wsd/ -f wsd/values.yaml</span><br></pre></td></tr></tbody></table></figure>

<p><img src="https://s1.51cto.com/images/blog/202003/04/b18f74519a95d138bdae8e525e4f98f5.png?x-oss-process=image/watermark,size_16,text_QDUxQ1RP5Y2a5a6i,color_FFFFFF,t_100,g_se,x_10,y_10,shadow_90,type_ZmFuZ3poZW5naGVpdGk=" alt=""></p>
<h4 id="æŸ¥çœ‹ä¸€ä¸‹é•œåƒç‰ˆæœ¬"><a href="#æŸ¥çœ‹ä¸€ä¸‹é•œåƒç‰ˆæœ¬" class="headerlink" title="æŸ¥çœ‹ä¸€ä¸‹é•œåƒç‰ˆæœ¬"></a>æŸ¥çœ‹ä¸€ä¸‹é•œåƒç‰ˆæœ¬</h4><figure class="highlight plain"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">[root@master ~]# kubectl get deployments. -o wide</span><br></pre></td></tr></tbody></table></figure>

<p><img src="https://s1.51cto.com/images/blog/202003/04/a57cd4abe5b96d92ac16450ed53fa79c.png?x-oss-process=image/watermark,size_16,text_QDUxQ1RP5Y2a5a6i,color_FFFFFF,t_100,g_se,x_10,y_10,shadow_90,type_ZmFuZ3poZW5naGVpdGk=" alt=""></p>
<h4 id="è®¿é—®ä¸€ä¸‹"><a href="#è®¿é—®ä¸€ä¸‹" class="headerlink" title="è®¿é—®ä¸€ä¸‹"></a>è®¿é—®ä¸€ä¸‹</h4><figure class="highlight plain"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">[root@master ~]# curl 127.0.0.1:30000</span><br></pre></td></tr></tbody></table></figure>

<p><img src="https://s1.51cto.com/images/blog/202003/04/7d9e241ceb6a8d0829803e1d0e5ddb8e.png?x-oss-process=image/watermark,size_16,text_QDUxQ1RP5Y2a5a6i,color_FFFFFF,t_100,g_se,x_10,y_10,shadow_90,type_ZmFuZ3poZW5naGVpdGk=" alt=""></p>
<h2 id="3-å°†å®ä¾‹è¿›è¡Œæ›´æ–°ï¼Œè¦æ±‚é•œåƒç”Ÿäº§v2ç‰ˆæœ¬ã€‚"><a href="#3-å°†å®ä¾‹è¿›è¡Œæ›´æ–°ï¼Œè¦æ±‚é•œåƒç”Ÿäº§v2ç‰ˆæœ¬ã€‚" class="headerlink" title="3)  å°†å®ä¾‹è¿›è¡Œæ›´æ–°ï¼Œè¦æ±‚é•œåƒç”Ÿäº§v2ç‰ˆæœ¬ã€‚"></a>3)  å°†å®ä¾‹è¿›è¡Œæ›´æ–°ï¼Œè¦æ±‚é•œåƒç”Ÿäº§v2ç‰ˆæœ¬ã€‚</h2><p><strong>ç§æœ‰é•œåƒå’Œå®˜æ–¹é•œåƒå‡çº§æœ‰æ‰€ä¸åŒï¼Œå®˜æ–¹çš„åªéœ€é€šè¿‡ ï¼ˆhelm upgrade â€“set imageTag=â€œæ ‡ç­¾â€ æœåŠ¡åç§° chartsåŒ…å ï¼‰è¿›è¡Œæ›´æ”¹æ ‡ç­¾å³å¯ï¼Œè€Œç§æœ‰é•œåƒéœ€é€šè¿‡æ›´æ”¹values.yamlä¸­çš„æ ‡ç­¾æ‰è¡Œæ¯”è¾ƒéº»çƒ¦ä¸€ç‚¹ã€‚</strong></p>
<h3 id="1ã€ä¿®æ”¹values-yaml"><a href="#1ã€ä¿®æ”¹values-yaml" class="headerlink" title="1ã€ä¿®æ”¹values.yaml"></a>1ã€ä¿®æ”¹values.yaml</h3><figure class="highlight plain"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line">[root@master ~]# vim wsd/values.yaml </span><br><span class="line"></span><br><span class="line"># Default values for wsd.</span><br><span class="line"># This is a YAML-formatted file.</span><br><span class="line"># Declare variables to be passed into your templates.</span><br><span class="line"></span><br><span class="line">replicaCount: 3</span><br><span class="line"></span><br><span class="line">image:</span><br><span class="line">  repository: 192.168.1.21:5000/web</span><br><span class="line">  tag: v2                            #ä¿®æ”¹æ ‡ç­¾ä¸ºv2</span><br><span class="line">  pullPolicy: IfNotPresent</span><br><span class="line">[root@master ~]# helm upgrade wsd wsd/ -f wsd/values.yaml</span><br><span class="line">//åŸºäºé…ç½®æ–‡ä»¶åˆ·æ–°ä¸€ä¸‹wsdæœåŠ¡</span><br></pre></td></tr></tbody></table></figure>

<h4 id="æŸ¥çœ‹ä¸€ä¸‹"><a href="#æŸ¥çœ‹ä¸€ä¸‹" class="headerlink" title="æŸ¥çœ‹ä¸€ä¸‹"></a>æŸ¥çœ‹ä¸€ä¸‹</h4><figure class="highlight plain"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">[root@master ~]# kubectl get deployments. -o wide</span><br></pre></td></tr></tbody></table></figure>

<p><img src="https://s1.51cto.com/images/blog/202003/04/904155e6a55a22dc169ab2b991c3a19a.png?x-oss-process=image/watermark,size_16,text_QDUxQ1RP5Y2a5a6i,color_FFFFFF,t_100,g_se,x_10,y_10,shadow_90,type_ZmFuZ3poZW5naGVpdGk=" alt=""></p>
<h4 id="è®¿é—®ä¸€ä¸‹-1"><a href="#è®¿é—®ä¸€ä¸‹-1" class="headerlink" title="è®¿é—®ä¸€ä¸‹"></a>è®¿é—®ä¸€ä¸‹</h4><figure class="highlight plain"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">[root@master ~]# curl 127.0.0.1:30000</span><br></pre></td></tr></tbody></table></figure>

<p><img src="https://s1.51cto.com/images/blog/202003/04/a739f12e8be562ce407bb9a739b0734f.png?x-oss-process=image/watermark,size_16,text_QDUxQ1RP5Y2a5a6i,color_FFFFFF,t_100,g_se,x_10,y_10,shadow_90,type_ZmFuZ3poZW5naGVpdGk=" alt=""></p>
<h3 id="2ã€ä½¿ç”¨editè¿›è¡Œç‰ˆæœ¬æ›´æ–°"><a href="#2ã€ä½¿ç”¨editè¿›è¡Œç‰ˆæœ¬æ›´æ–°" class="headerlink" title="2ã€ä½¿ç”¨editè¿›è¡Œç‰ˆæœ¬æ›´æ–°"></a>2ã€ä½¿ç”¨editè¿›è¡Œç‰ˆæœ¬æ›´æ–°</h3><p><strong><em>ç¡®å®šwsdè¿™ä¸ªæœåŠ¡å¼€å¯</em></strong></p>
<figure class="highlight plain"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">[root@master ~]# kubectl edit deployments. wsd</span><br></pre></td></tr></tbody></table></figure>

<p><img src="https://s1.51cto.com/images/blog/202003/04/e418604d73fee964440211b46a7a143c.png?x-oss-process=image/watermark,size_16,text_QDUxQ1RP5Y2a5a6i,color_FFFFFF,t_100,g_se,x_10,y_10,shadow_90,type_ZmFuZ3poZW5naGVpdGk=" alt=""></p>
<h4 id="æŸ¥çœ‹ä¸€ä¸‹-1"><a href="#æŸ¥çœ‹ä¸€ä¸‹-1" class="headerlink" title="æŸ¥çœ‹ä¸€ä¸‹"></a>æŸ¥çœ‹ä¸€ä¸‹</h4><figure class="highlight plain"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">[root@master ~]# kubectl get deployments. -o wide</span><br></pre></td></tr></tbody></table></figure>

<p><img src="https://s1.51cto.com/images/blog/202003/04/bd177f123d471ed674ed0cc40d51ee70.png?x-oss-process=image/watermark,size_16,text_QDUxQ1RP5Y2a5a6i,color_FFFFFF,t_100,g_se,x_10,y_10,shadow_90,type_ZmFuZ3poZW5naGVpdGk=" alt=""></p>
<h4 id="è®¿é—®ä¸€ä¸‹-2"><a href="#è®¿é—®ä¸€ä¸‹-2" class="headerlink" title="è®¿é—®ä¸€ä¸‹"></a>è®¿é—®ä¸€ä¸‹</h4><figure class="highlight plain"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">[root@master ~]# curl 127.0.0.1:30000</span><br></pre></td></tr></tbody></table></figure>

<p><img src="https://s1.51cto.com/images/blog/202003/04/4755f15c01775053bd10434a90a87637.png?x-oss-process=image/watermark,size_16,text_QDUxQ1RP5Y2a5a6i,color_FFFFFF,t_100,g_se,x_10,y_10,shadow_90,type_ZmFuZ3poZW5naGVpdGk=" alt=""></p>
<h2 id="4ï¼‰é‡æ–°å®šä¹‰ä¸€ä¸ªchartåŒ…ï¼Œåç§°ä¸º-new-test-å°†è¿™ä¸ªåŒ…ä¸Šä¼ åˆ°ä¸Šè¿°ç§æœ‰ä»“åº“ä¸­-éœ€è¦ç”¨helm-repo-updateå‘½ç²æ›´æ–°æœ¬åœ°çš„indexæ–‡ä»¶ã€‚"><a href="#4ï¼‰é‡æ–°å®šä¹‰ä¸€ä¸ªchartåŒ…ï¼Œåç§°ä¸º-new-test-å°†è¿™ä¸ªåŒ…ä¸Šä¼ åˆ°ä¸Šè¿°ç§æœ‰ä»“åº“ä¸­-éœ€è¦ç”¨helm-repo-updateå‘½ç²æ›´æ–°æœ¬åœ°çš„indexæ–‡ä»¶ã€‚" class="headerlink" title="4ï¼‰é‡æ–°å®šä¹‰ä¸€ä¸ªchartåŒ…ï¼Œåç§°ä¸º: new-test,å°†è¿™ä¸ªåŒ…ä¸Šä¼ åˆ°ä¸Šè¿°ç§æœ‰ä»“åº“ä¸­,éœ€è¦ç”¨helm repo updateå‘½ç²æ›´æ–°æœ¬åœ°çš„indexæ–‡ä»¶ã€‚"></a>4ï¼‰é‡æ–°å®šä¹‰ä¸€ä¸ªchartåŒ…ï¼Œåç§°ä¸º: new-test,å°†è¿™ä¸ªåŒ…ä¸Šä¼ åˆ°ä¸Šè¿°ç§æœ‰ä»“åº“ä¸­,éœ€è¦ç”¨helm repo updateå‘½ç²æ›´æ–°æœ¬åœ°çš„indexæ–‡ä»¶ã€‚</h2><figure class="highlight plain"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">[root@master ~]# helm repo list</span><br></pre></td></tr></tbody></table></figure>

<p><img src="https://s1.51cto.com/images/blog/202003/04/6a6e8d003c8986fab01bab76ba1473d4.png?x-oss-process=image/watermark,size_16,text_QDUxQ1RP5Y2a5a6i,color_FFFFFF,t_100,g_se,x_10,y_10,shadow_90,type_ZmFuZ3poZW5naGVpdGk=" alt=""></p>
<figure class="highlight plain"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line">[root@master ~]# helm create xgp-wsd</span><br><span class="line">//åˆ›å»ºä¸€ä¸ªåä¸ºxgp-wsdçš„chartsåŒ…</span><br><span class="line"></span><br><span class="line">[root@master ~]# helm package xgp-wsd/</span><br><span class="line">//å°†xgp-wsdæ‰“åŒ…åœ¨å½“å‰ç›®å½•</span><br><span class="line"></span><br><span class="line">[root@master ~]# mv xgp-wsd-0.1.0.tgz xgprepo/</span><br><span class="line">//æŠŠæ‰“åŒ…æ–‡ä»¶æ”¾åˆ°ä»“åº“ç›®å½•</span><br><span class="line"></span><br><span class="line">[root@master ~]# helm repo index xgprepo/ --url http://192.168.1.22:8080/charts</span><br><span class="line">//æŠŠä»“åº“ç›®å½•æ–°åŠ å…¥çš„chartsåŒ…ä¿¡æ¯è®°å½•åœ¨index.yamlä¸­ï¼Œä½¿å¾—å…¶ä»–åŠ å…¥çš„ä¸»æœºå¯ä»¥è¯†åˆ«åˆ°ï¼Œä»“åº“çš„chartsåŒ…</span><br><span class="line"></span><br><span class="line">[root@master ~]# scp xgprepo/* node01:/var/xgp/charts</span><br><span class="line">//å°†ä»“åº“ç›®å½•çš„æ–‡ä»¶ç§»åŠ¨åˆ°httpdæœåŠ¡ä¸Šï¼Œä½¿å„ä¸ªä¸»æœºå¯ä»¥è®¿é—®ï¼Œä¸‹è½½ä»“åº“çš„chartsåŒ…</span><br><span class="line"></span><br><span class="line">[root@master ~]# helm repo update </span><br><span class="line">//æ›´æ–°ä¸€ä¸‹chartå­˜å‚¨åº“</span><br><span class="line"></span><br><span class="line">[root@master myrepo]# helm install http://192.168.1.22:8080/charts/xgp-wsd-0.1.0.tgz</span><br><span class="line">//åŸºäºä»“åº“çš„xgp-wsd-0.1.0.tgzåŒ…åˆ›å»ºä¸€ä¸ªæœåŠ¡</span><br></pre></td></tr></tbody></table></figure>

<h3 id="æŸ¥çœ‹ä¸€ä¸‹-2"><a href="#æŸ¥çœ‹ä¸€ä¸‹-2" class="headerlink" title="æŸ¥çœ‹ä¸€ä¸‹"></a>æŸ¥çœ‹ä¸€ä¸‹</h3><figure class="highlight plain"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">[root@master ~]# helm search xgp-wsd</span><br></pre></td></tr></tbody></table></figure>

<p><img src="https://s1.51cto.com/images/blog/202003/04/11da050bfeec791fe57f179ae8854044.png?x-oss-process=image/watermark,size_16,text_QDUxQ1RP5Y2a5a6i,color_FFFFFF,t_100,g_se,x_10,y_10,shadow_90,type_ZmFuZ3poZW5naGVpdGk=" alt=""></p>
<script>
        document.querySelectorAll('.github-emoji')
          .forEach(el => {
            if (!el.dataset.src) { return; }
            const img = document.createElement('img');
            img.style = 'display:none !important;';
            img.src = el.dataset.src;
            img.addEventListener('error', () => {
              img.remove();
              el.style.color = 'inherit';
              el.style.backgroundImage = 'none';
              el.style.background = 'none';
            });
            img.addEventListener('load', () => {
              img.remove();
            });
            document.body.appendChild(img);
          });
      </script>

                            <!-- Meta -->
                            <div class="post-meta">
                                <hr>
                                <br>
                                <div class="post-tags">
                                    
                                </div>
                                <div class="post-date">
                                    2020-03-12
                                </div>
                            </div>
                    </div>

                    <!-- Comments -->
                    <div class="col-lg-8 col-lg-offset-2 col-md-10 col-md-offset-1">
                        <!-- Disqus Comments -->


                    </div>
                </div>
            </div>
        </article>
</section>

<!-- Image viewer-->

    <!-- Custom picture view-->
    <link href="/css/viewer.min.css" rel="stylesheet" />
    <script
      src="/js/viewer.min.js"
      type="text/javascript"
      charset="utf-8"
    ></script>
    
    <script type="text/javascript">
      // set image viewer
      Viewer.setDefaults({
        zoomRatio: [0.5],
        navbar: false,
        toolbar: false,
        button: false,
        title: [2, (image, imageData) => `${image.alt}`],
        show: function() {
          this.viewer.zoomTo(0.5);
        }
      });
      var imageList = document.getElementsByTagName("img");
      Array.prototype.forEach.call(imageList, element => {
        var viewer = new Viewer(element);
      });
    </script>

    
    <!-- Scripts -->
    <script type="text/javascript">
    console.log("Â© zchen9 ğŸ™‹ 2015-" + new Date().getFullYear());
</script>
  
    <!-- Google Analytics -->
    

    <!-- Service Worker -->
    <!-- if using service worker -->

    
<script src="/live2dw/lib/L2Dwidget.min.js?094cbace49a39548bed64abff5988b05"></script><script>L2Dwidget.init({"log":false,"pluginJsPath":"lib/","pluginModelPath":"assets/","pluginRootPath":"live2dw/","tagMode":false});</script></body>

</html>