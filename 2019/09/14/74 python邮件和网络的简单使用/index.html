<!DOCTYPE html><html lang="zh-CN" data-theme="light"><head><meta charset="UTF-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width,initial-scale=1"><title>python邮件和网络的简单使用 | Xgp &amp; Blog</title><meta name="description" content="一、Excel文档操作练习（pycharm） sorted() 函数对所有可迭代的对象进行排序操作。  sort 与 sorted 区别： sort 是应用在 list 上的方法，sorted 可以对所有可迭代的对象进行排序操作。 list 的 sort 方法返回的是对已经存在的列表进行操作，而内建函数 sorted 方法返回的是一个新的 list，而不是在原来的基础上进行的操作。  1、需提前在"><meta name="keywords" content="nfs,deployment,pv,pvc,Storage Class,dashboard,helm"><meta name="author" content="Wu Shao Dong"><meta name="copyright" content="Wu Shao Dong"><meta name="format-detection" content="telephone=no"><link rel="shortcut icon" href="/img/favicon.png"><link rel="canonical" href="wsdlxgp.top/2019/09/14/74%20python%E9%82%AE%E4%BB%B6%E5%92%8C%E7%BD%91%E7%BB%9C%E7%9A%84%E7%AE%80%E5%8D%95%E4%BD%BF%E7%94%A8/"><meta http-equiv="Cache-Control" content="no-transform"><meta http-equiv="Cache-Control" content="no-siteapp"><link rel="preconnect" href="//cdn.jsdelivr.net"/><link rel="preconnect" href="//fonts.googleapis.com" crossorigin="crossorigin"/><link rel="preconnect" href="//busuanzi.ibruce.info"/><meta property="og:type" content="article"><meta property="og:title" content="python邮件和网络的简单使用"><meta property="og:url" content="wsdlxgp.top/2019/09/14/74%20python%E9%82%AE%E4%BB%B6%E5%92%8C%E7%BD%91%E7%BB%9C%E7%9A%84%E7%AE%80%E5%8D%95%E4%BD%BF%E7%94%A8/"><meta property="og:site_name" content="Xgp &amp; Blog"><meta property="og:description" content="一、Excel文档操作练习（pycharm） sorted() 函数对所有可迭代的对象进行排序操作。  sort 与 sorted 区别： sort 是应用在 list 上的方法，sorted 可以对所有可迭代的对象进行排序操作。 list 的 sort 方法返回的是对已经存在的列表进行操作，而内建函数 sorted 方法返回的是一个新的 list，而不是在原来的基础上进行的操作。  1、需提前在"><meta property="og:image" content="https://gitee.com/xgpqq/tuchuang/raw/master/img/qweq74p.jpg"><meta property="article:published_time" content="2019-09-13T16:29:00.000Z"><meta property="article:modified_time" content="2020-06-30T06:55:18.423Z"><meta name="twitter:card" content="summary"><script>var activateDarkMode = function () {
  document.documentElement.setAttribute('data-theme', 'dark')
  if (document.querySelector('meta[name="theme-color"]') !== null) {
    document.querySelector('meta[name="theme-color"]').setAttribute('content', '#000')
  }
}
var activateLightMode = function () {
  document.documentElement.setAttribute('data-theme', 'light')
  if (document.querySelector('meta[name="theme-color"]') !== null) {
    document.querySelector('meta[name="theme-color"]').setAttribute('content', '#fff')
  }
}

var getCookies = function (name) {
  const value = `; ${document.cookie}`
  const parts = value.split(`; ${name}=`)
  if (parts.length === 2) return parts.pop().split(';').shift()
}

var autoChangeMode = 'false'
var t = getCookies('theme')
if (autoChangeMode === '1') {
  var isDarkMode = window.matchMedia('(prefers-color-scheme: dark)').matches
  var isLightMode = window.matchMedia('(prefers-color-scheme: light)').matches
  var isNotSpecified = window.matchMedia('(prefers-color-scheme: no-preference)').matches
  var hasNoSupport = !isDarkMode && !isLightMode && !isNotSpecified

  if (t === undefined) {
    if (isLightMode) activateLightMode()
    else if (isDarkMode) activateDarkMode()
    else if (isNotSpecified || hasNoSupport) {
      console.log('You specified no preference for a color scheme or your browser does not support it. I Schedule dark mode during night time.')
      var now = new Date()
      var hour = now.getHours()
      var isNight = hour <= 6 || hour >= 18
      isNight ? activateDarkMode() : activateLightMode()
    }
    window.matchMedia('(prefers-color-scheme: dark)').addListener(function (e) {
      if (Cookies.get('theme') === undefined) {
        e.matches ? activateDarkMode() : activateLightMode()
      }
    })
  } else if (t === 'light') activateLightMode()
  else activateDarkMode()
} else if (autoChangeMode === '2') {
  now = new Date()
  hour = now.getHours()
  isNight = hour <= 6 || hour >= 18
  if (t === undefined) isNight ? activateDarkMode() : activateLightMode()
  else if (t === 'light') activateLightMode()
  else activateDarkMode()
} else {
  if (t === 'dark') activateDarkMode()
  else if (t === 'light') activateLightMode()
}</script><link rel="stylesheet" href="/css/index.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free/css/all.min.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fancyapps/fancybox@latest/dist/jquery.fancybox.min.css"><link rel="prev" title="python的网络" href="/wsdlxgp.top/2019/09/14/75%20python%E7%9A%84%E7%BD%91%E7%BB%9C%EF%BC%88nmap%EF%BC%8CIPy%EF%BC%8Cdnspython%EF%BC%89/"><link rel="next" title="python的文件处理" href="/wsdlxgp.top/2019/09/14/73%20python%E7%9A%84%E6%96%87%E4%BB%B6%E5%A4%84%E7%90%86/"><link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Titillium+Web&amp;display=swap"><script>var GLOBAL_CONFIG = { 
  root: '/',
  algolia: undefined,
  localSearch: undefined,
  translate: {"defaultEncoding":2,"translateDelay":0,"msgToTraditionalChinese":"繁","msgToSimplifiedChinese":"簡"},
  copy: {
    success: '复制成功',
    error: '复制错误',
    noSupport: '浏览器不支持'
  },
  bookmark: {
    message_prev: '按',
    message_next: '键将本页加入书签'
  },
  runtime_unit: '天',
  runtime: false,
  copyright: undefined,
  ClickShowText: undefined,
  medium_zoom: false,
  fancybox: true,
  Snackbar: undefined,
  justifiedGallery: {
    js: 'https://cdn.jsdelivr.net/npm/justifiedGallery/dist/js/jquery.justifiedGallery.min.js',
    css: 'https://cdn.jsdelivr.net/npm/justifiedGallery/dist/css/justifiedGallery.min.css'
  },
  baiduPush: false,
  highlightCopy: true,
  highlightLang: true,
  isPhotoFigcaption: false,
  islazyload: true,
  isanchor: false    
}</script><script>var GLOBAL_CONFIG_SITE = { 
  isPost: true,
  isHome: false,
  isHighlightShrink: false,
  isSidebar: true
  }</script><noscript><style>
#nav {
  opacity: 1
}
.justified-gallery img{
  opacity: 1
}
</style></noscript><meta name="generator" content="Hexo 4.2.0"><link rel="alternate" href="/atom.xml" title="Xgp & Blog" type="application/atom+xml">
<link rel="stylesheet" href="/css/prism.css" type="text/css"></head><body><div id="mobile-sidebar"><div id="menu_mask"></div><div id="mobile-sidebar-menus"><div class="mobile_author_icon"><img class="avatar-img" src="/img/avatar.png" onerror="onerror=null;src='/img/friend_404.gif'" alt="avatar"/></div><div class="mobile_post_data"><div class="mobile_data_item is-center"><div class="mobile_data_link"><a href="/archives/"><div class="headline">文章</div><div class="length_num">132</div></a></div></div><div class="mobile_data_item is-center">      <div class="mobile_data_link"><a href="/tags/"><div class="headline">标签</div><div class="length_num">76</div></a></div></div><div class="mobile_data_item is-center">     <div class="mobile_data_link"><a href="/categories/"><div class="headline">分类</div><div class="length_num">4</div></a></div></div></div><hr/><div class="menus_items"><div class="menus_item"><a class="site-page" href="/"><i class="fa-fw fas fa-home"></i><span> Home</span></a></div><div class="menus_item"><a class="site-page" href="/archives/"><i class="fa-fw fas fa-archive"></i><span> Archives</span></a></div><div class="menus_item"><a class="site-page" href="/tags/"><i class="fa-fw fas fa-tags"></i><span> Tags</span></a></div><div class="menus_item"><a class="site-page" href="/categories/"><i class="fa-fw fas fa-folder-open"></i><span> Categories</span></a></div><div class="menus_item"><a class="site-page"><i class="fa-fw fas fa-list"></i><span> List</span><i class="fas fa-chevron-down menus-expand"></i></a><ul class="menus_item_child"><li><a class="site-page" href="/music/"><i class="fa-fw fas fa-music"></i><span> Music</span></a></li><li><a class="site-page" href="/movies/"><i class="fa-fw fas fa-video"></i><span> Movie</span></a></li></ul></div><div class="menus_item"><a class="site-page" href="/link/"><i class="fa-fw fas fa-link"></i><span> Link</span></a></div><div class="menus_item"><a class="site-page" href="/about/"><i class="fa-fw fas fa-heart"></i><span> About</span></a></div></div></div></div><i class="fas fa-arrow-right on" id="toggle-sidebar"></i><div id="sidebar"><div class="sidebar-toc"><div class="sidebar-toc__title">目录</div><div class="sidebar-toc__progress"><span class="progress-notice">你已经读了</span><span class="progress-num">0</span><span class="progress-percentage">%</span><div class="sidebar-toc__progress-bar">     </div></div><div class="sidebar-toc__content"><ol class="toc"><li class="toc-item toc-level-1"><a class="toc-link" href="#"><span class="toc-number">1.</span> <span class="toc-text">一、Excel文档操作练习（pycharm）</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#sort-与-sorted-区别："><span class="toc-number">1.0.0.1.</span> <span class="toc-text">sort 与 sorted 区别：</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#1、需提前在当前目录准备好excel文件（多复制几个）："><span class="toc-number">1.0.1.</span> <span class="toc-text">1、需提前在当前目录准备好excel文件（多复制几个）：</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#2、编写python脚本"><span class="toc-number">1.0.2.</span> <span class="toc-text">2、编写python脚本</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#3、执行过后查看result-xlsx"><span class="toc-number">1.0.3.</span> <span class="toc-text">3、执行过后查看result.xlsx</span></a></li></ol></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#"><span class="toc-number">2.</span> <span class="toc-text">二、python发送邮件（SMTP协议介绍）</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#smtplib发送邮件的步骤："><span class="toc-number">2.0.1.</span> <span class="toc-text">smtplib发送邮件的步骤：</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#1、测试一下"><span class="toc-number">2.1.</span> <span class="toc-text">1、测试一下</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#输出结果如下："><span class="toc-number">2.1.0.1.</span> <span class="toc-text">输出结果如下：</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#查看成功接收的邮件："><span class="toc-number">2.1.0.2.</span> <span class="toc-text">查看成功接收的邮件：</span></a></li></ol></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#2、较完整的发送"><span class="toc-number">2.2.</span> <span class="toc-text">2、较完整的发送</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#输出结果如下：-2"><span class="toc-number">2.2.0.1.</span> <span class="toc-text">输出结果如下：</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#查看成功接收的邮件：-2"><span class="toc-number">2.2.0.2.</span> <span class="toc-text">查看成功接收的邮件：</span></a></li></ol></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#3、发送带附件的邮件"><span class="toc-number">2.3.</span> <span class="toc-text">3、发送带附件的邮件</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#查看成功接收的邮件：-3"><span class="toc-number">2.3.0.1.</span> <span class="toc-text">查看成功接收的邮件：</span></a></li></ol></li></ol></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#"><span class="toc-number">3.</span> <span class="toc-text">三、网络管理</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#1、列出活跃的主机"><span class="toc-number">3.1.</span> <span class="toc-text">1、列出活跃的主机</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#ping一下"><span class="toc-number">3.1.1.</span> <span class="toc-text">ping一下</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#（1）创建测试的网络"><span class="toc-number">3.1.2.</span> <span class="toc-text">（1）创建测试的网络</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#（2）创建shell脚本，批量测IP是否可用"><span class="toc-number">3.1.3.</span> <span class="toc-text">（2）创建shell脚本，批量测IP是否可用</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#执行结果如下："><span class="toc-number">3.1.3.1.</span> <span class="toc-text">执行结果如下：</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#（3）线程模块"><span class="toc-number">3.1.4.</span> <span class="toc-text">（3）线程模块</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#参数说明"><span class="toc-number">3.1.4.1.</span> <span class="toc-text">参数说明:</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#threading-模块提供的其他方法："><span class="toc-number">3.1.4.2.</span> <span class="toc-text">threading 模块提供的其他方法：</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#除了使用方法外，线程模块同样提供了Thread类来处理线程，Thread类提供了以下方法"><span class="toc-number">3.1.4.3.</span> <span class="toc-text">除了使用方法外，线程模块同样提供了Thread类来处理线程，Thread类提供了以下方法:</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#（4）创建python脚本，批量测IP是否可用"><span class="toc-number">3.1.5.</span> <span class="toc-text">（4）创建python脚本，批量测IP是否可用</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#执行结果如下：-2"><span class="toc-number">3.1.5.1.</span> <span class="toc-text">执行结果如下：</span></a></li></ol></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#2、端口扫描"><span class="toc-number">3.2.</span> <span class="toc-text">2、端口扫描</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#（1）安装telnet"><span class="toc-number">3.2.1.</span> <span class="toc-text">（1）安装telnet</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#测试一下"><span class="toc-number">3.2.1.1.</span> <span class="toc-text">测试一下</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#（2）socket模块"><span class="toc-number">3.2.2.</span> <span class="toc-text">（2）socket模块</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#什么是-Socket"><span class="toc-number">3.2.2.1.</span> <span class="toc-text">什么是 Socket?</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#socket-函数"><span class="toc-number">3.2.2.2.</span> <span class="toc-text">socket()函数</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#参数"><span class="toc-number">3.2.3.</span> <span class="toc-text">参数</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#（1）如下所示"><span class="toc-number">3.2.3.1.</span> <span class="toc-text">（1）如下所示:</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#（2）如下所示"><span class="toc-number">3.2.3.2.</span> <span class="toc-text">（2）如下所示</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#执行结果如下"><span class="toc-number">3.2.3.2.1.</span> <span class="toc-text">执行结果如下</span></a></li></ol></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#（3）接下来，我们就看一下如何使用简单的socket接口编写一个端口扫描器。-如下所示"><span class="toc-number">3.2.4.</span> <span class="toc-text">（3）接下来，我们就看一下如何使用简单的socket接口编写一个端口扫描器。 如下所示:</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#执行结果如下：-3"><span class="toc-number">3.2.4.0.1.</span> <span class="toc-text">执行结果如下：</span></a></li></ol></li><li class="toc-item toc-level-4"><a class="toc-link" href="#较快的："><span class="toc-number">3.2.4.1.</span> <span class="toc-text">较快的：</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#输出结果如下：-3"><span class="toc-number">3.2.4.1.1.</span> <span class="toc-text">输出结果如下：</span></a></li></ol></li></ol></li></ol></li></ol></li></ol></div></div></div><div id="body-wrap"><header class="post-bg" id="page-header" style="background-image: url(https://gitee.com/xgpqq/tuchuang/raw/master/img/qweq74p.jpg)"><nav id="nav"><span class="pull-left" id="blog_name"><a class="blog_title" id="site-name" href="/">Xgp &amp; Blog</a></span><span class="pull-right menus"><div class="menus_items"><div class="menus_item"><a class="site-page" href="/"><i class="fa-fw fas fa-home"></i><span> Home</span></a></div><div class="menus_item"><a class="site-page" href="/archives/"><i class="fa-fw fas fa-archive"></i><span> Archives</span></a></div><div class="menus_item"><a class="site-page" href="/tags/"><i class="fa-fw fas fa-tags"></i><span> Tags</span></a></div><div class="menus_item"><a class="site-page" href="/categories/"><i class="fa-fw fas fa-folder-open"></i><span> Categories</span></a></div><div class="menus_item"><a class="site-page"><i class="fa-fw fas fa-list"></i><span> List</span><i class="fas fa-chevron-down menus-expand"></i></a><ul class="menus_item_child"><li><a class="site-page" href="/music/"><i class="fa-fw fas fa-music"></i><span> Music</span></a></li><li><a class="site-page" href="/movies/"><i class="fa-fw fas fa-video"></i><span> Movie</span></a></li></ul></div><div class="menus_item"><a class="site-page" href="/link/"><i class="fa-fw fas fa-link"></i><span> Link</span></a></div><div class="menus_item"><a class="site-page" href="/about/"><i class="fa-fw fas fa-heart"></i><span> About</span></a></div></div><span class="toggle-menu close"><a class="site-page"><i class="fas fa-bars fa-fw"></i></a></span></span></nav><div id="post-info"><div id="post-title"><div class="posttitle">python邮件和网络的简单使用</div></div><div id="post-meta"><div class="meta-firstline"><time class="post-meta__date"><span class="post-meta__date-created" title="发表于 2019-09-14 00:29:00"><i class="far fa-calendar-alt fa-fw"></i> 发表于 2019-09-14</span><span class="post-meta__separator">|</span><span class="post-meta__date-updated" title="更新于 2020-06-30 14:55:18"><i class="fas fa-history fa-fw"></i> 更新于 2020-06-30</span></time><span class="post-meta__categories"><span class="post-meta__separator">|</span><i class="fas fa-inbox fa-fw post-meta__icon"></i><a class="post-meta__categories" href="/categories/python/">python</a></span></div><div class="meta-secondline"> </div><div class="meta-thirdline"><span class="post-meta-pv-cv"><i class="far fa-eye fa-fw post-meta__icon"></i><span>阅读量:</span><span id="busuanzi_value_page_pv"></span></span><span class="post-meta-commentcount"></span></div></div></div></header><main class="layout_post" id="content-inner"><article id="post"><div class="post-content" id="article-container"><h1>一、Excel文档操作练习（pycharm）</h1>
<p><strong><code>sorted()</code> 函数对所有可迭代的对象进行排序操作。</strong></p>
<blockquote>
<h4 id="sort-与-sorted-区别："><strong>sort 与 sorted 区别：</strong></h4>
<p><strong>sort 是应用在 list 上的方法，sorted 可以对所有可迭代的对象进行排序操作。</strong></p>
<p><strong>list 的 sort 方法返回的是对已经存在的列表进行操作，而内建函数 sorted 方法返回的是一个新的 list，而不是在原来的基础上进行的操作。</strong></p>
</blockquote>
<h3 id="1、需提前在当前目录准备好excel文件（多复制几个）：">1、需提前在当前目录准备好excel文件（多复制几个）：</h3>
<p><img src= "/img/loading.gif" data-src="https://gitee.com/xgpqq/tuchuang/raw/master/img/image-20200511160225332.png" alt="image-20200511160225332"></p>
<p><img src= "/img/loading.gif" data-src="https://gitee.com/xgpqq/tuchuang/raw/master/img/image-20200511160105353.png" alt="image-20200511160105353"></p>
<h3 id="2、编写python脚本">2、编写python脚本</h3>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br></pre></td><td class="code"><pre class=" language-hljs python"><span class="hljs-string">'''</span><br><span class="hljs-string">员工角色: 行政</span><br><span class="hljs-string">工作内容: 做员工调查问卷</span><br><span class="hljs-string">工作流程: 给每个员工发送统-的问卷的模板</span><br><span class="hljs-string">要求: 员工按照提供的固定模板，填写调查问卷,并且发送给行政人员</span><br><span class="hljs-string"></span><br><span class="hljs-string">行政人员可能会受到多份格式相同而内容不同的Excel文件</span><br><span class="hljs-string">处理Excel文件:手工合并多个文件内容，</span><br><span class="hljs-string">比较常见的方法: 以某个文件(result.xlsx)的内容为基础,打开别的文件,复制其中需要的数据,粘贴到result.xlsx</span><br><span class="hljs-string">'''</span><br><br><span class="hljs-keyword">import</span> os<br><span class="hljs-keyword">import</span> glob<br><span class="hljs-keyword">import</span> openpyxl<br><br><span class="hljs-comment"># 定义函数，获取指定目录下的所有Excel文档</span><br><span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">get_all_xlsx_files</span><span class="hljs-params">(path)</span>:</span><br>    xlsx_files = glob.glob(os.path.join(path,<span class="hljs-string">'*.xlsx'</span>))<br>    sorted(xlsx_files, key=str.lower)<br>    <span class="hljs-keyword">return</span>  xlsx_files<br><br><span class="hljs-comment"># 合并Excel文档的方法</span><br><span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">merge_xlsx_files</span><span class="hljs-params">(xlsx_files)</span>:</span><br>    wb = openpyxl.load_workbook(xlsx_files[<span class="hljs-number">0</span>])<br>    ws = wb[<span class="hljs-string">"Sheet1"</span>]<br><br>    <span class="hljs-comment"># 已排序后的Excel文件的第一 顺序的文档作为基础，读取其他文档内容</span><br>    <span class="hljs-keyword">for</span> filename <span class="hljs-keyword">in</span> xlsx_files[<span class="hljs-number">1</span>:]:<br>        workbook = openpyxl.load_workbook(filename)<br>        worksheet = workbook[<span class="hljs-string">"Sheet1"</span>]<br>        <span class="hljs-comment"># 从工作表的第二行开始读取,第一行是表头,不读取。</span><br>        <span class="hljs-keyword">for</span> row <span class="hljs-keyword">in</span> worksheet.iter_rows(min_row=<span class="hljs-number">2</span>):<br>            values = [cell.value <span class="hljs-keyword">for</span> cell <span class="hljs-keyword">in</span> row]<br>            <span class="hljs-comment"># 将读取到的单元格内容追加到第一顺序的Excel文档指定的sheet内容后面</span><br>            ws.append(values)<br>    <span class="hljs-keyword">return</span> wb<br><br><span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">main</span><span class="hljs-params">()</span>:</span><br>    xlsx_files = get_all_xlsx_files(os.path.basename(<span class="hljs-string">"."</span>))<br>    wb = merge_xlsx_files(xlsx_files)<br>    wb.save(<span class="hljs-string">'result.xlsx'</span>)<br><br><span class="hljs-keyword">if</span> __name__ == <span class="hljs-string">'__main__'</span>:<br>    main()<br><br><span class="hljs-comment"># 获取指定目录下的所有Excel文档</span><br><span class="hljs-comment"><code class="language-hljs python"><span class="hljs-string">'''</span><br><span class="hljs-string">员工角色: 行政</span><br><span class="hljs-string">工作内容: 做员工调查问卷</span><br><span class="hljs-string">工作流程: 给每个员工发送统-的问卷的模板</span><br><span class="hljs-string">要求: 员工按照提供的固定模板，填写调查问卷,并且发送给行政人员</span><br><span class="hljs-string"></span><br><span class="hljs-string">行政人员可能会受到多份格式相同而内容不同的Excel文件</span><br><span class="hljs-string">处理Excel文件:手工合并多个文件内容，</span><br><span class="hljs-string">比较常见的方法: 以某个文件(result.xlsx)的内容为基础,打开别的文件,复制其中需要的数据,粘贴到result.xlsx</span><br><span class="hljs-string">'''</span><br><br><span class="hljs-keyword">import</span> os<br><span class="hljs-keyword">import</span> glob<br><span class="hljs-keyword">import</span> openpyxl<br><br><span class="hljs-comment"># 定义函数，获取指定目录下的所有Excel文档</span><br><span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">get_all_xlsx_files</span><span class="hljs-params">(path)</span>:</span><br>    xlsx_files = glob.glob(os.path.join(path,<span class="hljs-string">'*.xlsx'</span>))<br>    sorted(xlsx_files, key=str.lower)<br>    <span class="hljs-keyword">return</span>  xlsx_files<br><br><span class="hljs-comment"># 合并Excel文档的方法</span><br><span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">merge_xlsx_files</span><span class="hljs-params">(xlsx_files)</span>:</span><br>    wb = openpyxl.load_workbook(xlsx_files[<span class="hljs-number">0</span>])<br>    ws = wb[<span class="hljs-string">"Sheet1"</span>]<br><br>    <span class="hljs-comment"># 已排序后的Excel文件的第一 顺序的文档作为基础，读取其他文档内容</span><br>    <span class="hljs-keyword">for</span> filename <span class="hljs-keyword">in</span> xlsx_files[<span class="hljs-number">1</span>:]:<br>        workbook = openpyxl.load_workbook(filename)<br>        worksheet = workbook[<span class="hljs-string">"Sheet1"</span>]<br>        <span class="hljs-comment"># 从工作表的第二行开始读取,第一行是表头,不读取。</span><br>        <span class="hljs-keyword">for</span> row <span class="hljs-keyword">in</span> worksheet.iter_rows(min_row=<span class="hljs-number">2</span>):<br>            values = [cell.value <span class="hljs-keyword">for</span> cell <span class="hljs-keyword">in</span> row]<br>            <span class="hljs-comment"># 将读取到的单元格内容追加到第一顺序的Excel文档指定的sheet内容后面</span><br>            ws.append(values)<br>    <span class="hljs-keyword">return</span> wb<br><br><span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">main</span><span class="hljs-params">()</span>:</span><br>    xlsx_files = get_all_xlsx_files(os.path.basename(<span class="hljs-string">"."</span>))<br>    wb = merge_xlsx_files(xlsx_files)<br>    wb.save(<span class="hljs-string">'result.xlsx'</span>)<br><br><span class="hljs-keyword">if</span> __name__ == <span class="hljs-string">'__main__'</span>:<br>    main()<br><br><span class="hljs-comment"># 获取指定目录下的所有Excel文档</span><br><span class="hljs-comment"># xlsx_file = get_all_xlsx_files('.')</span><br></code></pre></td></tr></table></figure>
<h3 id="3、执行过后查看result-xlsx">3、执行过后查看result.xlsx</h3>
<p><img src= "/img/loading.gif" data-src="https://gitee.com/xgpqq/tuchuang/raw/master/img/image-20200511160356134.png" alt="image-20200511160356134"></p>
<p><em><strong>都合并到一起了</strong></em></p>
<h1>二、python发送邮件（<a href="https://blog.csdn.net/qq_35644234/article/details/68961603" target="_blank" rel="noopener">SMTP协议介绍</a>）</h1>
<p><img src= "/img/loading.gif" data-src="G:%5C%E5%9B%9B%E6%9C%9F%5Cpython%5Cpython%E6%96%87%E6%A1%A3%5C29.assets%5Cimage-20200513225324512.png" alt="image-20200513225324512"></p>
<h3 id="smtplib发送邮件的步骤：">smtplib发送邮件的步骤：</h3>
<ul>
<li><strong>连接SMTP服务器  smtp = smtplib.SMTP(‘<a href="http://smtp.qq.com" target="_blank" rel="noopener">smtp.qq.com</a>’,25)</strong></li>
<li><strong>发送SMTP的“Hello”消息  smtp.ehlo()    smtp.starttls()</strong></li>
<li><strong>登录到SMTP服务器 smtp.login(发送邮件的邮箱，邮箱授权码，不是邮箱密码)</strong></li>
<li><strong>发送电子邮件  smtp.send(发件人，收件人，邮件内容)</strong></li>
<li><strong>关闭SMTP服务器的连接  smtp.quit()</strong></li>
</ul>
<h2 id="1、测试一下">1、测试一下</h2>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre class=" language-hljs python"><span class="hljs-keyword">import</span> smtplib<br><br><br><span class="hljs-comment"># 连接SMTP服务器</span><br>smtp = smtplib.SMTP(<span class="hljs-string">'smtp.qq.com'</span>,<span class="hljs-number">25</span>)<br><span class="hljs-comment"># 发送SMTP的"Hello"消息</span><br>print(smtp.ehlo())          <span class="hljs-comment">#不加密</span><br>print(smtp.starttls())      <span class="hljs-comment">#加密</span><br><span class="hljs-comment"># 登录到SMTP服务器</span><br>print(smtp.login(<span class="hljs-string">'2877364346@qq.com'</span>,<span class="hljs-string">'gengfveyokhfdffe'</span>))    <span class="hljs-comment">#绑定授权码</span><br><br><span class="hljs-comment"># 发送电子邮件  smtp.send(发件人，收件人，邮件内容)</span><br>print(smtp.sendmail(<span class="hljs-string">'2877364346@qq.com'</span>,<span class="hljs-string">'3552422607@qq.com'</span>,<span class="hljs-string">'Subject:this is title\nthis is content'</span>))<br><br><span class="hljs-comment"># 关闭SMTP服务器的连接</span><br>smtp.quit()<br>print(<span class="hljs-string"><code class="language-hljs python"><span class="hljs-keyword">import</span> smtplib<br><br><br><span class="hljs-comment"># 连接SMTP服务器</span><br>smtp = smtplib.SMTP(<span class="hljs-string">'smtp.qq.com'</span>,<span class="hljs-number">25</span>)<br><span class="hljs-comment"># 发送SMTP的"Hello"消息</span><br>print(smtp.ehlo())          <span class="hljs-comment">#不加密</span><br>print(smtp.starttls())      <span class="hljs-comment">#加密</span><br><span class="hljs-comment"># 登录到SMTP服务器</span><br>print(smtp.login(<span class="hljs-string">'2877364346@qq.com'</span>,<span class="hljs-string">'gengfveyokhfdffe'</span>))    <span class="hljs-comment">#绑定授权码</span><br><br><span class="hljs-comment"># 发送电子邮件  smtp.send(发件人，收件人，邮件内容)</span><br>print(smtp.sendmail(<span class="hljs-string">'2877364346@qq.com'</span>,<span class="hljs-string">'3552422607@qq.com'</span>,<span class="hljs-string">'Subject:this is title\nthis is content'</span>))<br><br><span class="hljs-comment"># 关闭SMTP服务器的连接</span><br>smtp.quit()<br>print(<span class="hljs-string">'退出连接'</span>)<br></code></pre></td></tr></table></figure>
<h4 id="输出结果如下：">输出结果如下：</h4>
<blockquote>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre class=" language-hljs python"><span class="hljs-comment">#不加密</span><br>(<span class="hljs-number">250</span>, <span class="hljs-string">b'newxmesmtplogicsvrsza5.qq.com\nPIPELINING\nSIZE 73400320\nSTARTTLS\nAUTH LOGIN PLAIN\nAUTH=LOGIN\nMAILCOMPRESS\n8BITMIME'</span>)<br><br><span class="hljs-comment">#加密</span><br>(<span class="hljs-number">220</span>, <span class="hljs-string">b'Ready to start TLS from 113.25.19.201 to newxmesmtplogicsvrsza5.qq.com.'</span>)<br><br><span class="hljs-comment">#绑定授权码成功</span><br>(<span class="hljs-number">235</span>, <span class="hljs-string">b'Authentication successful'</span>)<br><br><span class="hljs-comment"><code class="language-hljs python"><span class="hljs-comment">#不加密</span><br>(<span class="hljs-number">250</span>, <span class="hljs-string">b'newxmesmtplogicsvrsza5.qq.com\nPIPELINING\nSIZE 73400320\nSTARTTLS\nAUTH LOGIN PLAIN\nAUTH=LOGIN\nMAILCOMPRESS\n8BITMIME'</span>)<br><br><span class="hljs-comment">#加密</span><br>(<span class="hljs-number">220</span>, <span class="hljs-string">b'Ready to start TLS from 113.25.19.201 to newxmesmtplogicsvrsza5.qq.com.'</span>)<br><br><span class="hljs-comment">#绑定授权码成功</span><br>(<span class="hljs-number">235</span>, <span class="hljs-string">b'Authentication successful'</span>)<br><br><span class="hljs-comment"># 发送电子邮件成功</span><br>&#123;&#125;<br>退出连接<br></code></pre></td></tr></table></figure>
</blockquote>
<h4 id="查看成功接收的邮件：">查看成功接收的邮件：</h4>
<p><img src= "/img/loading.gif" data-src="https://gitee.com/xgpqq/tuchuang/raw/master/img/image-20200511161517956.png" alt="image-20200511161517956"></p>
<h2 id="2、较完整的发送">2、较完整的发送</h2>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br></pre></td><td class="code"><pre class=" language-hljs python"><span class="hljs-string">'''发送纯文本邮件'''</span><br><span class="hljs-keyword">from</span> __future__ <span class="hljs-keyword">import</span> print_function<br><span class="hljs-keyword">import</span> smtplib<br><span class="hljs-keyword">from</span> email.mime.text <span class="hljs-keyword">import</span> MIMEText<br><br><br>SMTP_SERVER = <span class="hljs-string">'smtp.qq.com'</span><br>SMTP_PORT = <span class="hljs-number">25</span><br><br><span class="hljs-comment"># 定义发送邮件的方法</span><br><span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">send_mail</span><span class="hljs-params">(user,pwd,to,subject,text)</span>:</span><br>    <span class="hljs-comment"># 构建MIMEText邮件对象(纯文本)</span><br>    msg = MIMEText(text)<br>    msg[<span class="hljs-string">'From'</span>] = user<br>    msg[<span class="hljs-string">'To'</span>] = to<br>    msg[<span class="hljs-string">'Subject'</span>] = subject<br><br>    <span class="hljs-comment"># 连接SMTP服务器</span><br>    smtp = smtplib.SMTP(SMTP_SERVER,SMTP_PORT)<br>    print(<span class="hljs-string">"邮件服务器已连接"</span>)<br><br>    <span class="hljs-keyword">try</span>:<br>        smtp.ehlo()<br>        print(<span class="hljs-string">'和服务器打招呼。。。'</span>)<br><br>        smtp.starttls()<br>        print(<span class="hljs-string">'加密传输!'</span>)<br>        smtp.ehlo()<br>        print(<span class="hljs-string">'再次打招呼。。。'</span>)<br><br>        smtp.login(user,pwd)<br>        print(<span class="hljs-string">'登陆服务器'</span>)<br><br>        smtp.sendmail(user,to,msg.as_string())<br>        print(<span class="hljs-string">'邮件已发送。。。'</span>)<br>    <span class="hljs-keyword">except</span> Exception <span class="hljs-keyword">as</span> err:<br>        <span class="hljs-keyword">raise</span> SystemExit(<span class="hljs-string">'邮件发送失败:&#123;0&#125;'</span>.format(err))<br>    <span class="hljs-keyword">finally</span>:<br>        smtp.quit()<br><br><span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">main</span><span class="hljs-params">()</span>:</span><br>    send_mail(<span class="hljs-string">'2877364346@qq.com'</span>,<span class="hljs-string">'gengfveyokhfdffe'</span>,<span class="hljs-string">'3552422607@qq.com'</span>,<span class="hljs-string">'这是一封测试邮件'</span>,<span class="hljs-string">'你好xgp！'</span>)<br><br><span class="hljs-keyword">if</span> __name__ == <span class="hljs-string"><code class="language-hljs python"><span class="hljs-string">'''发送纯文本邮件'''</span><br><span class="hljs-keyword">from</span> __future__ <span class="hljs-keyword">import</span> print_function<br><span class="hljs-keyword">import</span> smtplib<br><span class="hljs-keyword">from</span> email.mime.text <span class="hljs-keyword">import</span> MIMEText<br><br><br>SMTP_SERVER = <span class="hljs-string">'smtp.qq.com'</span><br>SMTP_PORT = <span class="hljs-number">25</span><br><br><span class="hljs-comment"># 定义发送邮件的方法</span><br><span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">send_mail</span><span class="hljs-params">(user,pwd,to,subject,text)</span>:</span><br>    <span class="hljs-comment"># 构建MIMEText邮件对象(纯文本)</span><br>    msg = MIMEText(text)<br>    msg[<span class="hljs-string">'From'</span>] = user<br>    msg[<span class="hljs-string">'To'</span>] = to<br>    msg[<span class="hljs-string">'Subject'</span>] = subject<br><br>    <span class="hljs-comment"># 连接SMTP服务器</span><br>    smtp = smtplib.SMTP(SMTP_SERVER,SMTP_PORT)<br>    print(<span class="hljs-string">"邮件服务器已连接"</span>)<br><br>    <span class="hljs-keyword">try</span>:<br>        smtp.ehlo()<br>        print(<span class="hljs-string">'和服务器打招呼。。。'</span>)<br><br>        smtp.starttls()<br>        print(<span class="hljs-string">'加密传输!'</span>)<br>        smtp.ehlo()<br>        print(<span class="hljs-string">'再次打招呼。。。'</span>)<br><br>        smtp.login(user,pwd)<br>        print(<span class="hljs-string">'登陆服务器'</span>)<br><br>        smtp.sendmail(user,to,msg.as_string())<br>        print(<span class="hljs-string">'邮件已发送。。。'</span>)<br>    <span class="hljs-keyword">except</span> Exception <span class="hljs-keyword">as</span> err:<br>        <span class="hljs-keyword">raise</span> SystemExit(<span class="hljs-string">'邮件发送失败:&#123;0&#125;'</span>.format(err))<br>    <span class="hljs-keyword">finally</span>:<br>        smtp.quit()<br><br><span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">main</span><span class="hljs-params">()</span>:</span><br>    send_mail(<span class="hljs-string">'2877364346@qq.com'</span>,<span class="hljs-string">'gengfveyokhfdffe'</span>,<span class="hljs-string">'3552422607@qq.com'</span>,<span class="hljs-string">'这是一封测试邮件'</span>,<span class="hljs-string">'你好xgp！'</span>)<br><br><span class="hljs-keyword">if</span> __name__ == <span class="hljs-string">'__main__'</span>:<br>    main()<br></code></pre></td></tr></table></figure>
<h4 id="输出结果如下：-2">输出结果如下：</h4>
<blockquote>
<figure class="highlight cmd"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre class=" language-hljs cmd"><code class="language-hljs cmd">邮件服务器已连接<br>和服务器打招呼。。。<br>加密传输!<br>再次打招呼。。。<br>登陆服务器<br>邮件已发送。。。<br></code></pre></td></tr></table></figure>
</blockquote>
<h4 id="查看成功接收的邮件：-2">查看成功接收的邮件：</h4>
<p><img src= "/img/loading.gif" data-src="https://gitee.com/xgpqq/tuchuang/raw/master/img/image-20200511161701646.png" alt="image-20200511161701646"></p>
<h2 id="3、发送带附件的邮件">3、发送带附件的邮件</h2>
<p><strong>发送带附件的邮件，首先要创建MIMEMultipart()实例，然后构造附件，如果有多个附件，可依次构造，最后利用smtplib.smtp发送。</strong></p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre class=" language-hljs python"><span class="hljs-keyword">import</span> yagmail<br><br>yag = yagmail.SMTP(user=<span class="hljs-string">'2877364346@qq.com'</span>, password=<span class="hljs-string">'gengfveyokhfdffexgp'</span>, host=<span class="hljs-string">'smtp.qq.com'</span>, port=<span class="hljs-number">465</span>)<br>content = [<span class="hljs-string">'yagmail测试邮件内容'</span>, <span class="hljs-string">'1000263.jpg'</span>]<br><br>yag.send(<span class="hljs-string">'3552422607@qq.com'</span>, <span class="hljs-string"><code class="language-hljs python"><span class="hljs-keyword">import</span> yagmail<br><br>yag = yagmail.SMTP(user=<span class="hljs-string">'2877364346@qq.com'</span>, password=<span class="hljs-string">'gengfveyokhfdffexgp'</span>, host=<span class="hljs-string">'smtp.qq.com'</span>, port=<span class="hljs-number">465</span>)<br>content = [<span class="hljs-string">'yagmail测试邮件内容'</span>, <span class="hljs-string">'1000263.jpg'</span>]<br><br>yag.send(<span class="hljs-string">'3552422607@qq.com'</span>, <span class="hljs-string">'this is from yagmailtest email.'</span>, content)<br></code></pre></td></tr></table></figure>
<h4 id="查看成功接收的邮件：-3">查看成功接收的邮件：</h4>
<p><img src= "/img/loading.gif" data-src="G:%5C%E5%9B%9B%E6%9C%9F%5Cpython%5Cpython%E6%96%87%E6%A1%A3%5C29.assets%5Cimage-20200512202333350.png" alt="image-20200512202333350"></p>
<h1>三、网络管理</h1>
<h2 id="1、列出活跃的主机">1、列出活跃的主机</h2>
<p><strong>在这一小节中，我们将会学习如何在shell脚本中调用ping命令得到网络上活跃的主机列表，随后，我们使用Python语言改造这个程序，以此支持并发的判断。</strong></p>
<h3 id="ping一下">ping一下</h3>
<p><img src= "/img/loading.gif" data-src="G:%5C%E5%9B%9B%E6%9C%9F%5Cpython%5Cpython%E6%96%87%E6%A1%A3%5C29.assets%5Cimage-20200513155336659.png" alt="image-20200513155336659"></p>
<h3 id="（1）创建测试的网络">（1）创建测试的网络</h3>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre class=" language-hljs txt"><code class="language-hljs txt">-bash-4.2# vim ips.txt <br># 本机ip<br>192.168.1.80   <br><br># 本机<br>127.0.0.1 <br><br># 不可达的地址<br>192.168.2.2<br></code></pre></td></tr></table></figure>
<h3 id="（2）创建shell脚本，批量测IP是否可用">（2）创建shell脚本，批量测IP是否可用</h3>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre class=" language-hljs shell">-bash-4.2# vim ping.sh <br><br><span class="hljs-meta">#</span><span class="bash"><code class="language-hljs shell">-bash-4.2# vim ping.sh <br><br><span class="hljs-meta">#</span><span class="bash">/usr/bin/bash</span><br>for ip in $(cat ips.txt)<br>        do<br>                if ping $ip -c 2 &>/dev/null<br>                then<br>                        echo "$ip 是活跃的。"<br>                else<br>                        echo "$ip 是不可达的。"<br>                fi<br>        done<br></code></pre></td></tr></table></figure>
<h4 id="执行结果如下：">执行结果如下：</h4>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre class=" language-hljs shell"><code class="language-hljs shell">-bash-4.2# sh ping.sh <br>192.168.1.80 是活跃的。<br>127.0.0.1 是活跃的。<br>192.168.2.2 是不可达的。<br></code></pre></td></tr></table></figure>
<p><img src= "/img/loading.gif" data-src="G:%5C%E5%9B%9B%E6%9C%9F%5Cpython%5Cpython%E6%96%87%E6%A1%A3%5C29.assets%5Cimage-20200513160742759.png" alt="image-20200513160742759"></p>
<h3 id="（3）线程模块">（3）线程模块</h3>
<p><strong>Python中使用线程有两种方式：函数或者用类来包装线程对象。</strong></p>
<p><strong>函数式：调用thread模块中的start_new_thread()函数来产生新线程。语法如下:</strong></p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre class=" language-hljs python"><code class="language-hljs python">thread.start_new_thread ( function, args[, kwargs] )<br></code></pre></td></tr></table></figure>
<h4 id="参数说明">参数说明:</h4>
<ul>
<li><strong>function - 线程函数。</strong></li>
<li><strong>args - 传递给线程函数的参数,他必须是个tuple类型。</strong></li>
<li><strong>kwargs - 可选参数。</strong></li>
</ul>
<p><strong>Python通过两个标准库thread和threading提供对线程的支持。thread提供了低级别的、原始的线程以及一个简单的锁。</strong></p>
<h4 id="threading-模块提供的其他方法：">threading 模块提供的其他方法：</h4>
<ul>
<li><strong>threading.currentThread(): 返回当前的线程变量。</strong></li>
<li><strong>threading.enumerate(): 返回一个包含正在运行的线程的list。正在运行指线程启动后、结束前，不包括启动前和终止后的线程。</strong></li>
<li><strong>threading.activeCount(): 返回正在运行的线程数量，与len(threading.enumerate())有相同的结果。</strong></li>
</ul>
<h4 id="除了使用方法外，线程模块同样提供了Thread类来处理线程，Thread类提供了以下方法"><strong>除了使用方法外，线程模块同样提供了Thread类来处理线程，Thread类提供了以下方法:</strong></h4>
<ul>
<li><strong>run():  用以表示线程活动的方法。</strong></li>
<li><strong>start(): 启动线程活动。</strong></li>
<li><strong>join([time]): 等待至线程中止。这阻塞调用线程直至线程的join() 方法被调用中止-正常退出或者抛出未处理的异常-或者是可选的超时发生。</strong></li>
<li><strong>isAlive(): 返回线程是否活动的。</strong></li>
<li><strong>getName(): 返回线程名。</strong></li>
<li><strong>setName(): 设置线程名。</strong></li>
</ul>
<h3 id="（4）创建python脚本，批量测IP是否可用">（4）创建python脚本，批量测IP是否可用</h3>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br></pre></td><td class="code"><pre class=" language-hljs python"><span class="hljs-comment">#!/usr/bin/python3</span><br><span class="hljs-comment"># encodig=utf-8</span><br><span class="hljs-keyword">import</span> os<br><span class="hljs-keyword">import</span> threading<br><br><br><span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">ping</span><span class="hljs-params">(ip)</span>:</span><br>    <span class="hljs-string">'''测试网卡的连通性'''</span><br>    res = os.system(<span class="hljs-string">u'ping -c 2 '</span>+ip)<br>    <span class="hljs-keyword">if</span> res == <span class="hljs-number">0</span>:<br>        print(<span class="hljs-string">'网卡正常！'</span>)<br>    <span class="hljs-keyword">else</span>:<br>        print(<span class="hljs-string">'网卡异常！'</span>)<br>    <span class="hljs-keyword">return</span> res<br><br><br><span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">main</span><span class="hljs-params">()</span>:</span><br>    <span class="hljs-keyword">with</span> open(<span class="hljs-string">'ips.txt'</span>) <span class="hljs-keyword">as</span> f:<br>        <span class="hljs-comment"># 使用多线程</span><br>        threads = []<br>        lines = f.readlines()<br>        <span class="hljs-keyword">for</span> line <span class="hljs-keyword">in</span> lines:<br>            thread = threading.Thread(target=ping, args=(line,))<br>            thread.start()<br>            threads.append(thread)<br>        <span class="hljs-keyword">for</span> thr <span class="hljs-keyword">in</span> threads:<br>            thr.join()<br><br><br><span class="hljs-keyword">if</span> __name__ == <span class="hljs-string"><code class="language-hljs python"><span class="hljs-comment">#!/usr/bin/python3</span><br><span class="hljs-comment"># encodig=utf-8</span><br><span class="hljs-keyword">import</span> os<br><span class="hljs-keyword">import</span> threading<br><br><br><span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">ping</span><span class="hljs-params">(ip)</span>:</span><br>    <span class="hljs-string">'''测试网卡的连通性'''</span><br>    res = os.system(<span class="hljs-string">u'ping -c 2 '</span>+ip)<br>    <span class="hljs-keyword">if</span> res == <span class="hljs-number">0</span>:<br>        print(<span class="hljs-string">'网卡正常！'</span>)<br>    <span class="hljs-keyword">else</span>:<br>        print(<span class="hljs-string">'网卡异常！'</span>)<br>    <span class="hljs-keyword">return</span> res<br><br><br><span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">main</span><span class="hljs-params">()</span>:</span><br>    <span class="hljs-keyword">with</span> open(<span class="hljs-string">'ips.txt'</span>) <span class="hljs-keyword">as</span> f:<br>        <span class="hljs-comment"># 使用多线程</span><br>        threads = []<br>        lines = f.readlines()<br>        <span class="hljs-keyword">for</span> line <span class="hljs-keyword">in</span> lines:<br>            thread = threading.Thread(target=ping, args=(line,))<br>            thread.start()<br>            threads.append(thread)<br>        <span class="hljs-keyword">for</span> thr <span class="hljs-keyword">in</span> threads:<br>            thr.join()<br><br><br><span class="hljs-keyword">if</span> __name__ == <span class="hljs-string">'__main__'</span>:<br>    main()<br></code></pre></td></tr></table></figure>
<h4 id="执行结果如下：-2">执行结果如下：</h4>
<p><img src= "/img/loading.gif" data-src="G:%5C%E5%9B%9B%E6%9C%9F%5Cpython%5Cpython%E6%96%87%E6%A1%A3%5C29.assets%5Cimage-20200513160559534.png" alt="image-20200513160559534"></p>
<h2 id="2、端口扫描">2、端口扫描</h2>
<p><strong>在Linux下，可以便用ping命令要判断一台主机是否可达。而判断一个端口是否打开可以使用telnet命令。 我们可以模仿前面小节中并行ping的例子，在Python代码中调用telnet命令判断一个端口是否打开。但是telnet命令存在一个问题，当我们telnet一个不可达的端口时，telnet需要很久才 能够超时返回，井且telnet命令没有参数控制超时时间。此外， 如果Python标准库中有相应的模块，应该尽可能地使用Python的标准库，而不是在Python代码中执行Linux命令。这一方面能够增加代码的可读性、可维护性.另一方面也能够保证程序跨平台运行。</strong></p>
<p><strong>为了使用Python编写端口扫描器，我们需要简单了解socket模块。socket模块为操作系统的socket连接提供了一个Python接口，有了socket模块，我们可以完成任何使用socket的任务。</strong></p>
<h3 id="（1）安装telnet">（1）安装telnet</h3>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre class=" language-hljs shell"><code class="language-hljs shell">-bash-4.2# yum -y install telnet<br></code></pre></td></tr></table></figure>
<h4 id="测试一下">测试一下</h4>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre class=" language-hljs shell"><code class="language-hljs shell">-bash-4.2# telnet 192.168.1.80 22  #测试连接，本机的22端口<br>Trying 192.168.1.80...<br>Connected to 192.168.1.80.<br>Escape character is '^]'.<br>SSH-2.0-OpenSSH_6.6.1<br><br>exit #退出连接<br></code></pre></td></tr></table></figure>
<h3 id="（2）socket模块">（2）socket模块</h3>
<p><strong>socket模块提供了一个工厂函数socket, socket函数会返向一个socket对象。我们可以给socket函数传递参数，以此创建不同网络协议和网络类塑的socket对象。默认情况下，socket函数会返回一个使用TCP协议的socket对象。</strong></p>
<h4 id="什么是-Socket">什么是 Socket?</h4>
<p><strong>Socket又称&quot;套接字&quot;，应用程序通常通过&quot;套接字&quot;向网络发出请求或者应答网络请求，使主机间或者一台计算机上的进程间可以通讯。</strong></p>
<h4 id="socket-函数">socket()函数</h4>
<p><strong>Python 中，我们用 socket（）函数来创建套接字，语法格式如下：</strong></p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre class=" language-hljs python"><code class="language-hljs python">socket.socket([family[, type[, proto]]])<br></code></pre></td></tr></table></figure>
<h3 id="参数">参数</h3>
<ul>
<li><strong>family: 套接字家族可以使AF_UNIX或者AF_INET</strong></li>
<li><strong>type: 套接字类型可以根据是面向连接的还是非连接分为<code>SOCK_STREAM</code>或<code>SOCK_DGRAM</code></strong></li>
<li><strong>protocol: 一般不填默认为0.</strong></li>
</ul>
<h4 id="（1）如下所示">（1）如下所示:</h4>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre class=" language-hljs python">-bash<span class="hljs-number">-4.2</span><span class="hljs-comment"># ipython</span><br>Python <span class="hljs-number">3.8</span><span class="hljs-number">.1</span> (default, Mar  <span class="hljs-number">9</span> <span class="hljs-number">2020</span>, <span class="hljs-number">12</span>:<span class="hljs-number">35</span>:<span class="hljs-number">12</span>) <br>Type <span class="hljs-string">'copyright'</span>, <span class="hljs-string">'credits'</span> <span class="hljs-keyword">or</span> <span class="hljs-string">'license'</span> <span class="hljs-keyword">for</span> more information<br>IPython <span class="hljs-number">7.13</span><span class="hljs-number">.0</span> -- An enhanced Interactive Python. Type <span class="hljs-string">'?'</span> <span class="hljs-keyword">for</span> help.<br><br>In [<span class="hljs-number">1</span>]: <span class="hljs-keyword">import</span> socket                                            <br><br>In [<span class="hljs-number">2</span>]: s = socket.socket()                                      <br><br>In [<span class="hljs-number">4</span>]: s.connect((<span class="hljs-string">'47.100.98.242'</span>,<span class="hljs-number">80</span>))                          <br><br>In [<span class="hljs-number">6</span>]: s.send(<span class="hljs-string">"GET/HTTP/1.0"</span>.encode())                          <br>Out[<span class="hljs-number">6</span>]: <span class="hljs-number">12</span><br><br>In [<span class="hljs-number">7</span>]: print(s.recv(<span class="hljs-number">200</span>))                                       <br><span class="hljs-string">b''</span><br><br>In [<span class="hljs-number">8</span>]: s.close                                                  <br>Out[<span class="hljs-number">8</span>]: &lt;bound method socket.close of &lt;socket.socket fd=<span class="hljs-number">13</span>, family=AddressFamily.AF_INET, type=SocketKind.SOCK_STREAM, proto=<span class="hljs-number">0</span>, laddr=(<span class="hljs-string">'192.168.1.80'</span>, <span class="hljs-number">42550</span>), raddr=(<span class="hljs-string">'47.100.98.242'</span>, <span class="hljs-number"><code class="language-hljs python">-bash<span class="hljs-number">-4.2</span><span class="hljs-comment"># ipython</span><br>Python <span class="hljs-number">3.8</span><span class="hljs-number">.1</span> (default, Mar  <span class="hljs-number">9</span> <span class="hljs-number">2020</span>, <span class="hljs-number">12</span>:<span class="hljs-number">35</span>:<span class="hljs-number">12</span>) <br>Type <span class="hljs-string">'copyright'</span>, <span class="hljs-string">'credits'</span> <span class="hljs-keyword">or</span> <span class="hljs-string">'license'</span> <span class="hljs-keyword">for</span> more information<br>IPython <span class="hljs-number">7.13</span><span class="hljs-number">.0</span> -- An enhanced Interactive Python. Type <span class="hljs-string">'?'</span> <span class="hljs-keyword">for</span> help.<br><br>In [<span class="hljs-number">1</span>]: <span class="hljs-keyword">import</span> socket                                            <br><br>In [<span class="hljs-number">2</span>]: s = socket.socket()                                      <br><br>In [<span class="hljs-number">4</span>]: s.connect((<span class="hljs-string">'47.100.98.242'</span>,<span class="hljs-number">80</span>))                          <br><br>In [<span class="hljs-number">6</span>]: s.send(<span class="hljs-string">"GET/HTTP/1.0"</span>.encode())                          <br>Out[<span class="hljs-number">6</span>]: <span class="hljs-number">12</span><br><br>In [<span class="hljs-number">7</span>]: print(s.recv(<span class="hljs-number">200</span>))                                       <br><span class="hljs-string">b''</span><br><br>In [<span class="hljs-number">8</span>]: s.close                                                  <br>Out[<span class="hljs-number">8</span>]: &lt;bound method socket.close of &lt;socket.socket fd=<span class="hljs-number">13</span>, family=AddressFamily.AF_INET, type=SocketKind.SOCK_STREAM, proto=<span class="hljs-number">0</span>, laddr=(<span class="hljs-string">'192.168.1.80'</span>, <span class="hljs-number">42550</span>), raddr=(<span class="hljs-string">'47.100.98.242'</span>, <span class="hljs-number">80</span>)>><br></code></pre></td></tr></table></figure>
<p><strong>在这个例子中, socketI厂函数以默认参数AF. INET和SOCK STREAM创建了一个名为s的socket对象,该对象可以在进程间进行TCP通信。创建完对象以后，我们使用connect函数连接到远程服务器的80端口，并发送一个HTTP请求到远程服务器，发送完毕之后，接收服务器响应的前200个字节。最后，调用socket对象的close方法关闭连接。</strong></p>
<p><strong>在这个例子中,我们用到了socket工厂函数、socket的connect方法、 send方法、recv 方法和close方法,这也是socket中最常使用的一些方法。</strong></p>
<h4 id="（2）如下所示">（2）如下所示</h4>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre class=" language-hljs python"><span class="hljs-keyword">import</span> socket<br><br>s = socket. socket()<br>s. connect(( <span class="hljs-string">'47.100.98.242'</span> ,<span class="hljs-number">80</span>))<br>s.send( <span class="hljs-string">' http:/ /www.baidu.com/'</span>.encode())<br>print(s.recv(<span class="hljs-number"><code class="language-hljs python"><span class="hljs-keyword">import</span> socket<br><br>s = socket. socket()<br>s. connect(( <span class="hljs-string">'47.100.98.242'</span> ,<span class="hljs-number">80</span>))<br>s.send( <span class="hljs-string">' http:/ /www.baidu.com/'</span>.encode())<br>print(s.recv(<span class="hljs-number">10</span>))<br>s.close()<br></code></pre></td></tr></table></figure>
<h5 id="执行结果如下">执行结果如下</h5>
<blockquote>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre class=" language-hljs python"><span class="hljs-string"><code class="language-hljs python"><span class="hljs-string">b'HTTP/1.1 4'</span><br></code></pre></td></tr></table></figure>
</blockquote>
<h3 id="（3）接下来，我们就看一下如何使用简单的socket接口编写一个端口扫描器。-如下所示">（3）接下来，我们就看一下如何使用简单的socket接口编写一个端口扫描器。 如下所示:</h3>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre class=" language-hljs python"><span class="hljs-comment">#!/usr/bin/python3</span><br><span class="hljs-comment"># encoding=utf-8</span><br><span class="hljs-keyword">from</span> socket <span class="hljs-keyword">import</span> *<br><br><br><span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">conn_scan</span><span class="hljs-params">(host, port)</span>:</span><br>    conn = socket(AF_INET, SOCK_STREAM)<br>    <span class="hljs-keyword">try</span>:<br>        conn.connect((host, port))<br>        print(host, port, <span class="hljs-string">'已连接'</span>)<br>    <span class="hljs-keyword">except</span> Exception <span class="hljs-keyword">as</span> e:<br>        print(host, port, <span class="hljs-string">'连接失败'</span>)<br>    <span class="hljs-keyword">finally</span>:<br>        conn.close()<br><br><br><span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">main</span><span class="hljs-params">()</span>:</span><br>    host = <span class="hljs-string">'47.100.98.242'</span><br>    <span class="hljs-keyword">for</span> port <span class="hljs-keyword">in</span> range(<span class="hljs-number">20</span>, <span class="hljs-number">5000</span>):<br>        conn_scan(host, port)<br><br><br><span class="hljs-keyword">if</span> __name__ == <span class="hljs-string"><code class="language-hljs python"><span class="hljs-comment">#!/usr/bin/python3</span><br><span class="hljs-comment"># encoding=utf-8</span><br><span class="hljs-keyword">from</span> socket <span class="hljs-keyword">import</span> *<br><br><br><span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">conn_scan</span><span class="hljs-params">(host, port)</span>:</span><br>    conn = socket(AF_INET, SOCK_STREAM)<br>    <span class="hljs-keyword">try</span>:<br>        conn.connect((host, port))<br>        print(host, port, <span class="hljs-string">'已连接'</span>)<br>    <span class="hljs-keyword">except</span> Exception <span class="hljs-keyword">as</span> e:<br>        print(host, port, <span class="hljs-string">'连接失败'</span>)<br>    <span class="hljs-keyword">finally</span>:<br>        conn.close()<br><br><br><span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">main</span><span class="hljs-params">()</span>:</span><br>    host = <span class="hljs-string">'47.100.98.242'</span><br>    <span class="hljs-keyword">for</span> port <span class="hljs-keyword">in</span> range(<span class="hljs-number">20</span>, <span class="hljs-number">5000</span>):<br>        conn_scan(host, port)<br><br><br><span class="hljs-keyword">if</span> __name__ == <span class="hljs-string">'__main__'</span>:<br>    main()<br></code></pre></td></tr></table></figure>
<h5 id="执行结果如下：-3">执行结果如下：</h5>
<blockquote>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre class=" language-hljs python"><span class="hljs-number">47.100</span><span class="hljs-number">.98</span><span class="hljs-number">.242</span> <span class="hljs-number">20</span> 连接失败<br><span class="hljs-number">47.100</span><span class="hljs-number">.98</span><span class="hljs-number">.242</span> <span class="hljs-number">21</span> 已连接<br><span class="hljs-number">47.100</span><span class="hljs-number">.98</span><span class="hljs-number">.242</span> <span class="hljs-number">22</span> 已连接<br><span class="hljs-number">47.100</span><span class="hljs-number">.98</span><span class="hljs-number">.242</span> <span class="hljs-number">23</span> 连接失败<br><span class="hljs-number">47.100</span><span class="hljs-number">.98</span><span class="hljs-number">.242</span> <span class="hljs-number"><code class="language-hljs python"><span class="hljs-number">47.100</span><span class="hljs-number">.98</span><span class="hljs-number">.242</span> <span class="hljs-number">20</span> 连接失败<br><span class="hljs-number">47.100</span><span class="hljs-number">.98</span><span class="hljs-number">.242</span> <span class="hljs-number">21</span> 已连接<br><span class="hljs-number">47.100</span><span class="hljs-number">.98</span><span class="hljs-number">.242</span> <span class="hljs-number">22</span> 已连接<br><span class="hljs-number">47.100</span><span class="hljs-number">.98</span><span class="hljs-number">.242</span> <span class="hljs-number">23</span> 连接失败<br><span class="hljs-number">47.100</span><span class="hljs-number">.98</span><span class="hljs-number">.242</span> <span class="hljs-number">24</span> 连接失败<br></code></pre></td></tr></table></figure>
</blockquote>
<h4 id="较快的：">较快的：</h4>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre class=" language-hljs python"><span class="hljs-comment">#encoding=utf-8</span><br><span class="hljs-keyword">import</span> telnetlib<br><br><br><span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">conn_scan</span><span class="hljs-params">(host, port)</span>:</span><br>    t = telnetlib.Telnet()<br>    <span class="hljs-keyword">try</span>:<br>        t.open(host, port, timeout=<span class="hljs-number">1</span>)<br>        print(host, port, <span class="hljs-string">'已连接'</span>)<br>    <span class="hljs-keyword">except</span> Exception <span class="hljs-keyword">as</span> e:<br>        print(host, port, <span class="hljs-string">'连接失败'</span>)<br>    <span class="hljs-keyword">finally</span>:<br>        t.close()<br><br><br><span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">main</span><span class="hljs-params">()</span>:</span><br>    host = <span class="hljs-string">'47.100.98.242'</span><br>    <span class="hljs-keyword">for</span> port <span class="hljs-keyword">in</span> range(<span class="hljs-number">20</span>, <span class="hljs-number">26</span>):<br>        conn_scan(host, port)<br><br><br><span class="hljs-keyword">if</span> __name__ == <span class="hljs-string"><code class="language-hljs python"><span class="hljs-comment">#encoding=utf-8</span><br><span class="hljs-keyword">import</span> telnetlib<br><br><br><span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">conn_scan</span><span class="hljs-params">(host, port)</span>:</span><br>    t = telnetlib.Telnet()<br>    <span class="hljs-keyword">try</span>:<br>        t.open(host, port, timeout=<span class="hljs-number">1</span>)<br>        print(host, port, <span class="hljs-string">'已连接'</span>)<br>    <span class="hljs-keyword">except</span> Exception <span class="hljs-keyword">as</span> e:<br>        print(host, port, <span class="hljs-string">'连接失败'</span>)<br>    <span class="hljs-keyword">finally</span>:<br>        t.close()<br><br><br><span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">main</span><span class="hljs-params">()</span>:</span><br>    host = <span class="hljs-string">'47.100.98.242'</span><br>    <span class="hljs-keyword">for</span> port <span class="hljs-keyword">in</span> range(<span class="hljs-number">20</span>, <span class="hljs-number">26</span>):<br>        conn_scan(host, port)<br><br><br><span class="hljs-keyword">if</span> __name__ == <span class="hljs-string">'__main__'</span>:<br>    main()<br></code></pre></td></tr></table></figure>
<h5 id="输出结果如下：-3">输出结果如下：</h5>
<blockquote>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre class=" language-hljs python"><span class="hljs-number">47.100</span><span class="hljs-number">.98</span><span class="hljs-number">.242</span> <span class="hljs-number">20</span> 连接失败<br><span class="hljs-number">47.100</span><span class="hljs-number">.98</span><span class="hljs-number">.242</span> <span class="hljs-number">21</span> 已连接<br><span class="hljs-number">47.100</span><span class="hljs-number">.98</span><span class="hljs-number">.242</span> <span class="hljs-number">22</span> 已连接<br><span class="hljs-number">47.100</span><span class="hljs-number">.98</span><span class="hljs-number">.242</span> <span class="hljs-number"><code class="language-hljs python"><span class="hljs-number">47.100</span><span class="hljs-number">.98</span><span class="hljs-number">.242</span> <span class="hljs-number">20</span> 连接失败<br><span class="hljs-number">47.100</span><span class="hljs-number">.98</span><span class="hljs-number">.242</span> <span class="hljs-number">21</span> 已连接<br><span class="hljs-number">47.100</span><span class="hljs-number">.98</span><span class="hljs-number">.242</span> <span class="hljs-number">22</span> 已连接<br><span class="hljs-number">47.100</span><span class="hljs-number">.98</span><span class="hljs-number">.242</span> <span class="hljs-number">23</span> 连接失败<br></code></pre></td></tr></table></figure>
</blockquote>
</div><div class="post-copyright"><div class="post-copyright__author"><span class="post-copyright-meta">文章作者: </span><span class="post-copyright-info"><a href="mailto:undefined">Wu Shao Dong</a></span></div><div class="post-copyright__type"><span class="post-copyright-meta">文章链接: </span><span class="post-copyright-info"><a href="/wsdlxgp.top/2019/09/14/74%20python%E9%82%AE%E4%BB%B6%E5%92%8C%E7%BD%91%E7%BB%9C%E7%9A%84%E7%AE%80%E5%8D%95%E4%BD%BF%E7%94%A8/">wsdlxgp.top/2019/09/14/74%20python%E9%82%AE%E4%BB%B6%E5%92%8C%E7%BD%91%E7%BB%9C%E7%9A%84%E7%AE%80%E5%8D%95%E4%BD%BF%E7%94%A8/</a></span></div><div class="post-copyright__notice"><span class="post-copyright-meta">版权声明: </span><span class="post-copyright-info">本博客所有文章除特别声明外，均采用 <a href="https://creativecommons.org/licenses/by-nc-sa/4.0/" target="_blank">CC BY-NC-SA 4.0</a> 许可协议。转载请注明来自 <a href="wsdlxgp.top" target="_blank">Xgp & Blog</a>！</span></div></div><div class="tag_share"><div class="post-meta__tag-list"><a class="post-meta__tags" href="/tags/nfs/">nfs</a><a class="post-meta__tags" href="/tags/deployment/">deployment</a><a class="post-meta__tags" href="/tags/pv/">pv</a><a class="post-meta__tags" href="/tags/pvc/">pvc</a><a class="post-meta__tags" href="/tags/Storage-Class/">Storage Class</a><a class="post-meta__tags" href="/tags/dashboard/">dashboard</a><a class="post-meta__tags" href="/tags/helm/">helm</a></div><div class="post_share"><div class="social-share" data-image="https://i.loli.net/2020/05/01/gkihqEjXxJ5UZ1C.jpg" data-sites="facebook,twitter,wechat,weibo,qq"></div><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/social-share.js/dist/css/share.min.css"/><script src="https://cdn.jsdelivr.net/npm/social-share.js/dist/js/social-share.min.js"></script></div></div><nav class="pagination-post" id="pagination"><div class="prev-post pull-left"><a href="/2019/09/14/75%20python%E7%9A%84%E7%BD%91%E7%BB%9C%EF%BC%88nmap%EF%BC%8CIPy%EF%BC%8Cdnspython%EF%BC%89/"><img class="prev-cover" data-src="https://gitee.com/xgpqq/tuchuang/raw/master/img/qweq75p.jpg" onerror="onerror=null;src='/img/404.jpg'"><div class="pagination-info"><div class="label">上一篇</div><div class="prev_info">python的网络</div></div></a></div><div class="next-post pull-right"><a href="/2019/09/14/73%20python%E7%9A%84%E6%96%87%E4%BB%B6%E5%A4%84%E7%90%86/"><img class="next-cover" data-src="https://gitee.com/xgpqq/tuchuang/raw/master/img/qweq73p.jpg" onerror="onerror=null;src='/img/404.jpg'"><div class="pagination-info"><div class="label">下一篇</div><div class="next_info">python的文件处理</div></div></a></div></nav><div class="relatedPosts"><div class="relatedPosts_headline"><i class="fas fa-thumbs-up fa-fw"></i><span> 相关推荐</span></div><div class="relatedPosts_list"><div class="relatedPosts_item"><a href="/2019/09/14/59 数据可视化/" title="python数据可视化"><img class="relatedPosts_cover" data-src="https://gitee.com/xgpqq/tuchuang/raw/master/img/qweq59p.jpg"><div class="relatedPosts_main is-center"><div class="relatedPosts_date"><i class="far fa-calendar-alt fa-fw"></i> 2019-09-14</div><div class="relatedPosts_title">python数据可视化</div></div></a></div><div class="relatedPosts_item"><a href="/2019/09/14/57 正则表达式/" title="python的正则表达式"><img class="relatedPosts_cover" data-src="https://gitee.com/xgpqq/tuchuang/raw/master/img/qweq57p.jpg"><div class="relatedPosts_main is-center"><div class="relatedPosts_date"><i class="far fa-calendar-alt fa-fw"></i> 2019-09-14</div><div class="relatedPosts_title">python的正则表达式</div></div></a></div><div class="relatedPosts_item"><a href="/2019/09/14/58 python文本文件的（读、写、追加）/" title="python文本文件的（读、写、追加）"><img class="relatedPosts_cover" data-src="https://gitee.com/xgpqq/tuchuang/raw/master/img/qweq58p.jpg"><div class="relatedPosts_main is-center"><div class="relatedPosts_date"><i class="far fa-calendar-alt fa-fw"></i> 2019-09-14</div><div class="relatedPosts_title">python文本文件的（读、写、追加）</div></div></a></div><div class="relatedPosts_item"><a href="/2019/09/14/60 Python数据可视化之Pygal图表类型/" title="Python数据可视化之Pygal图表类型"><img class="relatedPosts_cover" data-src="https://gitee.com/xgpqq/tuchuang/raw/master/img/qweq60p.jpg"><div class="relatedPosts_main is-center"><div class="relatedPosts_date"><i class="far fa-calendar-alt fa-fw"></i> 2019-09-14</div><div class="relatedPosts_title">Python数据可视化之Pygal图表类型</div></div></a></div><div class="relatedPosts_item"><a href="/2019/09/14/61 初识Django/" title="初识Django和宝塔面板"><img class="relatedPosts_cover" data-src="https://gitee.com/xgpqq/tuchuang/raw/master/img/qweq61p.jpg"><div class="relatedPosts_main is-center"><div class="relatedPosts_date"><i class="far fa-calendar-alt fa-fw"></i> 2019-09-14</div><div class="relatedPosts_title">初识Django和宝塔面板</div></div></a></div><div class="relatedPosts_item"><a href="/2019/09/14/62 windows10安装 mysql数据库和Navicat for MySQL(MySQL管理工具)/" title="windows10安装 mysql数据库和Navicat for MySQL(MySQL管理工具)"><img class="relatedPosts_cover" data-src="https://gitee.com/xgpqq/tuchuang/raw/master/img/qweq62p.jpg"><div class="relatedPosts_main is-center"><div class="relatedPosts_date"><i class="far fa-calendar-alt fa-fw"></i> 2019-09-14</div><div class="relatedPosts_title">windows10安装 mysql数据库和Navicat for MySQL(MySQL管理工具)</div></div></a></div></div></div></article></main><footer id="footer" data-type="color"><div id="footer-wrap"><div class="copyright">&copy;2020 By Wu Shao Dong</div><div class="framework-info"><span>驱动 </span><a href="https://hexo.io" target="_blank" rel="noopener"><span>Hexo</span></a><span class="footer-separator">|</span><span>主题 </span><a href="https://github.com/jerryc127/hexo-theme-butterfly" target="_blank" rel="noopener"><span>Butterfly</span></a></div></div></footer></div><section class="rightside" id="rightside"><div id="rightside-config-hide"><button id="readmode" title="阅读模式"><i class="fas fa-book-open"></i></button><button id="font_plus" title="放大字体"><i class="fas fa-plus"></i></button><button id="font_minus" title="缩小字体"><i class="fas fa-minus"></i></button><button class="translate_chn_to_cht" id="translateLink" title="简繁转换">繁</button><button id="darkmode" title="浅色和深色模式转换"><i class="fas fa-adjust"></i></button></div><div id="rightside-config-show"><button id="rightside_config" title="设置"><i class="fas fa-cog"></i></button><button class="close" id="mobile-toc-button" title="目录"><i class="fas fa-list-ul"></i></button><button id="go-up" title="回到顶部"><i class="fas fa-arrow-up"></i></button></div></section><script src="https://cdn.jsdelivr.net/npm/jquery@latest/dist/jquery.min.js"></script><script src="/js/utils.js"></script><script src="/js/main.js"></script><script src="/js/tw_cn.js"></script><script src="https://cdn.jsdelivr.net/npm/@fancyapps/fancybox@latest/dist/jquery.fancybox.min.js"></script><script async src="//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script><script src="https://cdn.jsdelivr.net/npm/instant.page/instantpage.min.js" type="module" defer></script><script src="https://cdn.jsdelivr.net/npm/vanilla-lazyload/dist/lazyload.iife.min.js" async></script><script src="/live2dw/lib/L2Dwidget.min.js?094cbace49a39548bed64abff5988b05"></script><script>L2Dwidget.init({"log":false,"pluginJsPath":"lib/","pluginModelPath":"assets/","pluginRootPath":"live2dw/","tagMode":false});</script></body></html>