<!DOCTYPE html><html lang="zh-CN" data-theme="light"><head><meta charset="UTF-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width,initial-scale=1"><title>PyCharm实现（Django的模型、表单、管理工具、引入静态文件） | Xgp &amp; Blog</title><meta name="description" content="1234567镜像列表http:&#x2F;&#x2F;mirrors.aliyun.com&#x2F;pypi&#x2F;simple&#x2F; &#x2F;&#x2F;阿里https:&#x2F;&#x2F;pypi.tuna.tsinghua.edu.cn&#x2F;simple&#x2F; &#x2F;&#x2F;清华http:&#x2F;&#x2F;pypi.douban.com&#x2F; &#x2F;&#x2F;豆瓣http:&#x2F;&#x2F;pypi.hustunique.com&#x2F; &#x2F;&#x2F;华中理工大学http:&#x2F;&#x2F;pypi.sdutlinux.org&#x2F; &#x2F;&#x2F;山东理工大学h"><meta name="keywords" content="nfs,deployment,pv,pvc,Storage Class,dashboard,helm"><meta name="author" content="Wu Shao Dong"><meta name="copyright" content="Wu Shao Dong"><meta name="format-detection" content="telephone=no"><link rel="shortcut icon" href="/img/favicon.png"><link rel="canonical" href="wsdlxgp.top/2019/09/14/63%20PyCharm%E5%AE%9E%E7%8E%B0%EF%BC%88Django%E7%9A%84%E6%A8%A1%E5%9E%8B%E3%80%81%E8%A1%A8%E5%8D%95%E3%80%81%E7%AE%A1%E7%90%86%E5%B7%A5%E5%85%B7%E3%80%81%E5%BC%95%E5%85%A5%E9%9D%99%E6%80%81%E6%96%87%E4%BB%B6%EF%BC%89/"><meta http-equiv="Cache-Control" content="no-transform"><meta http-equiv="Cache-Control" content="no-siteapp"><link rel="preconnect" href="//cdn.jsdelivr.net"/><link rel="preconnect" href="//fonts.googleapis.com" crossorigin="crossorigin"/><link rel="preconnect" href="//busuanzi.ibruce.info"/><meta property="og:type" content="article"><meta property="og:title" content="PyCharm实现（Django的模型、表单、管理工具、引入静态文件）"><meta property="og:url" content="wsdlxgp.top/2019/09/14/63%20PyCharm%E5%AE%9E%E7%8E%B0%EF%BC%88Django%E7%9A%84%E6%A8%A1%E5%9E%8B%E3%80%81%E8%A1%A8%E5%8D%95%E3%80%81%E7%AE%A1%E7%90%86%E5%B7%A5%E5%85%B7%E3%80%81%E5%BC%95%E5%85%A5%E9%9D%99%E6%80%81%E6%96%87%E4%BB%B6%EF%BC%89/"><meta property="og:site_name" content="Xgp &amp; Blog"><meta property="og:description" content="1234567镜像列表http:&#x2F;&#x2F;mirrors.aliyun.com&#x2F;pypi&#x2F;simple&#x2F; &#x2F;&#x2F;阿里https:&#x2F;&#x2F;pypi.tuna.tsinghua.edu.cn&#x2F;simple&#x2F; &#x2F;&#x2F;清华http:&#x2F;&#x2F;pypi.douban.com&#x2F; &#x2F;&#x2F;豆瓣http:&#x2F;&#x2F;pypi.hustunique.com&#x2F; &#x2F;&#x2F;华中理工大学http:&#x2F;&#x2F;pypi.sdutlinux.org&#x2F; &#x2F;&#x2F;山东理工大学h"><meta property="og:image" content="https://gitee.com/xgpqq/tuchuang/raw/master/img/qweq63p.jpg"><meta property="article:published_time" content="2019-09-13T16:18:00.000Z"><meta property="article:modified_time" content="2020-06-30T06:57:26.947Z"><meta name="twitter:card" content="summary"><script>var activateDarkMode = function () {
  document.documentElement.setAttribute('data-theme', 'dark')
  if (document.querySelector('meta[name="theme-color"]') !== null) {
    document.querySelector('meta[name="theme-color"]').setAttribute('content', '#000')
  }
}
var activateLightMode = function () {
  document.documentElement.setAttribute('data-theme', 'light')
  if (document.querySelector('meta[name="theme-color"]') !== null) {
    document.querySelector('meta[name="theme-color"]').setAttribute('content', '#fff')
  }
}

var getCookies = function (name) {
  const value = `; ${document.cookie}`
  const parts = value.split(`; ${name}=`)
  if (parts.length === 2) return parts.pop().split(';').shift()
}

var autoChangeMode = 'false'
var t = getCookies('theme')
if (autoChangeMode === '1') {
  var isDarkMode = window.matchMedia('(prefers-color-scheme: dark)').matches
  var isLightMode = window.matchMedia('(prefers-color-scheme: light)').matches
  var isNotSpecified = window.matchMedia('(prefers-color-scheme: no-preference)').matches
  var hasNoSupport = !isDarkMode && !isLightMode && !isNotSpecified

  if (t === undefined) {
    if (isLightMode) activateLightMode()
    else if (isDarkMode) activateDarkMode()
    else if (isNotSpecified || hasNoSupport) {
      console.log('You specified no preference for a color scheme or your browser does not support it. I Schedule dark mode during night time.')
      var now = new Date()
      var hour = now.getHours()
      var isNight = hour <= 6 || hour >= 18
      isNight ? activateDarkMode() : activateLightMode()
    }
    window.matchMedia('(prefers-color-scheme: dark)').addListener(function (e) {
      if (Cookies.get('theme') === undefined) {
        e.matches ? activateDarkMode() : activateLightMode()
      }
    })
  } else if (t === 'light') activateLightMode()
  else activateDarkMode()
} else if (autoChangeMode === '2') {
  now = new Date()
  hour = now.getHours()
  isNight = hour <= 6 || hour >= 18
  if (t === undefined) isNight ? activateDarkMode() : activateLightMode()
  else if (t === 'light') activateLightMode()
  else activateDarkMode()
} else {
  if (t === 'dark') activateDarkMode()
  else if (t === 'light') activateLightMode()
}</script><link rel="stylesheet" href="/css/index.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free/css/all.min.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fancyapps/fancybox@latest/dist/jquery.fancybox.min.css"><link rel="prev" title="Python3+Django3开发简单的人员管理系统" href="/wsdlxgp.top/2019/09/14/64%20Python3+Django3%E5%BC%80%E5%8F%91%E7%AE%80%E5%8D%95%E7%9A%84%E4%BA%BA%E5%91%98%E7%AE%A1%E7%90%86%E7%B3%BB%E7%BB%9F/"><link rel="next" title="windows10安装 mysql数据库和Navicat for MySQL(MySQL管理工具)" href="/wsdlxgp.top/2019/09/14/62%20windows10%E5%AE%89%E8%A3%85%20mysql%E6%95%B0%E6%8D%AE%E5%BA%93%E5%92%8CNavicat%20for%20MySQL(MySQL%E7%AE%A1%E7%90%86%E5%B7%A5%E5%85%B7)/"><link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Titillium+Web&amp;display=swap"><script>var GLOBAL_CONFIG = { 
  root: '/',
  algolia: undefined,
  localSearch: undefined,
  translate: {"defaultEncoding":2,"translateDelay":0,"msgToTraditionalChinese":"繁","msgToSimplifiedChinese":"簡"},
  copy: {
    success: '复制成功',
    error: '复制错误',
    noSupport: '浏览器不支持'
  },
  bookmark: {
    message_prev: '按',
    message_next: '键将本页加入书签'
  },
  runtime_unit: '天',
  runtime: false,
  copyright: undefined,
  ClickShowText: undefined,
  medium_zoom: false,
  fancybox: true,
  Snackbar: undefined,
  justifiedGallery: {
    js: 'https://cdn.jsdelivr.net/npm/justifiedGallery/dist/js/jquery.justifiedGallery.min.js',
    css: 'https://cdn.jsdelivr.net/npm/justifiedGallery/dist/css/justifiedGallery.min.css'
  },
  baiduPush: false,
  highlightCopy: true,
  highlightLang: true,
  isPhotoFigcaption: false,
  islazyload: true,
  isanchor: false    
}</script><script>var GLOBAL_CONFIG_SITE = { 
  isPost: true,
  isHome: false,
  isHighlightShrink: false,
  isSidebar: true
  }</script><noscript><style>
#nav {
  opacity: 1
}
.justified-gallery img{
  opacity: 1
}
</style></noscript><meta name="generator" content="Hexo 4.2.0"><link rel="alternate" href="/atom.xml" title="Xgp & Blog" type="application/atom+xml">
<link rel="stylesheet" href="/css/prism.css" type="text/css"></head><body><div id="mobile-sidebar"><div id="menu_mask"></div><div id="mobile-sidebar-menus"><div class="mobile_author_icon"><img class="avatar-img" src="/img/avatar.png" onerror="onerror=null;src='/img/friend_404.gif'" alt="avatar"/></div><div class="mobile_post_data"><div class="mobile_data_item is-center"><div class="mobile_data_link"><a href="/archives/"><div class="headline">文章</div><div class="length_num">132</div></a></div></div><div class="mobile_data_item is-center">      <div class="mobile_data_link"><a href="/tags/"><div class="headline">标签</div><div class="length_num">76</div></a></div></div><div class="mobile_data_item is-center">     <div class="mobile_data_link"><a href="/categories/"><div class="headline">分类</div><div class="length_num">4</div></a></div></div></div><hr/><div class="menus_items"><div class="menus_item"><a class="site-page" href="/"><i class="fa-fw fas fa-home"></i><span> Home</span></a></div><div class="menus_item"><a class="site-page" href="/archives/"><i class="fa-fw fas fa-archive"></i><span> Archives</span></a></div><div class="menus_item"><a class="site-page" href="/tags/"><i class="fa-fw fas fa-tags"></i><span> Tags</span></a></div><div class="menus_item"><a class="site-page" href="/categories/"><i class="fa-fw fas fa-folder-open"></i><span> Categories</span></a></div><div class="menus_item"><a class="site-page"><i class="fa-fw fas fa-list"></i><span> List</span><i class="fas fa-chevron-down menus-expand"></i></a><ul class="menus_item_child"><li><a class="site-page" href="/music/"><i class="fa-fw fas fa-music"></i><span> Music</span></a></li><li><a class="site-page" href="/movies/"><i class="fa-fw fas fa-video"></i><span> Movie</span></a></li></ul></div><div class="menus_item"><a class="site-page" href="/link/"><i class="fa-fw fas fa-link"></i><span> Link</span></a></div><div class="menus_item"><a class="site-page" href="/about/"><i class="fa-fw fas fa-heart"></i><span> About</span></a></div></div></div></div><i class="fas fa-arrow-right on" id="toggle-sidebar"></i><div id="sidebar"><div class="sidebar-toc"><div class="sidebar-toc__title">目录</div><div class="sidebar-toc__progress"><span class="progress-notice">你已经读了</span><span class="progress-num">0</span><span class="progress-percentage">%</span><div class="sidebar-toc__progress-bar">     </div></div><div class="sidebar-toc__content"><ol class="toc"><li class="toc-item toc-level-1"><a class="toc-link" href="#"><span class="toc-number">1.</span> <span class="toc-text">一、Django 模型（PyCharm实现）</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#1、PyCharm创建Django"><span class="toc-number">1.1.</span> <span class="toc-text">1、PyCharm创建Django</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#2、数据库配置"><span class="toc-number">1.2.</span> <span class="toc-text">2、数据库配置</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#3、定义模型"><span class="toc-number">1.3.</span> <span class="toc-text">3、定义模型</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#创建-APP"><span class="toc-number">1.3.1.</span> <span class="toc-text">创建 APP</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#创建好了之后可在Navicat-for-MySQL查看到："><span class="toc-number">1.3.1.1.</span> <span class="toc-text">创建好了之后可在Navicat for MySQL查看到：</span></a></li></ol></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#4、数据库操作"><span class="toc-number">1.4.</span> <span class="toc-text">4、数据库操作</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#添加数据"><span class="toc-number">1.4.1.</span> <span class="toc-text">添加数据</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#输出结果如下："><span class="toc-number">1.4.1.0.1.</span> <span class="toc-text">输出结果如下：</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#数据库可看到："><span class="toc-number">1.4.1.0.2.</span> <span class="toc-text">数据库可看到：</span></a></li></ol></li></ol></li></ol></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#"><span class="toc-number">2.</span> <span class="toc-text">二、重新创建一个Django</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#创建好之后运行一下这个项目"><span class="toc-number">2.0.0.0.1.</span> <span class="toc-text">创建好之后运行一下这个项目</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#会自动跳到浏览器"><span class="toc-number">2.0.0.0.2.</span> <span class="toc-text">会自动跳到浏览器</span></a></li></ol></li></ol></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#1、如果你是按上面继续做的，需要以下步骤："><span class="toc-number">2.1.</span> <span class="toc-text">1、如果你是按上面继续做的，需要以下步骤：</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#2、重新生成表单"><span class="toc-number">2.2.</span> <span class="toc-text">2、重新生成表单</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#3、models-py文件添加类型"><span class="toc-number">2.3.</span> <span class="toc-text">3、models.py文件添加类型</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#4、XGPtest-XGPtest-urls-py中关于testdb的内容，解除注释"><span class="toc-number">2.4.</span> <span class="toc-text">4、XGPtest&#x2F;XGPtest&#x2F;urls.py中关于testdb的内容，解除注释</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#3、创建XGPtest-XGPtest-testdb-py测试文件"><span class="toc-number">2.5.</span> <span class="toc-text">3、创建XGPtest&#x2F;XGPtest&#x2F;testdb.py测试文件</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#4、获取数据"><span class="toc-number">2.6.</span> <span class="toc-text">4、获取数据</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#Django提供了多种方式来获取数据库的内容，如下代码所示："><span class="toc-number">2.6.0.1.</span> <span class="toc-text">Django提供了多种方式来获取数据库的内容，如下代码所示：</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#XGPtest-XGPtest-urls-py文件添加"><span class="toc-number">2.6.0.2.</span> <span class="toc-text">XGPtest&#x2F;XGPtest&#x2F;urls.py文件添加</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#浏览器访问https-www-runoob-com-django-django-model-html"><span class="toc-number">2.6.0.2.1.</span> <span class="toc-text">浏览器访问https:&#x2F;&#x2F;www.runoob.com&#x2F;django&#x2F;django-model.html</span></a></li></ol></li></ol></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#5、更新数据"><span class="toc-number">2.7.</span> <span class="toc-text">5、更新数据</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#修改数据可以使用-save-或-update"><span class="toc-number">2.7.0.1.</span> <span class="toc-text">修改数据可以使用 save() 或 update():</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#XGPtest-XGPtest-urls-py文件添加-2"><span class="toc-number">2.7.0.2.</span> <span class="toc-text">XGPtest&#x2F;XGPtest&#x2F;urls.py文件添加</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#浏览器访问http-127-0-0-1-8000-modify"><span class="toc-number">2.7.0.2.1.</span> <span class="toc-text">浏览器访问http:&#x2F;&#x2F;127.0.0.1:8000&#x2F;modify&#x2F;</span></a></li></ol></li><li class="toc-item toc-level-4"><a class="toc-link" href="#查看test数据库testmodel-test表"><span class="toc-number">2.7.0.3.</span> <span class="toc-text">查看test数据库testmodel_test表</span></a></li></ol></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#6、删除数据"><span class="toc-number">2.8.</span> <span class="toc-text">6、删除数据</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#删除数据库中的对象只需调用该对象的delete-方法即可："><span class="toc-number">2.8.0.1.</span> <span class="toc-text">删除数据库中的对象只需调用该对象的delete()方法即可：</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#XGPtest-XGPtest-urls-py文件添加-3"><span class="toc-number">2.8.0.2.</span> <span class="toc-text">XGPtest&#x2F;XGPtest&#x2F;urls.py文件添加</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#浏览器访问http-127-0-0-1-8000-del"><span class="toc-number">2.8.0.2.1.</span> <span class="toc-text">浏览器访问http:&#x2F;&#x2F;127.0.0.1:8000&#x2F;del</span></a></li></ol></li><li class="toc-item toc-level-4"><a class="toc-link" href="#数据库查看第一个数据是否删除"><span class="toc-number">2.8.0.3.</span> <span class="toc-text">数据库查看第一个数据是否删除</span></a></li></ol></li></ol></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#"><span class="toc-number">3.</span> <span class="toc-text">三、Django 表单</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#1、HTTP-请求"><span class="toc-number">3.1.</span> <span class="toc-text">1、HTTP 请求</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#2、GET-方法"><span class="toc-number">3.2.</span> <span class="toc-text">2、GET 方法</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#在模板目录-templates-中添加-search-form-html-表单："><span class="toc-number">3.2.0.1.</span> <span class="toc-text">在模板目录 templates 中添加 search_form.html 表单：</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#urls-py-规则修改为如下形式："><span class="toc-number">3.2.0.2.</span> <span class="toc-text">urls.py 规则修改为如下形式：</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#访问地址-http-127-0-0-1-8000-search-form-并搜索，结果如下所示"><span class="toc-number">3.2.0.3.</span> <span class="toc-text">访问地址 http:&#x2F;&#x2F;127.0.0.1:8000&#x2F;search-form 并搜索，结果如下所示:</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#分析一下"><span class="toc-number">3.2.1.</span> <span class="toc-text">分析一下</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#3、POST-方法"><span class="toc-number">3.3.</span> <span class="toc-text">3、POST 方法</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#我们在-templates-创建-post-html："><span class="toc-number">3.3.0.1.</span> <span class="toc-text">我们在 templates 创建 post.html：</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#在HelloWorld目录下新建-search2-py-文件并使用-search-post-函数来处理-POST-请求："><span class="toc-number">3.3.0.2.</span> <span class="toc-text">在HelloWorld目录下新建 search2.py 文件并使用 search_post 函数来处理 POST 请求：</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#urls-py-规则修改为如下形式：-2"><span class="toc-number">3.3.0.3.</span> <span class="toc-text">urls.py 规则修改为如下形式：</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#访问-http-127-0-0-1-8000-search-post-显示结果如下："><span class="toc-number">3.3.0.4.</span> <span class="toc-text">访问 http:&#x2F;&#x2F;127.0.0.1:8000&#x2F;search-post 显示结果如下：</span></a></li></ol></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#3、Request-对象"><span class="toc-number">3.4.</span> <span class="toc-text">3、Request 对象</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#每个-view-函数的第一个参数是一个-HttpRequest-对象，就像下面这个-hello-函数"><span class="toc-number">3.4.0.1.</span> <span class="toc-text">每个 view 函数的第一个参数是一个 HttpRequest 对象，就像下面这个 hello() 函数:</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#HttpRequest对象包含当前请求URL的一些信息："><span class="toc-number">3.4.0.2.</span> <span class="toc-text">HttpRequest对象包含当前请求URL的一些信息：</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#Request对象也有一些有用的方法："><span class="toc-number">3.4.0.3.</span> <span class="toc-text">Request对象也有一些有用的方法：</span></a></li></ol></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#4、QueryDict对象"><span class="toc-number">3.5.</span> <span class="toc-text">4、QueryDict对象</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#QueryDict实现所有标准的词典方法。还包括一些特有的方法："><span class="toc-number">3.5.0.1.</span> <span class="toc-text">QueryDict实现所有标准的词典方法。还包括一些特有的方法：</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#此外-QueryDict也有一些方法，如下表："><span class="toc-number">3.5.0.2.</span> <span class="toc-text">此外, QueryDict也有一些方法，如下表：</span></a></li></ol></li></ol></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#"><span class="toc-number">4.</span> <span class="toc-text">四、Django Admin 管理工具</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#1、激活管理工具"><span class="toc-number">4.1.</span> <span class="toc-text">1、激活管理工具</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#2、使用管理工具"><span class="toc-number">4.2.</span> <span class="toc-text">2、使用管理工具</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#因为我现在是新建了个项目所以需要创建表结构："><span class="toc-number">4.2.0.1.</span> <span class="toc-text">因为我现在是新建了个项目所以需要创建表结构：</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#你可以通过命令-python-manage-py-createsuperuser-来创建超级用户，如下所示："><span class="toc-number">4.2.0.2.</span> <span class="toc-text">你可以通过命令 python manage.py createsuperuser 来创建超级用户，如下所示：</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#之后输入用户名密码登录，界面如下："><span class="toc-number">4.2.0.3.</span> <span class="toc-text">之后输入用户名密码登录，界面如下：</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#models-py文件添加类型"><span class="toc-number">4.2.0.4.</span> <span class="toc-text">models.py文件添加类型</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#为了让-admin-界面管理某个数据模型，我们需要先注册该数据模型到-admin。比如，我们之前在-TestModel-中已经创建了模型-Test-。修改-TestModel-admin-py"><span class="toc-number">4.2.0.5.</span> <span class="toc-text">为了让 admin 界面管理某个数据模型，我们需要先注册该数据模型到 admin。比如，我们之前在 TestModel 中已经创建了模型 Test 。修改 TestModel&#x2F;admin.py:</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#刷新后即可看到-Testmodel-数据表"><span class="toc-number">4.2.0.5.1.</span> <span class="toc-text">刷新后即可看到 Testmodel 数据表:</span></a></li></ol></li></ol></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#3、使用管理工具添加一个用户"><span class="toc-number">4.3.</span> <span class="toc-text">3、使用管理工具添加一个用户</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#4、复杂模型"><span class="toc-number">4.4.</span> <span class="toc-text">4、复杂模型</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#在-TestModel-admin-py-注册多个模型并显示："><span class="toc-number">4.4.0.0.1.</span> <span class="toc-text">在 TestModel&#x2F;admin.py 注册多个模型并显示：</span></a></li></ol></li><li class="toc-item toc-level-4"><a class="toc-link" href="#刷新管理页面，显示结果如下："><span class="toc-number">4.4.0.1.</span> <span class="toc-text">刷新管理页面，显示结果如下：</span></a></li></ol></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#5、自定义表单"><span class="toc-number">4.5.</span> <span class="toc-text">5、自定义表单</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#我们还可以将输入栏分块，每个栏也可以定义自己的格式。修改-TestModel-admin-py为："><span class="toc-number">4.5.0.1.</span> <span class="toc-text">我们还可以将输入栏分块，每个栏也可以定义自己的格式。修改 TestModel&#x2F;admin.py为：</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#上面的栏目分为了-Main-和-Advance-两部分。classes-说明它所在的部分的-CSS-格式。这里让-Advance-部分隐藏："><span class="toc-number">4.5.0.2.</span> <span class="toc-text">上面的栏目分为了 Main 和 Advance 两部分。classes 说明它所在的部分的 CSS 格式。这里让 Advance 部分隐藏：</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#Advance-部分旁边有一个-Show-按钮，用于展开，展开后可点击-Hide-将其隐藏，如下图所示："><span class="toc-number">4.5.0.3.</span> <span class="toc-text">Advance 部分旁边有一个 Show 按钮，用于展开，展开后可点击 Hide 将其隐藏，如下图所示：</span></a></li></ol></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#6、内联-Inline-显示"><span class="toc-number">4.6.</span> <span class="toc-text">6、内联(Inline)显示</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#显示效果如下："><span class="toc-number">4.6.0.0.1.</span> <span class="toc-text">显示效果如下：</span></a></li></ol></li></ol></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#7、列表页的显示"><span class="toc-number">4.7.</span> <span class="toc-text">7、列表页的显示</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#刷新页面显示效果如下："><span class="toc-number">4.7.0.0.1.</span> <span class="toc-text">刷新页面显示效果如下：</span></a></li></ol></li><li class="toc-item toc-level-4"><a class="toc-link" href="#搜索功能在管理大量记录时非常有，我们可以使用-search-fields-为该列表页增加搜索栏："><span class="toc-number">4.7.0.1.</span> <span class="toc-text">搜索功能在管理大量记录时非常有，我们可以使用 search_fields 为该列表页增加搜索栏：</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#在本实例中我们搜索了-name-为xgp的记录，显示结果如下："><span class="toc-number">4.7.0.1.1.</span> <span class="toc-text">在本实例中我们搜索了 name 为xgp的记录，显示结果如下：</span></a></li></ol></li></ol></li></ol></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#"><span class="toc-number">5.</span> <span class="toc-text">五、引入静态文件</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#1、urls-py-规则修改为如下形式："><span class="toc-number">5.0.1.</span> <span class="toc-text">1、urls.py 规则修改为如下形式：</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#2、本目录创建index-py文件"><span class="toc-number">5.0.2.</span> <span class="toc-text">2、本目录创建index.py文件</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#浏览器查看一下"><span class="toc-number">5.0.2.1.</span> <span class="toc-text">浏览器查看一下</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#3、需要让Django找到这个目录，需要在setting文件中进行配置："><span class="toc-number">5.0.3.</span> <span class="toc-text">3、需要让Django找到这个目录，需要在setting文件中进行配置：</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#4、修改一下index-html文件"><span class="toc-number">5.0.4.</span> <span class="toc-text">4、修改一下index.html文件</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#浏览器查看一下-2"><span class="toc-number">5.0.4.1.</span> <span class="toc-text">浏览器查看一下</span></a></li></ol></li></ol></li></ol></li></ol></div></div></div><div id="body-wrap"><header class="post-bg" id="page-header" style="background-image: url(https://gitee.com/xgpqq/tuchuang/raw/master/img/qweq63p.jpg)"><nav id="nav"><span class="pull-left" id="blog_name"><a class="blog_title" id="site-name" href="/">Xgp &amp; Blog</a></span><span class="pull-right menus"><div class="menus_items"><div class="menus_item"><a class="site-page" href="/"><i class="fa-fw fas fa-home"></i><span> Home</span></a></div><div class="menus_item"><a class="site-page" href="/archives/"><i class="fa-fw fas fa-archive"></i><span> Archives</span></a></div><div class="menus_item"><a class="site-page" href="/tags/"><i class="fa-fw fas fa-tags"></i><span> Tags</span></a></div><div class="menus_item"><a class="site-page" href="/categories/"><i class="fa-fw fas fa-folder-open"></i><span> Categories</span></a></div><div class="menus_item"><a class="site-page"><i class="fa-fw fas fa-list"></i><span> List</span><i class="fas fa-chevron-down menus-expand"></i></a><ul class="menus_item_child"><li><a class="site-page" href="/music/"><i class="fa-fw fas fa-music"></i><span> Music</span></a></li><li><a class="site-page" href="/movies/"><i class="fa-fw fas fa-video"></i><span> Movie</span></a></li></ul></div><div class="menus_item"><a class="site-page" href="/link/"><i class="fa-fw fas fa-link"></i><span> Link</span></a></div><div class="menus_item"><a class="site-page" href="/about/"><i class="fa-fw fas fa-heart"></i><span> About</span></a></div></div><span class="toggle-menu close"><a class="site-page"><i class="fas fa-bars fa-fw"></i></a></span></span></nav><div id="post-info"><div id="post-title"><div class="posttitle">PyCharm实现（Django的模型、表单、管理工具、引入静态文件）</div></div><div id="post-meta"><div class="meta-firstline"><time class="post-meta__date"><span class="post-meta__date-created" title="发表于 2019-09-14 00:18:00"><i class="far fa-calendar-alt fa-fw"></i> 发表于 2019-09-14</span><span class="post-meta__separator">|</span><span class="post-meta__date-updated" title="更新于 2020-06-30 14:57:26"><i class="fas fa-history fa-fw"></i> 更新于 2020-06-30</span></time><span class="post-meta__categories"><span class="post-meta__separator">|</span><i class="fas fa-inbox fa-fw post-meta__icon"></i><a class="post-meta__categories" href="/categories/python/">python</a></span></div><div class="meta-secondline"> </div><div class="meta-thirdline"><span class="post-meta-pv-cv"><i class="far fa-eye fa-fw post-meta__icon"></i><span>阅读量:</span><span id="busuanzi_value_page_pv"></span></span><span class="post-meta-commentcount"></span></div></div></div></header><main class="layout_post" id="content-inner"><article id="post"><div class="post-content" id="article-container"><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre class=" language-hljs shell"><code class="language-hljs shell">镜像列表<br>http://mirrors.aliyun.com/pypi/simple/ //阿里<br>https://pypi.tuna.tsinghua.edu.cn/simple/ //清华<br>http://pypi.douban.com/ //豆瓣<br>http://pypi.hustunique.com/ //华中理工大学<br>http://pypi.sdutlinux.org/ //山东理工大学<br>http://pypi.mirrors.ustc.edu.cn/ //中国科学技术大学<br></code></pre></td></tr></table></figure>
<h1>一、Django 模型（PyCharm实现）</h1>
<p><strong>Django 对各种数据库提供了很好的支持，包括：PostgreSQL、MySQL、SQLite、Oracle。</strong></p>
<p><strong>Django 为这些数据库提供了统一的调用API。 我们可以根据自己业务需求选择不同的数据库。</strong></p>
<p><strong>MySQL 是 Web 应用中最常用的数据库。本章节我们将以 Mysql 作为实例进行介绍。你可以通过本站的<a href="https://www.runoob.com/django/mysql/mysql-tutorial.html" target="_blank" rel="noopener"> MySQL 教程</a> 了解更多Mysql的基础知识。</strong></p>
<p><strong>如果你没安装 mysql 驱动，可以执行以下命令安装：</strong></p>
<figure class="highlight cmd"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre class=" language-hljs cmd"><code class="language-hljs cmd">sudo pip install mysqlclient  #较慢<br>pip install -i https://pypi.douban.com/simple/  mysqlclient  #较快<br></code></pre></td></tr></table></figure>
<h2 id="1、PyCharm创建Django">1、PyCharm创建Django</h2>
<p><img src= "/img/loading.gif" data-src="https://gitee.com/xgpqq/tuchuang/raw/master/img/image-20200416214513169.png" alt="image-20200416214513169"></p>
<p><img src= "/img/loading.gif" data-src="https://gitee.com/xgpqq/tuchuang/raw/master/img/image-20200416214638731.png" alt="image-20200416214638731"></p>
<p><img src= "/img/loading.gif" data-src="https://gitee.com/xgpqq/tuchuang/raw/master/img/image-20200416214650636.png" alt="image-20200416214650636"></p>
<h2 id="2、数据库配置">2、数据库配置</h2>
<p><strong>我们在项目的 <a href="http://settings.py" target="_blank" rel="noopener">settings.py</a> 文件中找到 DATABASES 配置项，将其信息修改为：</strong></p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre class=" language-hljs python">DATABASES = &#123;<br>    <span class="hljs-string">'default'</span>: &#123;<br>        <span class="hljs-string">'ENGINE'</span>: <span class="hljs-string">'django.db.backends.mysql'</span>,  <span class="hljs-comment"># 或者使用 mysql.connector.django</span><br>        <span class="hljs-string">'NAME'</span>: <span class="hljs-string">'test'</span>,<br>        <span class="hljs-string">'USER'</span>: <span class="hljs-string">'root'</span>,<br>        <span class="hljs-string">'PASSWORD'</span>: <span class="hljs-string">'123456'</span>,<br>        <span class="hljs-string">'HOST'</span>:<span class="hljs-string">'localhost'</span>,<br>        <span class="hljs-string">'PORT'</span>:<span class="hljs-string"><code class="language-hljs python">DATABASES = &#123;<br>    <span class="hljs-string">'default'</span>: &#123;<br>        <span class="hljs-string">'ENGINE'</span>: <span class="hljs-string">'django.db.backends.mysql'</span>,  <span class="hljs-comment"># 或者使用 mysql.connector.django</span><br>        <span class="hljs-string">'NAME'</span>: <span class="hljs-string">'test'</span>,<br>        <span class="hljs-string">'USER'</span>: <span class="hljs-string">'root'</span>,<br>        <span class="hljs-string">'PASSWORD'</span>: <span class="hljs-string">'123456'</span>,<br>        <span class="hljs-string">'HOST'</span>:<span class="hljs-string">'localhost'</span>,<br>        <span class="hljs-string">'PORT'</span>:<span class="hljs-string">'3306'</span>,<br>    &#125;<br>&#125;<br></code></pre></td></tr></table></figure>
<p><img src= "/img/loading.gif" data-src="https://gitee.com/xgpqq/tuchuang/raw/master/img/image-20200415143234067.png" alt="image-20200415143234067"></p>
<p><strong>这里添加了中文注释，所以你需要在 HelloWorld/settings.py 文件头部添加 # -*- coding: UTF-8 -*-。</strong></p>
<p><strong>上面包含数据库名称和用户的信息，它们与 MySQL 中对应数据库和用户的设置相同。Django 根据这一设置，与 MySQL 中相应的数据库和用户连接起来。</strong></p>
<h2 id="3、定义模型">3、定义模型</h2>
<h3 id="创建-APP">创建 APP</h3>
<p><strong>Django规定，如果要使用模型，必须要创建一个app。我们使用以下命令创建一个 TestModel 的 app:</strong></p>
<figure class="highlight cmd"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre class=" language-hljs cmd"><code class="language-hljs cmd">django-admin startapp TestModel<br></code></pre></td></tr></table></figure>
<p><strong>目录结构如下：</strong></p>
<figure class="highlight cmd"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre class=" language-hljs cmd"><code class="language-hljs cmd">HelloWorld<br>|-- TestModel<br>|   |-- __init__.py<br>|   |-- admin.py<br>|   |-- models.py<br>|   |-- tests.py<br>|   `-- views.py<br></code></pre></td></tr></table></figure>
<p><strong>我们修改 TestModel/models.py 文件，代码如下：</strong></p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre class=" language-hljs python"><span class="hljs-comment"># models.py</span><br><span class="hljs-keyword">from</span> django.db <span class="hljs-keyword">import</span> models<br> <br><span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">Test</span><span class="hljs-params">(models.Model)</span>:</span><br>    name = models.CharField(max_length=<span class="hljs-number"><code class="language-hljs python"><span class="hljs-comment"># models.py</span><br><span class="hljs-keyword">from</span> django.db <span class="hljs-keyword">import</span> models<br> <br><span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">Test</span><span class="hljs-params">(models.Model)</span>:</span><br>    name = models.CharField(max_length=<span class="hljs-number">20</span>)<br></code></pre></td></tr></table></figure>
<p><strong>以上的类名代表了数据库表名，且继承了<code>models.Model</code>，类里面的字段代表数据表中的字段(name)，数据类型则由CharField（相当于<code>varchar</code>）、<code>DateField</code>（相当于<code>datetime</code>）， max_length 参数限定长度。</strong></p>
<p><strong>接下来在settings.py中找到INSTALLED_APPS这一项，如下：</strong></p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre class=" language-hljs python">INSTALLED_APPS = (<br>    <span class="hljs-string">'django.contrib.admin'</span>,<br>    <span class="hljs-string">'django.contrib.auth'</span>,<br>    <span class="hljs-string">'django.contrib.contenttypes'</span>,<br>    <span class="hljs-string">'django.contrib.sessions'</span>,<br>    <span class="hljs-string">'django.contrib.messages'</span>,<br>    <span class="hljs-string">'django.contrib.staticfiles'</span>,<br>    <span class="hljs-string">'TestModel'</span>,               <span class="hljs-comment"><code class="language-hljs python">INSTALLED_APPS = (<br>    <span class="hljs-string">'django.contrib.admin'</span>,<br>    <span class="hljs-string">'django.contrib.auth'</span>,<br>    <span class="hljs-string">'django.contrib.contenttypes'</span>,<br>    <span class="hljs-string">'django.contrib.sessions'</span>,<br>    <span class="hljs-string">'django.contrib.messages'</span>,<br>    <span class="hljs-string">'django.contrib.staticfiles'</span>,<br>    <span class="hljs-string">'TestModel'</span>,               <span class="hljs-comment"># 添加此项</span><br>)<br></code></pre></td></tr></table></figure>
<p><strong>在命令行中运行：</strong></p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre class=" language-hljs python">$ python manage.py migrate   <span class="hljs-comment"># 创建表结构</span><br>//失败了可用python3 manage.py migrate<br><br>$ python manage.py makemigrations TestModel  <span class="hljs-comment"># 让 Django 知道我们在我们的模型有一些变更</span><br>$ python manage.py migrate TestModel   <span class="hljs-comment"><code class="language-hljs python">$ python manage.py migrate   <span class="hljs-comment"># 创建表结构</span><br>//失败了可用python3 manage.py migrate<br><br>$ python manage.py makemigrations TestModel  <span class="hljs-comment"># 让 Django 知道我们在我们的模型有一些变更</span><br>$ python manage.py migrate TestModel   <span class="hljs-comment"># 创建表结构</span><br></code></pre></td></tr></table></figure>
<p><strong>看到几行 “Creating table…” 的字样，你的数据表就创建好了。</strong></p>
<h4 id="创建好了之后可在Navicat-for-MySQL查看到："><strong>创建好了之后可在Navicat for MySQL查看到：</strong></h4>
<p><img src= "/img/loading.gif" data-src="https://gitee.com/xgpqq/tuchuang/raw/master/img/image-20200416220944048.png" alt="image-20200416220944048"></p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre class=" language-hljs python">Creating tables ...<br>……<br>Creating table TestModel_test  <span class="hljs-comment"><code class="language-hljs python">Creating tables ...<br>……<br>Creating table TestModel_test  <span class="hljs-comment">#我们自定义的表</span><br>……<br></code></pre></td></tr></table></figure>
<p><strong>表名组成结构为：应用名_类名（如：TestModel_test）。</strong></p>
<p><strong>注意：尽管我们没有在models给表设置主键，但是Django会自动添加一个id作为主键。</strong></p>
<h2 id="4、数据库操作">4、数据库操作</h2>
<p><strong>接下来我们在 HelloWorld 目录中添加 <a href="http://testdb.py" target="_blank" rel="noopener">testdb.py</a> 文件（下面介绍），并修改 <a href="http://urls.py" target="_blank" rel="noopener">urls.py</a>：</strong></p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre class=" language-hljs python"><span class="hljs-keyword">from</span> django.contrib <span class="hljs-keyword">import</span> admin<br><span class="hljs-keyword">from</span> django.urls <span class="hljs-keyword">import</span> path<br><span class="hljs-keyword">from</span> . <span class="hljs-keyword">import</span> testdb<br><br>urlpatterns = [<br>    path(<span class="hljs-string">'admin/'</span>, admin.site.urls),<br>    path(<span class="hljs-string"><code class="language-hljs python"><span class="hljs-keyword">from</span> django.contrib <span class="hljs-keyword">import</span> admin<br><span class="hljs-keyword">from</span> django.urls <span class="hljs-keyword">import</span> path<br><span class="hljs-keyword">from</span> . <span class="hljs-keyword">import</span> testdb<br><br>urlpatterns = [<br>    path(<span class="hljs-string">'admin/'</span>, admin.site.urls),<br>    path(<span class="hljs-string">'testdb/'</span>, testdb.testdb),<br>]<br></code></pre></td></tr></table></figure>
<h3 id="添加数据">添加数据</h3>
<p><strong>添加数据需要先创建对象，然后再执行 save 函数，相当于SQL中的INSERT：</strong></p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre class=" language-hljs python"><span class="hljs-comment">#HelloWorld/HelloWorld/testdb.py文件代码</span><br><span class="hljs-comment"># -*- coding: utf-8 -*-</span><br> <br><span class="hljs-keyword">from</span> django.http <span class="hljs-keyword">import</span> HttpResponse<br> <br><span class="hljs-keyword">from</span> TestModel.models <span class="hljs-keyword">import</span> Test<br> <br><span class="hljs-comment"># 数据库操作</span><br><span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">testdb</span><span class="hljs-params">(request)</span>:</span><br>    test1 = Test(name=<span class="hljs-string">'runoob'</span>)<br>    test1.save()<br>    <span class="hljs-keyword">return</span> HttpResponse(<span class="hljs-string"><code class="language-hljs python"><span class="hljs-comment">#HelloWorld/HelloWorld/testdb.py文件代码</span><br><span class="hljs-comment"># -*- coding: utf-8 -*-</span><br> <br><span class="hljs-keyword">from</span> django.http <span class="hljs-keyword">import</span> HttpResponse<br> <br><span class="hljs-keyword">from</span> TestModel.models <span class="hljs-keyword">import</span> Test<br> <br><span class="hljs-comment"># 数据库操作</span><br><span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">testdb</span><span class="hljs-params">(request)</span>:</span><br>    test1 = Test(name=<span class="hljs-string">'runoob'</span>)<br>    test1.save()<br>    <span class="hljs-keyword">return</span> HttpResponse(<span class="hljs-string">"<p>数据添加成功！</p>"</span>)<br></code></pre></td></tr></table></figure>
<p><strong>访问 <a href="http://127.0.0.1:8000/testdb" target="_blank" rel="noopener">http://127.0.0.1:8000/testdb</a> 就可以看到数据添加成功的提示。</strong></p>
<h5 id="输出结果如下："><strong>输出结果如下：</strong></h5>
<p><img src= "/img/loading.gif" data-src="https://gitee.com/xgpqq/tuchuang/raw/master/img/image-20200416220758839.png" alt="image-20200416220758839"></p>
<h5 id="数据库可看到：">数据库可看到：</h5>
<p><img src= "/img/loading.gif" data-src="https://gitee.com/xgpqq/tuchuang/raw/master/img/image-20200416221340509.png" alt="image-20200416221340509"></p>
<p><em><strong>当浏览器每刷新一下，数据库里的信息就会增加一条。</strong></em></p>
<h1>二、重新创建一个Django</h1>
<p><em><strong>要提前把数据库里创建的表删除</strong></em></p>
<p><img src= "/img/loading.gif" data-src="https://gitee.com/xgpqq/tuchuang/raw/master/img/image-20200417105056336.png" alt="image-20200417105056336"></p>
<h5 id="创建好之后运行一下这个项目">创建好之后运行一下这个项目</h5>
<p><img src= "/img/loading.gif" data-src="https://gitee.com/xgpqq/tuchuang/raw/master/img/image-20200417102532689.png" alt="image-20200417102532689"></p>
<p><img src= "/img/loading.gif" data-src="https://gitee.com/xgpqq/tuchuang/raw/master/img/image-20200417102604557.png" alt="image-20200417102604557"></p>
<h5 id="会自动跳到浏览器">会自动跳到浏览器</h5>
<p><img src= "/img/loading.gif" data-src="https://gitee.com/xgpqq/tuchuang/raw/master/img/image-20200417102612522.png" alt="image-20200417102612522"></p>
<h2 id="1、如果你是按上面继续做的，需要以下步骤：">1、如果你是按上面继续做的，需要以下步骤：</h2>
<p><em><strong>（还原为，原始状态）</strong></em></p>
<ul>
<li><strong>删除test的表文件</strong></li>
<li><strong>删除之前创建的XGPtest/XGPtest/testdb.py文件</strong></li>
<li><strong>XGPtest/TestModel/models.py文件内容删除</strong></li>
<li><strong>注释XGPtest/XGPtest/urls.py中关于testdb的内容</strong></li>
<li><strong>然后重新启动</strong></li>
</ul>
<p><strong>浏览器访问http://127.0.0.1:8000/会和之前的界面一样，有个小火箭！</strong></p>
<ul>
<li><strong>删除XGPtest/TestModel/migrations/0001_initial.py文件</strong></li>
</ul>
<h2 id="2、重新生成表单">2、重新生成表单</h2>
<figure class="highlight cmd"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre class=" language-hljs cmd"><code class="language-hljs cmd">$ python manage.py migrate   # 创建表结构<br>//失败了可用python3 manage.py migrate<br><br>$ python manage.py makemigrations TestModel  # 让 Django 知道我们在我们的模型有一些变更<br>$ python manage.py migrate TestModel   # 创建表结构<br></code></pre></td></tr></table></figure>
<h2 id="3、models-py文件添加类型">3、models.py文件添加类型</h2>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre class=" language-hljs python"><span class="hljs-comment">#XGPtest/TestModel/models.py</span><br><span class="hljs-keyword">from</span> django.db <span class="hljs-keyword">import</span> models<br> <br><span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">Test</span><span class="hljs-params">(models.Model)</span>:</span><br>    name = models.CharField(max_length=<span class="hljs-number"><code class="language-hljs python"><span class="hljs-comment">#XGPtest/TestModel/models.py</span><br><span class="hljs-keyword">from</span> django.db <span class="hljs-keyword">import</span> models<br> <br><span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">Test</span><span class="hljs-params">(models.Model)</span>:</span><br>    name = models.CharField(max_length=<span class="hljs-number">20</span>)<br></code></pre></td></tr></table></figure>
<p><em><strong>创建完成之后，数据库中就生成testmodel_test表</strong></em></p>
<h2 id="4、XGPtest-XGPtest-urls-py中关于testdb的内容，解除注释">4、XGPtest/XGPtest/urls.py中关于testdb的内容，解除注释</h2>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre class=" language-hljs python"><span class="hljs-keyword">from</span> django.contrib <span class="hljs-keyword">import</span> admin<br><span class="hljs-keyword">from</span> django.urls <span class="hljs-keyword">import</span> path<br><span class="hljs-keyword">from</span> . <span class="hljs-keyword">import</span> testdb<br><br>urlpatterns = [<br>    path(<span class="hljs-string">'admin/'</span>, admin.site.urls),<br>    path(<span class="hljs-string"><code class="language-hljs python"><span class="hljs-keyword">from</span> django.contrib <span class="hljs-keyword">import</span> admin<br><span class="hljs-keyword">from</span> django.urls <span class="hljs-keyword">import</span> path<br><span class="hljs-keyword">from</span> . <span class="hljs-keyword">import</span> testdb<br><br>urlpatterns = [<br>    path(<span class="hljs-string">'admin/'</span>, admin.site.urls),<br>    path(<span class="hljs-string">'testdb/'</span>, testdb.testdb),<br>]<br></code></pre></td></tr></table></figure>
<h2 id="3、创建XGPtest-XGPtest-testdb-py测试文件">3、创建XGPtest/XGPtest/testdb.py测试文件</h2>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre class=" language-hljs python"><span class="hljs-comment"># -*- coding: utf-8 -*-</span><br><br><span class="hljs-keyword">from</span> django.http <span class="hljs-keyword">import</span> HttpResponse<br><br><span class="hljs-keyword">from</span> TestModel.models <span class="hljs-keyword">import</span> Test<br><br><br><span class="hljs-comment"># 数据库操作</span><br><span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">testdb</span><span class="hljs-params">(request)</span>:</span><br>    test1 = Test(name=<span class="hljs-string">'runoob'</span>)<br>    test1.save()<br>    <span class="hljs-keyword">return</span> HttpResponse(<span class="hljs-string"><code class="language-hljs python"><span class="hljs-comment"># -*- coding: utf-8 -*-</span><br><br><span class="hljs-keyword">from</span> django.http <span class="hljs-keyword">import</span> HttpResponse<br><br><span class="hljs-keyword">from</span> TestModel.models <span class="hljs-keyword">import</span> Test<br><br><br><span class="hljs-comment"># 数据库操作</span><br><span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">testdb</span><span class="hljs-params">(request)</span>:</span><br>    test1 = Test(name=<span class="hljs-string">'runoob'</span>)<br>    test1.save()<br>    <span class="hljs-keyword">return</span> HttpResponse(<span class="hljs-string">"<p>数据添加成功！</p>"</span>)<br></code></pre></td></tr></table></figure>
<h2 id="4、获取数据">4、获取数据</h2>
<p><strong>首先多访问几次http://127.0.0.1:8000/testdb生成数据</strong></p>
<p><strong>数据库更改一下其中内容（随意编写）</strong></p>
<p><img src= "/img/loading.gif" data-src="https://gitee.com/xgpqq/tuchuang/raw/master/img/image-20200417130401673.png" alt="image-20200417130401673"></p>
<h4 id="Django提供了多种方式来获取数据库的内容，如下代码所示："><strong>Django提供了多种方式来获取数据库的内容，如下代码所示：</strong></h4>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br></pre></td><td class="code"><pre class=" language-hljs python"><span class="hljs-comment">#XGPtest/XGPtest/testdb.py#XGPtest/XGPtest/testdb.py 文件尾部添加</span><br><span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">getdb</span><span class="hljs-params">(request)</span>:</span><br>    <span class="hljs-comment"># 初始化</span><br>    response = <span class="hljs-string">""</span><br>    response1 = <span class="hljs-string">""</span><br><br>    <span class="hljs-comment"># 通过objects这个模型管理器的all()获得所有数据行，相当于SQL中的SELECT * FROM</span><br>    list = Test.objects.all()<br><br>    <span class="hljs-comment"># filter相当于SQL中的WHERE，可设置条件过滤结果</span><br>    response2 = Test.objects.filter(id=<span class="hljs-number">1</span>)<br><br>    <span class="hljs-comment"># 获取单个对象</span><br>    response3 = Test.objects.get(id=<span class="hljs-number">1</span>)<br><br>    <span class="hljs-comment"># 限制返回的数据 相当于 SQL 中的 OFFSET 0 LIMIT 2;</span><br>    <span class="hljs-comment"># Test.objects.order_by('name')[0:2]</span><br><br>    <span class="hljs-comment"># 数据排序</span><br>    Test.objects.order_by(<span class="hljs-string">"id"</span>)<br><br>    <span class="hljs-comment"># 上面的方法可以连锁使用</span><br>    Test.objects.filter(name=<span class="hljs-string">"runoob"</span>).order_by(<span class="hljs-string">"id"</span>)<br><br>    <span class="hljs-comment"># 输出所有数据</span><br>    <span class="hljs-keyword">for</span> var <span class="hljs-keyword">in</span> list:<br>        response1 += var.name + <span class="hljs-string">" "</span><br>    response = response1<br>    <span class="hljs-keyword">return</span> HttpResponse(<span class="hljs-string">"&lt;p&gt;"</span> + response + <span class="hljs-string"><code class="language-hljs python"><span class="hljs-comment">#XGPtest/XGPtest/testdb.py#XGPtest/XGPtest/testdb.py 文件尾部添加</span><br><span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">getdb</span><span class="hljs-params">(request)</span>:</span><br>    <span class="hljs-comment"># 初始化</span><br>    response = <span class="hljs-string">""</span><br>    response1 = <span class="hljs-string">""</span><br><br>    <span class="hljs-comment"># 通过objects这个模型管理器的all()获得所有数据行，相当于SQL中的SELECT * FROM</span><br>    list = Test.objects.all()<br><br>    <span class="hljs-comment"># filter相当于SQL中的WHERE，可设置条件过滤结果</span><br>    response2 = Test.objects.filter(id=<span class="hljs-number">1</span>)<br><br>    <span class="hljs-comment"># 获取单个对象</span><br>    response3 = Test.objects.get(id=<span class="hljs-number">1</span>)<br><br>    <span class="hljs-comment"># 限制返回的数据 相当于 SQL 中的 OFFSET 0 LIMIT 2;</span><br>    <span class="hljs-comment"># Test.objects.order_by('name')[0:2]</span><br><br>    <span class="hljs-comment"># 数据排序</span><br>    Test.objects.order_by(<span class="hljs-string">"id"</span>)<br><br>    <span class="hljs-comment"># 上面的方法可以连锁使用</span><br>    Test.objects.filter(name=<span class="hljs-string">"runoob"</span>).order_by(<span class="hljs-string">"id"</span>)<br><br>    <span class="hljs-comment"># 输出所有数据</span><br>    <span class="hljs-keyword">for</span> var <span class="hljs-keyword">in</span> list:<br>        response1 += var.name + <span class="hljs-string">" "</span><br>    response = response1<br>    <span class="hljs-keyword">return</span> HttpResponse(<span class="hljs-string">"&lt;p&gt;"</span> + response + <span class="hljs-string">"</p>"</span>)<br></code></pre></td></tr></table></figure>
<h4 id="XGPtest-XGPtest-urls-py文件添加"><strong>XGPtest/XGPtest/urls.py文件添加</strong></h4>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre class=" language-hljs python"><span class="hljs-keyword">from</span> django.contrib <span class="hljs-keyword">import</span> admin<br><span class="hljs-keyword">from</span> django.urls <span class="hljs-keyword">import</span> path<br><span class="hljs-keyword">from</span> . <span class="hljs-keyword">import</span> testdb<br><br>urlpatterns = [<br>    path(<span class="hljs-string">'admin/'</span>, admin.site.urls),<br>    path(<span class="hljs-string">'testdb/'</span>, testdb.testdb),<br>    path(<span class="hljs-string">'gitdb/'</span>, testdb.gitdb),         <span class="hljs-comment"><code class="language-hljs python"><span class="hljs-keyword">from</span> django.contrib <span class="hljs-keyword">import</span> admin<br><span class="hljs-keyword">from</span> django.urls <span class="hljs-keyword">import</span> path<br><span class="hljs-keyword">from</span> . <span class="hljs-keyword">import</span> testdb<br><br>urlpatterns = [<br>    path(<span class="hljs-string">'admin/'</span>, admin.site.urls),<br>    path(<span class="hljs-string">'testdb/'</span>, testdb.testdb),<br>    path(<span class="hljs-string">'gitdb/'</span>, testdb.gitdb),         <span class="hljs-comment">#添加</span><br>]<br></code></pre></td></tr></table></figure>
<h5 id="浏览器访问https-www-runoob-com-django-django-model-html">浏览器访问https://www.runoob.com/django/django-model.html</h5>
<p><img src= "/img/loading.gif" data-src="https://gitee.com/xgpqq/tuchuang/raw/master/img/image-20200417131131585.png" alt="image-20200417131131585"></p>
<h2 id="5、更新数据">5、更新数据</h2>
<h4 id="修改数据可以使用-save-或-update"><strong>修改数据可以使用 save() 或 update():</strong></h4>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre class=" language-hljs python"><span class="hljs-comment">#XGPtest/XGPtest/testdb.py#XGPtest/XGPtest/testdb.py 文件尾部添加</span><br><span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">modify</span><span class="hljs-params">(request)</span>:</span><br>    <span class="hljs-comment"># 修改其中一个id=1的name字段，再save，相当于SQL中的UPDATE</span><br>    test1 = Test.objects.get(id=<span class="hljs-number">1</span>)<br>    test1.name = <span class="hljs-string">'Google'</span><br>    test1.save()<br>    <br>    <span class="hljs-comment"># 另外一种方式</span><br>    <span class="hljs-comment">#Test.objects.filter(id=1).update(name='Google')</span><br>    <br>    <span class="hljs-comment"># 修改所有的列</span><br>    <span class="hljs-comment"># Test.objects.all().update(name='Google')</span><br>    <br>    <span class="hljs-keyword">return</span> HttpResponse(<span class="hljs-string"><code class="language-hljs python"><span class="hljs-comment">#XGPtest/XGPtest/testdb.py#XGPtest/XGPtest/testdb.py 文件尾部添加</span><br><span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">modify</span><span class="hljs-params">(request)</span>:</span><br>    <span class="hljs-comment"># 修改其中一个id=1的name字段，再save，相当于SQL中的UPDATE</span><br>    test1 = Test.objects.get(id=<span class="hljs-number">1</span>)<br>    test1.name = <span class="hljs-string">'Google'</span><br>    test1.save()<br>    <br>    <span class="hljs-comment"># 另外一种方式</span><br>    <span class="hljs-comment">#Test.objects.filter(id=1).update(name='Google')</span><br>    <br>    <span class="hljs-comment"># 修改所有的列</span><br>    <span class="hljs-comment"># Test.objects.all().update(name='Google')</span><br>    <br>    <span class="hljs-keyword">return</span> HttpResponse(<span class="hljs-string">"<p>修改成功</p>"</span>)<br></code></pre></td></tr></table></figure>
<h4 id="XGPtest-XGPtest-urls-py文件添加-2"><strong>XGPtest/XGPtest/urls.py文件添加</strong></h4>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre class=" language-hljs python"><span class="hljs-keyword">from</span> django.contrib <span class="hljs-keyword">import</span> admin<br><span class="hljs-keyword">from</span> django.urls <span class="hljs-keyword">import</span> path<br><span class="hljs-keyword">from</span> . <span class="hljs-keyword">import</span> testdb<br><br>urlpatterns = [<br>    path(<span class="hljs-string">'admin/'</span>, admin.site.urls),<br>    path(<span class="hljs-string">'testdb/'</span>, testdb.testdb),<br>    path(<span class="hljs-string">'gitdb/'</span>, testdb.gitdb),         <span class="hljs-comment">#添加</span><br>    path(<span class="hljs-string"><code class="language-hljs python"><span class="hljs-keyword">from</span> django.contrib <span class="hljs-keyword">import</span> admin<br><span class="hljs-keyword">from</span> django.urls <span class="hljs-keyword">import</span> path<br><span class="hljs-keyword">from</span> . <span class="hljs-keyword">import</span> testdb<br><br>urlpatterns = [<br>    path(<span class="hljs-string">'admin/'</span>, admin.site.urls),<br>    path(<span class="hljs-string">'testdb/'</span>, testdb.testdb),<br>    path(<span class="hljs-string">'gitdb/'</span>, testdb.gitdb),         <span class="hljs-comment">#添加</span><br>    path(<span class="hljs-string">'modify/'</span>, testdb.modify), <br>]<br></code></pre></td></tr></table></figure>
<h5 id="浏览器访问http-127-0-0-1-8000-modify">浏览器访问http://127.0.0.1:8000/modify/</h5>
<p><img src= "/img/loading.gif" data-src="https://gitee.com/xgpqq/tuchuang/raw/master/img/image-20200417131456890.png" alt="image-20200417131456890"></p>
<h4 id="查看test数据库testmodel-test表">查看test数据库testmodel_test表</h4>
<p><img src= "/img/loading.gif" data-src="https://gitee.com/xgpqq/tuchuang/raw/master/img/image-20200417131732385.png" alt="image-20200417131732385"></p>
<h2 id="6、删除数据">6、删除数据</h2>
<h4 id="删除数据库中的对象只需调用该对象的delete-方法即可："><strong>删除数据库中的对象只需调用该对象的delete()方法即可：</strong></h4>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre class=" language-hljs python"><span class="hljs-comment">#XGPtest/XGPtest/testdb.py#XGPtest/XGPtest/testdb.py 文件尾部添加</span><br><span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">del</span><span class="hljs-params">(request)</span>:</span><br>    <span class="hljs-comment"># 删除id=1的数据</span><br>    test1 = Test.objects.get(id=<span class="hljs-number">1</span>)<br>    test1.delete()<br>    <br>    <span class="hljs-comment"># 另外一种方式</span><br>    <span class="hljs-comment"># Test.objects.filter(id=1).delete()</span><br>    <br>    <span class="hljs-comment"># 删除所有数据</span><br>    <span class="hljs-comment"># Test.objects.all().delete()</span><br>    <br>    <span class="hljs-keyword">return</span> HttpResponse(<span class="hljs-string"><code class="language-hljs python"><span class="hljs-comment">#XGPtest/XGPtest/testdb.py#XGPtest/XGPtest/testdb.py 文件尾部添加</span><br><span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">del</span><span class="hljs-params">(request)</span>:</span><br>    <span class="hljs-comment"># 删除id=1的数据</span><br>    test1 = Test.objects.get(id=<span class="hljs-number">1</span>)<br>    test1.delete()<br>    <br>    <span class="hljs-comment"># 另外一种方式</span><br>    <span class="hljs-comment"># Test.objects.filter(id=1).delete()</span><br>    <br>    <span class="hljs-comment"># 删除所有数据</span><br>    <span class="hljs-comment"># Test.objects.all().delete()</span><br>    <br>    <span class="hljs-keyword">return</span> HttpResponse(<span class="hljs-string">"<p>删除成功</p>"</span>)<br></code></pre></td></tr></table></figure>
<h4 id="XGPtest-XGPtest-urls-py文件添加-3"><strong>XGPtest/XGPtest/urls.py文件添加</strong></h4>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre class=" language-hljs python"><span class="hljs-keyword">from</span> django.contrib <span class="hljs-keyword">import</span> admin<br><span class="hljs-keyword">from</span> django.urls <span class="hljs-keyword">import</span> path<br><span class="hljs-keyword">from</span> . <span class="hljs-keyword">import</span> testdb<br><br>urlpatterns = [<br>    path(<span class="hljs-string">'admin/'</span>, admin.site.urls),<br>    path(<span class="hljs-string">'testdb/'</span>, testdb.testdb),<br>    path(<span class="hljs-string">'gitdb/'</span>, testdb.gitdb),         <span class="hljs-comment">#添加</span><br>    path(<span class="hljs-string">'modify/'</span>, testdb.modify), <br>    path(<span class="hljs-string">'del/'</span>, testdb.<span class="hljs-keyword"><code class="language-hljs python"><span class="hljs-keyword">from</span> django.contrib <span class="hljs-keyword">import</span> admin<br><span class="hljs-keyword">from</span> django.urls <span class="hljs-keyword">import</span> path<br><span class="hljs-keyword">from</span> . <span class="hljs-keyword">import</span> testdb<br><br>urlpatterns = [<br>    path(<span class="hljs-string">'admin/'</span>, admin.site.urls),<br>    path(<span class="hljs-string">'testdb/'</span>, testdb.testdb),<br>    path(<span class="hljs-string">'gitdb/'</span>, testdb.gitdb),         <span class="hljs-comment">#添加</span><br>    path(<span class="hljs-string">'modify/'</span>, testdb.modify), <br>    path(<span class="hljs-string">'del/'</span>, testdb.<span class="hljs-keyword">del</span>),<br>]<br></code></pre></td></tr></table></figure>
<h5 id="浏览器访问http-127-0-0-1-8000-del">浏览器访问http://127.0.0.1:8000/del</h5>
<p><img src= "/img/loading.gif" data-src="https://gitee.com/xgpqq/tuchuang/raw/master/img/image-20200417132243092.png" alt="image-20200417132243092"></p>
<h4 id="数据库查看第一个数据是否删除">数据库查看第一个数据是否删除</h4>
<p><img src= "/img/loading.gif" data-src="https://gitee.com/xgpqq/tuchuang/raw/master/img/image-20200417132551220.png" alt="image-20200417132551220"></p>
<h1>三、Django 表单</h1>
<p><strong>HTML表单是网站交互性的经典方式。 本章将介绍如何用Django对用户提交的表单数据进行处理。</strong></p>
<h2 id="1、HTTP-请求"><strong>1、HTTP 请求</strong></h2>
<p><strong>HTTP协议以&quot;请求－回复&quot;的方式工作。客户发送请求时，可以在请求中附加数据。服务器通过解析请求，就可以获得客户传来的数据，并根据URL来提供特定的服务。</strong></p>
<h2 id="2、GET-方法"><strong>2、GET 方法</strong></h2>
<p><strong>我们在之前的项目中创建一个 <a href="http://search.py" target="_blank" rel="noopener">search.py</a> 文件，用于接收用户的请求：</strong></p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre class=" language-hljs python"><span class="hljs-comment">#/HelloWorld/HelloWorld/search.py 文件代码：</span><br><span class="hljs-comment"># -*- coding: utf-8 -*-</span><br><br><span class="hljs-keyword">from</span> django.http <span class="hljs-keyword">import</span> HttpResponse<br><span class="hljs-keyword">from</span> django.shortcuts <span class="hljs-keyword">import</span> render<br><br><br><span class="hljs-comment"># 表单</span><br><span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">search_form</span><span class="hljs-params">(request)</span>:</span><br>    <span class="hljs-keyword">return</span> render(request,<span class="hljs-string">'search_form.html'</span>,&#123;&#125;)<br><br><br><span class="hljs-comment"># 接收请求数据</span><br><span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">search</span><span class="hljs-params">(request)</span>:</span><br>    request.encoding = <span class="hljs-string">'utf-8'</span><br>    <span class="hljs-keyword">if</span> <span class="hljs-string">'q'</span> <span class="hljs-keyword">in</span> request.GET <span class="hljs-keyword">and</span> request.GET[<span class="hljs-string">'q'</span>]:<br>        message = <span class="hljs-string">'你搜索的内容为: '</span> + request.GET[<span class="hljs-string">'q'</span>]<br>    <span class="hljs-keyword">else</span>:<br>        message = <span class="hljs-string">'你提交了空表单'</span><br>    <span class="hljs-keyword"><code class="language-hljs python"><span class="hljs-comment">#/HelloWorld/HelloWorld/search.py 文件代码：</span><br><span class="hljs-comment"># -*- coding: utf-8 -*-</span><br><br><span class="hljs-keyword">from</span> django.http <span class="hljs-keyword">import</span> HttpResponse<br><span class="hljs-keyword">from</span> django.shortcuts <span class="hljs-keyword">import</span> render<br><br><br><span class="hljs-comment"># 表单</span><br><span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">search_form</span><span class="hljs-params">(request)</span>:</span><br>    <span class="hljs-keyword">return</span> render(request,<span class="hljs-string">'search_form.html'</span>,&#123;&#125;)<br><br><br><span class="hljs-comment"># 接收请求数据</span><br><span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">search</span><span class="hljs-params">(request)</span>:</span><br>    request.encoding = <span class="hljs-string">'utf-8'</span><br>    <span class="hljs-keyword">if</span> <span class="hljs-string">'q'</span> <span class="hljs-keyword">in</span> request.GET <span class="hljs-keyword">and</span> request.GET[<span class="hljs-string">'q'</span>]:<br>        message = <span class="hljs-string">'你搜索的内容为: '</span> + request.GET[<span class="hljs-string">'q'</span>]<br>    <span class="hljs-keyword">else</span>:<br>        message = <span class="hljs-string">'你提交了空表单'</span><br>    <span class="hljs-keyword">return</span> HttpResponse(message)<br></code></pre></td></tr></table></figure>
<h4 id="在模板目录-templates-中添加-search-form-html-表单：">在模板目录 templates 中添加 search_form.html 表单：</h4>
<figure class="highlight"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre class=" language-hljs python"><span class="hljs-comment">#/HelloWorld/templates/search_form.html 文件代码：</span><br>&lt;!DOCTYPE html&gt;<br>&lt;html&gt;<br>&lt;head&gt;<br>    &lt;meta charset=<span class="hljs-string">"utf-8"</span>&gt;<br>    &lt;title&gt;xgp666&lt;/title&gt;<br>&lt;/head&gt;<br>&lt;body&gt;<br>&lt;form action=<span class="hljs-string">"/search"</span> method=<span class="hljs-string">"get"</span>&gt;<br>    &lt;input type=<span class="hljs-string">"text"</span> name=<span class="hljs-string">"q"</span>&gt;<br>    &lt;input type=<span class="hljs-string">"submit"</span> value=<span class="hljs-string"><code class="language-hljs python"><span class="hljs-comment">#/HelloWorld/templates/search_form.html 文件代码：</span><br>&lt;!DOCTYPE html&gt;<br>&lt;html&gt;<br>&lt;head&gt;<br>    &lt;meta charset=<span class="hljs-string">"utf-8"</span>&gt;<br>    &lt;title&gt;xgp666&lt;/title&gt;<br>&lt;/head&gt;<br>&lt;body&gt;<br>&lt;form action=<span class="hljs-string">"/search"</span> method=<span class="hljs-string">"get"</span>&gt;<br>    &lt;input type=<span class="hljs-string">"text"</span> name=<span class="hljs-string">"q"</span>&gt;<br>    &lt;input type=<span class="hljs-string">"submit"</span> value=<span class="hljs-string">"搜索"</span>><br>    </form><br></body><br></html><br></code></pre></td></tr></table></figure>
<p><em><strong>可在浏览器打开是一个搜索框</strong></em></p>
<p><img src= "/img/loading.gif" data-src="https://gitee.com/xgpqq/tuchuang/raw/master/img/image-20200417152534782.png" alt="image-20200417152534782"></p>
<h4 id="urls-py-规则修改为如下形式："><a href="http://urls.py" target="_blank" rel="noopener">urls.py</a> 规则修改为如下形式：</h4>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre class=" language-hljs python"><span class="hljs-comment">#/HelloWorld/HelloWorld/urls.py 文件代码：</span><br><span class="hljs-keyword">from</span> django.contrib <span class="hljs-keyword">import</span> admin<br><span class="hljs-keyword">from</span> django.urls <span class="hljs-keyword">import</span> path<br><span class="hljs-keyword">from</span> . <span class="hljs-keyword">import</span> testdb<br><span class="hljs-keyword">from</span> . <span class="hljs-keyword">import</span> search<br><br>urlpatterns = [<br>    path(<span class="hljs-string">'admin/'</span>, admin.site.urls),<br>    path(<span class="hljs-string">'testdb/'</span>, testdb.testdb),<br>    path(<span class="hljs-string">'gitdb/'</span>, testdb.getdb),<br>    path(<span class="hljs-string">'modify/'</span>, testdb.modify),<br>    path(<span class="hljs-string">'del/'</span>, testdb.dl),<br>    path(<span class="hljs-string">'search/'</span>, search.search),<br>    path(<span class="hljs-string"><code class="language-hljs python"><span class="hljs-comment">#/HelloWorld/HelloWorld/urls.py 文件代码：</span><br><span class="hljs-keyword">from</span> django.contrib <span class="hljs-keyword">import</span> admin<br><span class="hljs-keyword">from</span> django.urls <span class="hljs-keyword">import</span> path<br><span class="hljs-keyword">from</span> . <span class="hljs-keyword">import</span> testdb<br><span class="hljs-keyword">from</span> . <span class="hljs-keyword">import</span> search<br><br>urlpatterns = [<br>    path(<span class="hljs-string">'admin/'</span>, admin.site.urls),<br>    path(<span class="hljs-string">'testdb/'</span>, testdb.testdb),<br>    path(<span class="hljs-string">'gitdb/'</span>, testdb.getdb),<br>    path(<span class="hljs-string">'modify/'</span>, testdb.modify),<br>    path(<span class="hljs-string">'del/'</span>, testdb.dl),<br>    path(<span class="hljs-string">'search/'</span>, search.search),<br>    path(<span class="hljs-string">'search-from/'</span>, search.search_form),<br>]<br></code></pre></td></tr></table></figure>
<h4 id="访问地址-http-127-0-0-1-8000-search-form-并搜索，结果如下所示">访问地址 <a href="http://127.0.0.1:8000/search-form" target="_blank" rel="noopener">http://127.0.0.1:8000/search-form</a> 并搜索，结果如下所示:</h4>
<p><img src= "/img/loading.gif" data-src="https://gitee.com/xgpqq/tuchuang/raw/master/img/image-20200417151517338.png" alt="image-20200417151517338"></p>
<p><img src= "/img/loading.gif" data-src="https://gitee.com/xgpqq/tuchuang/raw/master/img/image-20200417151524789.png" alt="image-20200417151524789"></p>
<h3 id="分析一下">分析一下</h3>
<p><img src= "/img/loading.gif" data-src="https://gitee.com/xgpqq/tuchuang/raw/master/img/image-20200417152614087.png" alt="image-20200417152614087"></p>
<p><img src= "/img/loading.gif" data-src="https://gitee.com/xgpqq/tuchuang/raw/master/img/image-20200417152643385.png" alt="image-20200417152643385"></p>
<h2 id="3、POST-方法">3、POST 方法</h2>
<p><strong>上面我们使用了GET方法。视图显示和请求处理分成两个函数处理。</strong></p>
<p><strong>提交数据时更常用POST方法。我们下面使用该方法，并用一个URL和处理函数，同时显示视图和处理请求。</strong></p>
<h4 id="我们在-templates-创建-post-html："><strong>我们在 templates 创建 post.html：</strong></h4>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre class=" language-hljs html">#/HelloWorld/templates/post.html 文件代码：<br><span class="hljs-meta">&lt;!DOCTYPE <span class="hljs-meta-keyword">html</span>&gt;</span><br><span class="hljs-tag">&lt;<span class="hljs-name">html</span>&gt;</span><br><span class="hljs-tag">&lt;<span class="hljs-name">head</span>&gt;</span><br><span class="hljs-tag">&lt;<span class="hljs-name">meta</span> <span class="hljs-attr">charset</span>=<span class="hljs-string">"utf-8"</span>&gt;</span><br><span class="hljs-tag">&lt;<span class="hljs-name">title</span>&gt;</span>xgp666<span class="hljs-tag">&lt;/<span class="hljs-name">title</span>&gt;</span><br><span class="hljs-tag">&lt;/<span class="hljs-name">head</span>&gt;</span><br><span class="hljs-tag">&lt;<span class="hljs-name">body</span>&gt;</span><br>    <span class="hljs-tag">&lt;<span class="hljs-name">form</span> <span class="hljs-attr">action</span>=<span class="hljs-string">"/search-post/"</span> <span class="hljs-attr">method</span>=<span class="hljs-string">"post"</span>&gt;</span><br>        &#123;% csrf_token %&#125;<br>        <span class="hljs-tag">&lt;<span class="hljs-name">input</span> <span class="hljs-attr">type</span>=<span class="hljs-string">"text"</span> <span class="hljs-attr">name</span>=<span class="hljs-string">"q"</span>&gt;</span><br>        <span class="hljs-tag">&lt;<span class="hljs-name">input</span> <span class="hljs-attr">type</span>=<span class="hljs-string">"submit"</span> <span class="hljs-attr">value</span>=<span class="hljs-string">"Submit"</span>&gt;</span><br>    <span class="hljs-tag">&lt;/<span class="hljs-name">form</span>&gt;</span><br> <br>    <span class="hljs-tag">&lt;<span class="hljs-name">p</span>&gt;</span>&#123;&#123; rlt &#125;&#125;<span class="hljs-tag">&lt;/<span class="hljs-name">p</span>&gt;</span><br><span class="hljs-tag">&lt;/<span class="hljs-name">body</span>&gt;</span><br><span class="hljs-tag">&lt;/<span class="hljs-name"><code class="language-hljs html">#/HelloWorld/templates/post.html 文件代码：<br><span class="hljs-meta">&lt;!DOCTYPE <span class="hljs-meta-keyword">html</span>&gt;</span><br><span class="hljs-tag">&lt;<span class="hljs-name">html</span>&gt;</span><br><span class="hljs-tag">&lt;<span class="hljs-name">head</span>&gt;</span><br><span class="hljs-tag">&lt;<span class="hljs-name">meta</span> <span class="hljs-attr">charset</span>=<span class="hljs-string">"utf-8"</span>&gt;</span><br><span class="hljs-tag">&lt;<span class="hljs-name">title</span>&gt;</span>xgp666<span class="hljs-tag">&lt;/<span class="hljs-name">title</span>&gt;</span><br><span class="hljs-tag">&lt;/<span class="hljs-name">head</span>&gt;</span><br><span class="hljs-tag">&lt;<span class="hljs-name">body</span>&gt;</span><br>    <span class="hljs-tag">&lt;<span class="hljs-name">form</span> <span class="hljs-attr">action</span>=<span class="hljs-string">"/search-post/"</span> <span class="hljs-attr">method</span>=<span class="hljs-string">"post"</span>&gt;</span><br>        &#123;% csrf_token %&#125;<br>        <span class="hljs-tag">&lt;<span class="hljs-name">input</span> <span class="hljs-attr">type</span>=<span class="hljs-string">"text"</span> <span class="hljs-attr">name</span>=<span class="hljs-string">"q"</span>&gt;</span><br>        <span class="hljs-tag">&lt;<span class="hljs-name">input</span> <span class="hljs-attr">type</span>=<span class="hljs-string">"submit"</span> <span class="hljs-attr">value</span>=<span class="hljs-string">"Submit"</span>&gt;</span><br>    <span class="hljs-tag">&lt;/<span class="hljs-name">form</span>&gt;</span><br> <br>    <span class="hljs-tag">&lt;<span class="hljs-name">p</span>&gt;</span>&#123;&#123; rlt &#125;&#125;<span class="hljs-tag">&lt;/<span class="hljs-name">p</span>&gt;</span><br><span class="hljs-tag">&lt;/<span class="hljs-name">body</span>&gt;</span><br><span class="hljs-tag">&lt;/<span class="hljs-name">html</span>></span><br></code></pre></td></tr></table></figure>
<p><strong>在模板的末尾，我们增加一个 rlt 记号，为表格处理结果预留位置。</strong></p>
<p><strong>表格后面还有一个{% csrf_token %}的标签。csrf 全称是 Cross Site Request Forgery。这是Django提供的防止伪装提交请求的功能。POST 方法提交的表格，必须有此标签。</strong></p>
<h4 id="在HelloWorld目录下新建-search2-py-文件并使用-search-post-函数来处理-POST-请求："><strong>在HelloWorld目录下新建 <a href="http://search2.py" target="_blank" rel="noopener">search2.py</a> 文件并使用 search_post 函数来处理 POST 请求：</strong></h4>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre class=" language-hljs python"><span class="hljs-comment">#/HelloWorld/HelloWorld/search2.py 文件代码：</span><br><span class="hljs-comment"># -*- coding: utf-8 -*-</span><br> <br><span class="hljs-keyword">from</span> django.shortcuts <span class="hljs-keyword">import</span> render<br><span class="hljs-keyword">from</span> django.views.decorators <span class="hljs-keyword">import</span> csrf<br> <br><span class="hljs-comment"># 接收POST请求数据</span><br><span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">search_post</span><span class="hljs-params">(request)</span>:</span><br>    ctx =&#123;&#125;<br>    <span class="hljs-keyword">if</span> request.POST:<br>        ctx[<span class="hljs-string">'rlt'</span>] = request.POST[<span class="hljs-string">'q'</span>]<br>    <span class="hljs-keyword">return</span> render(request, <span class="hljs-string"><code class="language-hljs python"><span class="hljs-comment">#/HelloWorld/HelloWorld/search2.py 文件代码：</span><br><span class="hljs-comment"># -*- coding: utf-8 -*-</span><br> <br><span class="hljs-keyword">from</span> django.shortcuts <span class="hljs-keyword">import</span> render<br><span class="hljs-keyword">from</span> django.views.decorators <span class="hljs-keyword">import</span> csrf<br> <br><span class="hljs-comment"># 接收POST请求数据</span><br><span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">search_post</span><span class="hljs-params">(request)</span>:</span><br>    ctx =&#123;&#125;<br>    <span class="hljs-keyword">if</span> request.POST:<br>        ctx[<span class="hljs-string">'rlt'</span>] = request.POST[<span class="hljs-string">'q'</span>]<br>    <span class="hljs-keyword">return</span> render(request, <span class="hljs-string">"post.html"</span>, ctx)<br></code></pre></td></tr></table></figure>
<h4 id="urls-py-规则修改为如下形式：-2"><a href="http://urls.py" target="_blank" rel="noopener">urls.py</a> 规则修改为如下形式：</h4>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre class=" language-hljs python"><span class="hljs-comment">#/HelloWorld/HelloWorld/urls.py 文件代码：</span><br><span class="hljs-keyword">from</span> django.contrib <span class="hljs-keyword">import</span> admin<br><span class="hljs-keyword">from</span> django.urls <span class="hljs-keyword">import</span> path<br><span class="hljs-keyword">from</span> . <span class="hljs-keyword">import</span> testdb<br><span class="hljs-keyword">from</span> . <span class="hljs-keyword">import</span> search<br><span class="hljs-keyword">from</span> . <span class="hljs-keyword">import</span> search2<br><br>urlpatterns = [<br>    path(<span class="hljs-string">'admin/'</span>, admin.site.urls),<br>    path(<span class="hljs-string">'testdb/'</span>, testdb.testdb),<br>    path(<span class="hljs-string">'gitdb/'</span>, testdb.getdb),<br>    path(<span class="hljs-string">'modify/'</span>, testdb.modify),<br>    path(<span class="hljs-string">'del/'</span>, testdb.dl),<br>    path(<span class="hljs-string">'search/'</span>, search.search),<br>    path(<span class="hljs-string">'search-from/'</span>, search.search_form),<br>    path(<span class="hljs-string"><code class="language-hljs python"><span class="hljs-comment">#/HelloWorld/HelloWorld/urls.py 文件代码：</span><br><span class="hljs-keyword">from</span> django.contrib <span class="hljs-keyword">import</span> admin<br><span class="hljs-keyword">from</span> django.urls <span class="hljs-keyword">import</span> path<br><span class="hljs-keyword">from</span> . <span class="hljs-keyword">import</span> testdb<br><span class="hljs-keyword">from</span> . <span class="hljs-keyword">import</span> search<br><span class="hljs-keyword">from</span> . <span class="hljs-keyword">import</span> search2<br><br>urlpatterns = [<br>    path(<span class="hljs-string">'admin/'</span>, admin.site.urls),<br>    path(<span class="hljs-string">'testdb/'</span>, testdb.testdb),<br>    path(<span class="hljs-string">'gitdb/'</span>, testdb.getdb),<br>    path(<span class="hljs-string">'modify/'</span>, testdb.modify),<br>    path(<span class="hljs-string">'del/'</span>, testdb.dl),<br>    path(<span class="hljs-string">'search/'</span>, search.search),<br>    path(<span class="hljs-string">'search-from/'</span>, search.search_form),<br>    path(<span class="hljs-string">'search-post/'</span>, search2.search_post),<br>]<br></code></pre></td></tr></table></figure>
<h4 id="访问-http-127-0-0-1-8000-search-post-显示结果如下：">访问 <a href="http://127.0.0.1:8000/search-post" target="_blank" rel="noopener">http://127.0.0.1:8000/search-post</a> 显示结果如下：</h4>
<p><img src= "/img/loading.gif" data-src="https://gitee.com/xgpqq/tuchuang/raw/master/img/image-20200417152446910.png" alt="image-20200417152446910"></p>
<h2 id="3、Request-对象"><strong>3、Request 对象</strong></h2>
<h4 id="每个-view-函数的第一个参数是一个-HttpRequest-对象，就像下面这个-hello-函数"><strong>每个 view 函数的第一个参数是一个 HttpRequest 对象，就像下面这个 hello() 函数:</strong></h4>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre class=" language-hljs python"><span class="hljs-keyword">from</span> django.http <span class="hljs-keyword">import</span> HttpResponse<br><br><span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">hello</span><span class="hljs-params">(request)</span>:</span><br>    <span class="hljs-keyword">return</span> HttpResponse(<span class="hljs-string"><code class="language-hljs python"><span class="hljs-keyword">from</span> django.http <span class="hljs-keyword">import</span> HttpResponse<br><br><span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">hello</span><span class="hljs-params">(request)</span>:</span><br>    <span class="hljs-keyword">return</span> HttpResponse(<span class="hljs-string">"Hello world"</span>)<br></code></pre></td></tr></table></figure>
<h4 id="HttpRequest对象包含当前请求URL的一些信息："><strong>HttpRequest对象包含当前请求URL的一些信息：</strong></h4>
<table>
<thead>
<tr>
<th><strong>属性</strong></th>
<th><strong>描述</strong></th>
</tr>
</thead>
<tbody>
<tr>
<td><strong>path</strong></td>
<td><strong>请求页面的全路径,不包括域名—例如, “/hello/”。</strong></td>
</tr>
<tr>
<td><strong>method</strong></td>
<td><strong>请求中使用的HTTP方法的字符串表示。全大写表示。例如:if request.method == ‘GET’:   do_something() elif request.method == ‘POST’:   do_something_else()</strong></td>
</tr>
<tr>
<td><strong>GET</strong></td>
<td><strong>包含所有HTTP GET参数的类字典对象。参见QueryDict 文档。</strong></td>
</tr>
<tr>
<td><strong>POST</strong></td>
<td><strong>包含所有HTTP POST参数的类字典对象。参见QueryDict 文档。服务器收到空的POST请求的情况也是有可能发生的。也就是说，表单form通过HTTP POST方法提交请求，但是表单中可以没有数据。因此，不能使用语句if request.POST来判断是否使用HTTP POST方法；应该使用if request.method == “POST” (参见本表的method属性)。注意: POST不包括file-upload信息。参见FILES属性。</strong></td>
</tr>
<tr>
<td><strong>REQUEST</strong></td>
<td><strong>为了方便，该属性是POST和GET属性的集合体，但是有特殊性，先查找POST属性，然后再查找GET属性。借鉴PHP’s $_REQUEST。例如，如果GET = {“name”: “john”} 和POST = {“age”: ‘34’},则 REQUEST[“name”] 的值是&quot;john&quot;, REQUEST[“age”]的值是&quot;34&quot;.强烈建议使用GET and POST,因为这两个属性更加显式化，写出的代码也更易理解。</strong></td>
</tr>
<tr>
<td><strong>COOKIES</strong></td>
<td><strong>包含所有cookies的标准Python字典对象。Keys和values都是字符串。</strong></td>
</tr>
<tr>
<td><strong>FILES</strong></td>
<td><strong>包含所有上传文件的类字典对象。FILES中的每个Key都是<input type="file" name="" />标签中name属性的值. FILES中的每个value 同时也是一个标准Python字典对象，包含下面三个Keys:filename: 上传文件名,用Python字符串表示content-type: 上传文件的Content typecontent: 上传文件的原始内容注意：只有在请求方法是POST，并且请求页面中<form>有enctype=&quot;multipart/form-data&quot;属性时FILES才拥有数据。否则，FILES 是一个空字典。</strong></td>
</tr>
<tr>
<td><strong>META</strong></td>
<td><strong>包含所有可用HTTP头部信息的字典。 例如:CONTENT_LENGTHCONTENT_TYPEQUERY_STRING: 未解析的原始查询字符串REMOTE_ADDR: 客户端IP地址REMOTE_HOST: 客户端主机名SERVER_NAME: 服务器主机名SERVER_PORT: 服务器端口META 中这些头加上前缀 HTTP_ 为 Key, 冒号(:)后面的为 Value， 例如:HTTP_ACCEPT_ENCODINGHTTP_ACCEPT_LANGUAGEHTTP_HOST: 客户发送的HTTP主机头信息HTTP_REFERER: referring页HTTP_USER_AGENT: 客户端的user-agent字符串HTTP_X_BENDER: X-Bender头信息</strong></td>
</tr>
<tr>
<td><strong>user</strong></td>
<td><strong>是一个django.contrib.auth.models.User 对象，代表当前登录的用户。如果访问用户当前没有登录，user将被初始化为django.contrib.auth.models.AnonymousUser的实例。你可以通过user的is_authenticated()方法来辨别用户是否登录：<code>if request.user.is_authenticated():    # Do something for logged-in users. else:    # Do something for anonymous users.</code>只有激活Django中的AuthenticationMiddleware时该属性才可用</strong></td>
</tr>
<tr>
<td><strong>session</strong></td>
<td><strong>唯一可读写的属性，代表当前会话的字典对象。只有激活Django中的session支持时该属性才可用。</strong></td>
</tr>
<tr>
<td><strong>raw_post_data</strong></td>
<td><strong>原始HTTP POST数据，未解析过。 高级处理时会有用处。</strong></td>
</tr>
</tbody>
</table>
<h4 id="Request对象也有一些有用的方法："><strong>Request对象也有一些有用的方法：</strong></h4>
<table>
<thead>
<tr>
<th style="text-align:left"><strong>方法</strong></th>
<th style="text-align:left"><strong>描述</strong></th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:left"><strong>getitem(key)</strong></td>
<td style="text-align:left"><strong>返回GET/POST的键值,先取POST,后取GET。如果键不存在抛出 KeyError。 这是我们可以使用字典语法访问HttpRequest对象。 例如,request[“foo”]等同于先request.POST[“foo”] 然后 request.GET[“foo”]的操作。</strong></td>
</tr>
<tr>
<td style="text-align:left"><strong>has_key()</strong></td>
<td style="text-align:left"><strong>检查request.GET or request.POST中是否包含参数指定的Key。</strong></td>
</tr>
<tr>
<td style="text-align:left"><strong>get_full_path()</strong></td>
<td style="text-align:left"><strong>返回包含查询字符串的请求路径。例如， &quot;/music/bands/the_beatles/?print=true&quot;</strong></td>
</tr>
<tr>
<td style="text-align:left"><strong>is_secure()</strong></td>
<td style="text-align:left"><strong>如果请求是安全的，返回True，就是说，发出的是HTTPS请求。</strong></td>
</tr>
</tbody>
</table>
<h2 id="4、QueryDict对象"><strong>4、QueryDict对象</strong></h2>
<p><strong>在HttpRequest对象中, GET和POST属性是django.http.QueryDict类的实例。</strong></p>
<p><strong>QueryDict类似字典的自定义类，用来处理单键对应多值的情况。</strong></p>
<h4 id="QueryDict实现所有标准的词典方法。还包括一些特有的方法："><strong>QueryDict实现所有标准的词典方法。还包括一些特有的方法：</strong></h4>
<table>
<thead>
<tr>
<th style="text-align:left"><strong>方法</strong></th>
<th style="text-align:left"><strong>描述</strong></th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:left"><strong>getitem</strong></td>
<td style="text-align:left"><strong>和标准字典的处理有一点不同，就是，如果Key对应多个Value，getitem()返回最后一个value。</strong></td>
</tr>
<tr>
<td style="text-align:left"><strong>setitem</strong></td>
<td style="text-align:left"><strong>设置参数指定key的value列表(一个Python list)。注意：它只能在一个mutable QueryDict 对象上被调用(就是通过copy()产生的一个QueryDict对象的拷贝).</strong></td>
</tr>
<tr>
<td style="text-align:left"><strong>get()</strong></td>
<td style="text-align:left"><strong>如果key对应多个value，get()返回最后一个value。</strong></td>
</tr>
<tr>
<td style="text-align:left"><strong>update()</strong></td>
<td style="text-align:left"><strong>参数可以是QueryDict，也可以是标准字典。和标准字典的update方法不同，该方法添加字典 items，而不是替换它们:<code>&gt;&gt;&gt; q = QueryDict('a=1') &gt;&gt;&gt; q = q.copy() # to make it mutable &gt;&gt;&gt; q.update({'a': '2'}) &gt;&gt;&gt; q.getlist('a')  ['1', '2'] &gt;&gt;&gt; q['a'] # returns the last ['2']</code></strong></td>
</tr>
<tr>
<td style="text-align:left"><strong>items()</strong></td>
<td style="text-align:left"><strong>和标准字典的items()方法有一点不同,该方法使用单值逻辑的getitem():<code>&gt;&gt;&gt; q = QueryDict('a=1&amp;a=2&amp;a=3') &gt;&gt;&gt; q.items() [('a', '3')]</code></strong></td>
</tr>
<tr>
<td style="text-align:left"><strong>values()</strong></td>
<td style="text-align:left"><strong>和标准字典的values()方法有一点不同,该方法使用单值逻辑的getitem():</strong></td>
</tr>
</tbody>
</table>
<h4 id="此外-QueryDict也有一些方法，如下表："><strong>此外, QueryDict也有一些方法，如下表：</strong></h4>
<table>
<thead>
<tr>
<th style="text-align:left"><strong>方法</strong></th>
<th style="text-align:left"><strong>描述</strong></th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:left"><strong>copy()</strong></td>
<td style="text-align:left"><strong>返回对象的拷贝，内部实现是用Python标准库的copy.deepcopy()。该拷贝是mutable(可更改的) — 就是说，可以更改该拷贝的值。</strong></td>
</tr>
<tr>
<td style="text-align:left"><strong>getlist(key)</strong></td>
<td style="text-align:left"><strong>返回和参数key对应的所有值，作为一个Python list返回。如果key不存在，则返回空list。 It’s guaranteed to return a list of some sort…</strong></td>
</tr>
<tr>
<td style="text-align:left"><strong>setlist(key,list_)</strong></td>
<td style="text-align:left"><strong>设置key的值为list_ (unlike setitem()).</strong></td>
</tr>
<tr>
<td style="text-align:left"><strong>appendlist(key,item)</strong></td>
<td style="text-align:left"><strong>添加item到和key关联的内部list.</strong></td>
</tr>
<tr>
<td style="text-align:left"><strong>setlistdefault(key,list)</strong></td>
<td style="text-align:left"><strong>和setdefault有一点不同，它接受list而不是单个value作为参数。</strong></td>
</tr>
<tr>
<td style="text-align:left"><strong>lists()</strong></td>
<td style="text-align:left"><strong>和items()有一点不同, 它会返回key的所有值，作为一个list, 例如:<code>&gt;&gt;&gt; q = QueryDict('a=1&amp;a=2&amp;a=3') &gt;&gt;&gt; q.lists() [('a', ['1', '2', '3'])] </code></strong></td>
</tr>
<tr>
<td style="text-align:left"><strong>urlencode()</strong></td>
<td style="text-align:left"><strong>返回一个以查询字符串格式进行格式化后的字符串(例如：“a=2&amp;b=3&amp;b=5”)。</strong></td>
</tr>
</tbody>
</table>
<h1>四、Django Admin 管理工具</h1>
<p><strong>Django 提供了基于 web 的管理工具。</strong></p>
<p><strong>Django 自动管理工具是 django.contrib 的一部分。你可以在项目的 <a href="http://settings.py" target="_blank" rel="noopener">settings.py</a> 中的 INSTALLED_APPS 看到它：</strong></p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre class=" language-hljs python"><span class="hljs-comment">#/HelloWorld/HelloWorld/settings.py 文件代码：</span><br>INSTALLED_APPS = (<br>    <span class="hljs-string">'django.contrib.admin'</span>,<br>    <span class="hljs-string">'django.contrib.auth'</span>,<br>    <span class="hljs-string">'django.contrib.contenttypes'</span>,<br>    <span class="hljs-string">'django.contrib.sessions'</span>,<br>    <span class="hljs-string">'django.contrib.messages'</span>,<br>    <span class="hljs-string"><code class="language-hljs python"><span class="hljs-comment">#/HelloWorld/HelloWorld/settings.py 文件代码：</span><br>INSTALLED_APPS = (<br>    <span class="hljs-string">'django.contrib.admin'</span>,<br>    <span class="hljs-string">'django.contrib.auth'</span>,<br>    <span class="hljs-string">'django.contrib.contenttypes'</span>,<br>    <span class="hljs-string">'django.contrib.sessions'</span>,<br>    <span class="hljs-string">'django.contrib.messages'</span>,<br>    <span class="hljs-string">'django.contrib.staticfiles'</span>,<br>)<br></code></pre></td></tr></table></figure>
<p><strong>django.contrib是一套庞大的功能集，它是Django基本代码的组成部分。</strong></p>
<h2 id="1、激活管理工具">1、激活管理工具</h2>
<p><strong>通常我们在生成项目时会在 <a href="http://urls.py" target="_blank" rel="noopener">urls.py</a> 中自动设置好，我们只需去掉注释即可。</strong></p>
<p><strong>配置项如下所示：</strong></p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre class=" language-hljs python"><span class="hljs-comment">#/HelloWorld/HelloWorld/urls.py 文件代码：</span><br><span class="hljs-keyword">from</span> django.contrib <span class="hljs-keyword">import</span> admin<br><span class="hljs-keyword">from</span> django.urls <span class="hljs-keyword">import</span> path<br><span class="hljs-keyword">from</span> . <span class="hljs-keyword">import</span> testdb<br><span class="hljs-keyword">from</span> . <span class="hljs-keyword">import</span> search<br><span class="hljs-keyword">from</span> . <span class="hljs-keyword">import</span> search2<br><br>urlpatterns = [<br>    path(<span class="hljs-string">'admin/'</span>, admin.site.urls),<br>    path(<span class="hljs-string">'testdb/'</span>, testdb.testdb),<br>    path(<span class="hljs-string">'gitdb/'</span>, testdb.getdb),<br>    path(<span class="hljs-string">'modify/'</span>, testdb.modify),<br>    path(<span class="hljs-string">'del/'</span>, testdb.dl),<br>    path(<span class="hljs-string">'search/'</span>, search.search),<br>    path(<span class="hljs-string">'search-from/'</span>, search.search_form),<br>    path(<span class="hljs-string"><code class="language-hljs python"><span class="hljs-comment">#/HelloWorld/HelloWorld/urls.py 文件代码：</span><br><span class="hljs-keyword">from</span> django.contrib <span class="hljs-keyword">import</span> admin<br><span class="hljs-keyword">from</span> django.urls <span class="hljs-keyword">import</span> path<br><span class="hljs-keyword">from</span> . <span class="hljs-keyword">import</span> testdb<br><span class="hljs-keyword">from</span> . <span class="hljs-keyword">import</span> search<br><span class="hljs-keyword">from</span> . <span class="hljs-keyword">import</span> search2<br><br>urlpatterns = [<br>    path(<span class="hljs-string">'admin/'</span>, admin.site.urls),<br>    path(<span class="hljs-string">'testdb/'</span>, testdb.testdb),<br>    path(<span class="hljs-string">'gitdb/'</span>, testdb.getdb),<br>    path(<span class="hljs-string">'modify/'</span>, testdb.modify),<br>    path(<span class="hljs-string">'del/'</span>, testdb.dl),<br>    path(<span class="hljs-string">'search/'</span>, search.search),<br>    path(<span class="hljs-string">'search-from/'</span>, search.search_form),<br>    path(<span class="hljs-string">'search-post/'</span>, search2.search_post),<br>]<br></code></pre></td></tr></table></figure>
<p><strong>当这一切都配置好后，Django 管理工具就可以运行了。</strong></p>
<h2 id="2、使用管理工具">2、使用管理工具</h2>
<p><strong>启动开发服务器，然后在浏览器中访问 <a href="http://127.0.0.1:8000/admin/%EF%BC%8C%E5%BE%97%E5%88%B0%E5%A6%82%E4%B8%8B%E7%95%8C%E9%9D%A2%EF%BC%9A" target="_blank" rel="noopener">http://127.0.0.1:8000/admin/，得到如下界面：</a></strong></p>
<p><img src= "/img/loading.gif" data-src="https://gitee.com/xgpqq/tuchuang/raw/master/img/image-20200417154111687.png" alt="image-20200417154111687"></p>
<h4 id="因为我现在是新建了个项目所以需要创建表结构：">因为我现在是新建了个项目所以需要创建表结构：</h4>
<figure class="highlight cmd"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre class=" language-hljs cmd"><code class="language-hljs cmd">$ python manage.py migrate   # 创建表结构<br>//失败了可用python3 manage.py migrate<br><br>$ python manage.py makemigrations TestModel  # 让 Django 知道我们在我们的模型有一些变更<br>$ python manage.py migrate TestModel   # 创建表结构<br></code></pre></td></tr></table></figure>
<h4 id="你可以通过命令-python-manage-py-createsuperuser-来创建超级用户，如下所示：">你可以通过命令 <strong>python <a href="http://manage.py" target="_blank" rel="noopener">manage.py</a> createsuperuser</strong> 来创建超级用户，如下所示：</h4>
<figure class="highlight cmd"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre class=" language-hljs cmd"># python manage.py createsuperuser<br>Username (leave blank to use 'root'): admin<br>Email address: admin@runoob.com<br><span class="hljs-function">Password:</span><br><span class="hljs-function"><span class="hljs-title">Password</span> (<span class="hljs-title">again</span>):</span><br><span class="hljs-function"><span class="hljs-title">Superuser</span> <span class="hljs-title">created</span> <span class="hljs-title"><code class="language-hljs cmd"># python manage.py createsuperuser<br>Username (leave blank to use 'root'): admin<br>Email address: admin@runoob.com<br><span class="hljs-function">Password:</span><br><span class="hljs-function"><span class="hljs-title">Password</span> (<span class="hljs-title">again</span>):</span><br><span class="hljs-function"><span class="hljs-title">Superuser</span> <span class="hljs-title">created</span> <span class="hljs-title">successfully</span>.</span><br></code></pre></td></tr></table></figure>
<h4 id="之后输入用户名密码登录，界面如下：">之后输入用户名密码登录，界面如下：</h4>
<p><img src= "/img/loading.gif" data-src="https://gitee.com/xgpqq/tuchuang/raw/master/img/image-20200417155335794.png" alt="image-20200417155335794"></p>
<h4 id="models-py文件添加类型">models.py文件添加类型</h4>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre class=" language-hljs python"><span class="hljs-comment">#XGPtest/TestModel/models.py</span><br><span class="hljs-keyword">from</span> django.db <span class="hljs-keyword">import</span> models<br> <br><span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">Test</span><span class="hljs-params">(models.Model)</span>:</span><br>    name = models.CharField(max_length=<span class="hljs-number"><code class="language-hljs python"><span class="hljs-comment">#XGPtest/TestModel/models.py</span><br><span class="hljs-keyword">from</span> django.db <span class="hljs-keyword">import</span> models<br> <br><span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">Test</span><span class="hljs-params">(models.Model)</span>:</span><br>    name = models.CharField(max_length=<span class="hljs-number">20</span>)<br></code></pre></td></tr></table></figure>
<p><em><strong>创建完成之后，数据库中就生成testmodel_test表</strong></em></p>
<h4 id="为了让-admin-界面管理某个数据模型，我们需要先注册该数据模型到-admin。比如，我们之前在-TestModel-中已经创建了模型-Test-。修改-TestModel-admin-py">为了让 admin 界面管理某个数据模型，我们需要先注册该数据模型到 admin。比如，我们之前在 TestModel 中已经创建了模型 Test 。修改 TestModel/admin.py:</h4>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre class=" language-hljs python"><span class="hljs-comment">#HelloWorld/TestModel/admin.py: 文件代码：</span><br><span class="hljs-keyword">from</span> django.contrib <span class="hljs-keyword">import</span> admin<br><span class="hljs-keyword">from</span>. models <span class="hljs-keyword">import</span> Test<br><br><span class="hljs-comment"><code class="language-hljs python"><span class="hljs-comment">#HelloWorld/TestModel/admin.py: 文件代码：</span><br><span class="hljs-keyword">from</span> django.contrib <span class="hljs-keyword">import</span> admin<br><span class="hljs-keyword">from</span>. models <span class="hljs-keyword">import</span> Test<br><br><span class="hljs-comment"># Register your models here.</span><br>admin.site.register(Test)<br></code></pre></td></tr></table></figure>
<h5 id="刷新后即可看到-Testmodel-数据表">刷新后即可看到 Testmodel 数据表:</h5>
<p><img src= "/img/loading.gif" data-src="https://gitee.com/xgpqq/tuchuang/raw/master/img/image-20200417155913316.png" alt="image-20200417155913316"></p>
<p><img src= "/img/loading.gif" data-src="https://gitee.com/xgpqq/tuchuang/raw/master/img/image-20200418105501617.png" alt="image-20200418105501617"></p>
<p><em><strong>可以简单的添加、修改、删除。</strong></em></p>
<h2 id="3、使用管理工具添加一个用户">3、使用管理工具添加一个用户</h2>
<p><img src= "/img/loading.gif" data-src="https://gitee.com/xgpqq/tuchuang/raw/master/img/image-20200417160738745.png" alt="image-20200417160738745"></p>
<p><img src= "/img/loading.gif" data-src="https://gitee.com/xgpqq/tuchuang/raw/master/img/image-20200417160851085.png" alt="image-20200417160851085"></p>
<p><img src= "/img/loading.gif" data-src="https://gitee.com/xgpqq/tuchuang/raw/master/img/image-20200417160938480.png" alt="image-20200417160938480"></p>
<p><img src= "/img/loading.gif" data-src="https://gitee.com/xgpqq/tuchuang/raw/master/img/image-20200417161058691.png" alt="image-20200417161058691"></p>
<p><img src= "/img/loading.gif" data-src="https://gitee.com/xgpqq/tuchuang/raw/master/img/image-20200417161110515.png" alt="image-20200417161110515"></p>
<p><img src= "/img/loading.gif" data-src="https://gitee.com/xgpqq/tuchuang/raw/master/img/image-20200417161131331.png" alt="image-20200417161131331"></p>
<p><img src= "/img/loading.gif" data-src="https://gitee.com/xgpqq/tuchuang/raw/master/img/image-20200417161211723.png" alt="image-20200417161211723"></p>
<h2 id="4、复杂模型">4、复杂模型</h2>
<p><strong>管理页面的功能强大，完全有能力处理更加复杂的数据模型。</strong></p>
<p><strong>先在 TestModel/models.py 中增加一个更复杂的数据模型：</strong></p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre class=" language-hljs python"><span class="hljs-keyword">from</span> django.db <span class="hljs-keyword">import</span> models<br> <br><span class="hljs-comment"># Create your models here.</span><br><span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">Test</span><span class="hljs-params">(models.Model)</span>:</span><br>    name = models.CharField(max_length=<span class="hljs-number">20</span>)<br> <br><span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">Contact</span><span class="hljs-params">(models.Model)</span>:</span><br>    name   = models.CharField(max_length=<span class="hljs-number">20</span>)<br>    age    = models.IntegerField(default=<span class="hljs-number">0</span>)<br>    email  = models.EmailField()<br>    <span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">__unicode__</span><span class="hljs-params">(self)</span>:</span><br>        <span class="hljs-keyword">return</span> self.name<br> <br><span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">Tag</span><span class="hljs-params">(models.Model)</span>:</span><br>    contact = models.ForeignKey(Contact, on_delete=models.CASCADE,)<br>    name    = models.CharField(max_length=<span class="hljs-number">50</span>)<br>    <span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">__unicode__</span><span class="hljs-params">(self)</span>:</span><br>        <span class="hljs-keyword"><code class="language-hljs python"><span class="hljs-keyword">from</span> django.db <span class="hljs-keyword">import</span> models<br> <br><span class="hljs-comment"># Create your models here.</span><br><span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">Test</span><span class="hljs-params">(models.Model)</span>:</span><br>    name = models.CharField(max_length=<span class="hljs-number">20</span>)<br> <br><span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">Contact</span><span class="hljs-params">(models.Model)</span>:</span><br>    name   = models.CharField(max_length=<span class="hljs-number">20</span>)<br>    age    = models.IntegerField(default=<span class="hljs-number">0</span>)<br>    email  = models.EmailField()<br>    <span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">__unicode__</span><span class="hljs-params">(self)</span>:</span><br>        <span class="hljs-keyword">return</span> self.name<br> <br><span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">Tag</span><span class="hljs-params">(models.Model)</span>:</span><br>    contact = models.ForeignKey(Contact, on_delete=models.CASCADE,)<br>    name    = models.CharField(max_length=<span class="hljs-number">50</span>)<br>    <span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">__unicode__</span><span class="hljs-params">(self)</span>:</span><br>        <span class="hljs-keyword">return</span> self.name<br></code></pre></td></tr></table></figure>
<p><strong>这里有两个表。Tag 以 Contact 为外部键。一个 Contact 可以对应多个 Tag。</strong></p>
<p><strong>我们还可以看到许多在之前没有见过的属性类型，比如 IntegerField 用于存储整数。</strong></p>
<p><img src= "/img/loading.gif" data-src="https://gitee.com/xgpqq/tuchuang/raw/master/img/image-20200417161438555.png" alt="image-20200417161438555"></p>
<h5 id="在-TestModel-admin-py-注册多个模型并显示："><strong>在 TestModel/admin.py 注册多个模型并显示：</strong></h5>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre class=" language-hljs python"><span class="hljs-keyword">from</span> django.contrib <span class="hljs-keyword">import</span> admin<br><span class="hljs-keyword">from</span> TestModel.models <span class="hljs-keyword">import</span> Test,Contact,Tag<br><br><span class="hljs-comment"><code class="language-hljs python"><span class="hljs-keyword">from</span> django.contrib <span class="hljs-keyword">import</span> admin<br><span class="hljs-keyword">from</span> TestModel.models <span class="hljs-keyword">import</span> Test,Contact,Tag<br><br><span class="hljs-comment"># Register your models here.</span><br>admin.site.register([Test, Contact, Tag])<br></code></pre></td></tr></table></figure>
<h4 id="刷新管理页面，显示结果如下：">刷新管理页面，显示结果如下：</h4>
<p><img src= "/img/loading.gif" data-src="https://gitee.com/xgpqq/tuchuang/raw/master/img/image-20200417161612003.png" alt="image-20200417161612003"></p>
<p><em><strong>在以上管理工具我们就能进行复杂模型操作。</strong></em></p>
<blockquote>
<p><strong>如果你之前还未创建表结构，可使用以下命令创建：</strong></p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre class=" language-hljs python">$ python manage.py makemigrations TestModel  <span class="hljs-comment"># 让 Django 知道我们在我们的模型有一些变更</span><br>$ python manage.py migrate TestModel   <span class="hljs-comment"><code class="language-hljs python">$ python manage.py makemigrations TestModel  <span class="hljs-comment"># 让 Django 知道我们在我们的模型有一些变更</span><br>$ python manage.py migrate TestModel   <span class="hljs-comment"># 创建表结构</span><br></code></pre></td></tr></table></figure>
<p>**<em>数据库会生成新的表单<code>testmodel tag</code>和</em><code>testmodel Contacts</code>)</p>
</blockquote>
<h2 id="5、自定义表单">5、自定义表单</h2>
<p><strong>我们可以自定义管理页面，来取代默认的页面。比如上面的 “add” 页面。我们想只显示 name 和 email 部分。修改 TestModel/admin.py:</strong></p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre class=" language-hljs python"><span class="hljs-comment">#HelloWorld/TestModel/admin.py: 文件代码：</span><br><span class="hljs-keyword">from</span> django.contrib <span class="hljs-keyword">import</span> admin<br><span class="hljs-keyword">from</span> . models <span class="hljs-keyword">import</span> Test,Contact,Tag<br><br><span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">ContactAdmin</span><span class="hljs-params">(admin.ModelAdmin)</span>:</span><br>    fields = (<span class="hljs-string">'name'</span>, <span class="hljs-string">'email'</span>)<br><br><span class="hljs-comment"><code class="language-hljs python"><span class="hljs-comment">#HelloWorld/TestModel/admin.py: 文件代码：</span><br><span class="hljs-keyword">from</span> django.contrib <span class="hljs-keyword">import</span> admin<br><span class="hljs-keyword">from</span> . models <span class="hljs-keyword">import</span> Test,Contact,Tag<br><br><span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">ContactAdmin</span><span class="hljs-params">(admin.ModelAdmin)</span>:</span><br>    fields = (<span class="hljs-string">'name'</span>, <span class="hljs-string">'email'</span>)<br><br><span class="hljs-comment"># Register your models here.</span><br>admin.site.register(Contact, ContactAdmin)<br>admin.site.register([Test, Tag])<br></code></pre></td></tr></table></figure>
<p><strong>以上代码定义了一个 ContactAdmin 类，用以说明管理页面的显示格式。</strong></p>
<p><strong>里面的 fields 属性定义了要显示的字段。</strong></p>
<p><strong>由于该类对应的是 Contact 数据模型，我们在注册的时候，需要将它们一起注册。显示效果如下：</strong></p>
<p><img src= "/img/loading.gif" data-src="https://gitee.com/xgpqq/tuchuang/raw/master/img/image-20200417162438916.png" alt="image-20200417162438916"></p>
<p><img src= "/img/loading.gif" data-src="https://gitee.com/xgpqq/tuchuang/raw/master/img/image-20200417162558100.png" alt="image-20200417162558100"></p>
<h4 id="我们还可以将输入栏分块，每个栏也可以定义自己的格式。修改-TestModel-admin-py为：">我们还可以将输入栏分块，每个栏也可以定义自己的格式。修改 TestModel/admin.py为：</h4>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre class=" language-hljs python"><span class="hljs-keyword">from</span> django.contrib <span class="hljs-keyword">import</span> admin<br><span class="hljs-keyword">from</span> TestModel.models <span class="hljs-keyword">import</span> Test, Contact, Tag<br><br><br><span class="hljs-comment"># Register your models here.</span><br><span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">ContactAdmin</span><span class="hljs-params">(admin.ModelAdmin)</span>:</span><br>    fieldsets = (<br>        [<span class="hljs-string">'Main'</span>, &#123;<br>            <span class="hljs-string">'fields'</span>: (<span class="hljs-string">'name'</span>, <span class="hljs-string">'email'</span>),<br>        &#125;],<br>        [<span class="hljs-string">'Advance'</span>, &#123;<br>            <span class="hljs-string">'classes'</span>: (<span class="hljs-string">'collapse'</span>,),  <span class="hljs-comment"># CSS</span><br>            <span class="hljs-string">'fields'</span>: (<span class="hljs-string"><code class="language-hljs python"><span class="hljs-keyword">from</span> django.contrib <span class="hljs-keyword">import</span> admin<br><span class="hljs-keyword">from</span> TestModel.models <span class="hljs-keyword">import</span> Test, Contact, Tag<br><br><br><span class="hljs-comment"># Register your models here.</span><br><span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">ContactAdmin</span><span class="hljs-params">(admin.ModelAdmin)</span>:</span><br>    fieldsets = (<br>        [<span class="hljs-string">'Main'</span>, &#123;<br>            <span class="hljs-string">'fields'</span>: (<span class="hljs-string">'name'</span>, <span class="hljs-string">'email'</span>),<br>        &#125;],<br>        [<span class="hljs-string">'Advance'</span>, &#123;<br>            <span class="hljs-string">'classes'</span>: (<span class="hljs-string">'collapse'</span>,),  <span class="hljs-comment"># CSS</span><br>            <span class="hljs-string">'fields'</span>: (<span class="hljs-string">'age'</span>,),<br>        &#125;]<br>    )<br><br><br>admin.site.register(Contact, ContactAdmin)<br>admin.site.register([Test, Tag])<br></code></pre></td></tr></table></figure>
<h4 id="上面的栏目分为了-Main-和-Advance-两部分。classes-说明它所在的部分的-CSS-格式。这里让-Advance-部分隐藏：">上面的栏目分为了 Main 和 Advance 两部分。classes 说明它所在的部分的 CSS 格式。这里让 Advance 部分隐藏：</h4>
<p><img src= "/img/loading.gif" data-src="https://gitee.com/xgpqq/tuchuang/raw/master/img/image-20200417162947876.png" alt="image-20200417162947876"></p>
<h4 id="Advance-部分旁边有一个-Show-按钮，用于展开，展开后可点击-Hide-将其隐藏，如下图所示：">Advance 部分旁边有一个 Show 按钮，用于展开，展开后可点击 Hide 将其隐藏，如下图所示：</h4>
<p><img src= "/img/loading.gif" data-src="https://gitee.com/xgpqq/tuchuang/raw/master/img/image-20200417162916369.png" alt="image-20200417162916369"></p>
<h2 id="6、内联-Inline-显示">6、内联(Inline)显示</h2>
<p><strong>上面的 Contact 是 Tag 的外部键，所以有外部参考的关系。</strong></p>
<p><strong>而在默认的页面显示中，将两者分离开来，无法体现出两者的从属关系。我们可以使用内联显示，让 Tag 附加在 Contact 的编辑页面上显示。</strong></p>
<p><strong>修改TestModel/admin.py：</strong></p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre class=" language-hljs python"><span class="hljs-keyword">from</span> django.contrib <span class="hljs-keyword">import</span> admin<br><span class="hljs-keyword">from</span> TestModel.models <span class="hljs-keyword">import</span> Test, Contact, Tag<br><br><br><span class="hljs-comment"># Register your models here.</span><br><span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">TagInline</span><span class="hljs-params">(admin.TabularInline)</span>:</span><br>    model = Tag<br><br><br><span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">ContactAdmin</span><span class="hljs-params">(admin.ModelAdmin)</span>:</span><br>    inlines = [TagInline]  <span class="hljs-comment"># Inline</span><br>    fieldsets = (<br>        [<span class="hljs-string">'Main'</span>, &#123;<br>            <span class="hljs-string">'fields'</span>: (<span class="hljs-string">'name'</span>, <span class="hljs-string">'email'</span>),<br>        &#125;],<br>        [<span class="hljs-string">'Advance'</span>, &#123;<br>            <span class="hljs-string">'classes'</span>: (<span class="hljs-string">'collapse'</span>,),<br>            <span class="hljs-string">'fields'</span>: (<span class="hljs-string"><code class="language-hljs python"><span class="hljs-keyword">from</span> django.contrib <span class="hljs-keyword">import</span> admin<br><span class="hljs-keyword">from</span> TestModel.models <span class="hljs-keyword">import</span> Test, Contact, Tag<br><br><br><span class="hljs-comment"># Register your models here.</span><br><span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">TagInline</span><span class="hljs-params">(admin.TabularInline)</span>:</span><br>    model = Tag<br><br><br><span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">ContactAdmin</span><span class="hljs-params">(admin.ModelAdmin)</span>:</span><br>    inlines = [TagInline]  <span class="hljs-comment"># Inline</span><br>    fieldsets = (<br>        [<span class="hljs-string">'Main'</span>, &#123;<br>            <span class="hljs-string">'fields'</span>: (<span class="hljs-string">'name'</span>, <span class="hljs-string">'email'</span>),<br>        &#125;],<br>        [<span class="hljs-string">'Advance'</span>, &#123;<br>            <span class="hljs-string">'classes'</span>: (<span class="hljs-string">'collapse'</span>,),<br>            <span class="hljs-string">'fields'</span>: (<span class="hljs-string">'age'</span>,),<br>        &#125;]<br>        <br>admin.site.register(Contact, ContactAdmin)<br>admin.site.register([Test, Tag])<br></code></pre></td></tr></table></figure>
<h5 id="显示效果如下：">显示效果如下：</h5>
<p><img src= "/img/loading.gif" data-src="https://gitee.com/xgpqq/tuchuang/raw/master/img/image-20200417163454194.png" alt="image-20200417163454194"></p>
<h2 id="7、列表页的显示">7、列表页的显示</h2>
<p><strong>在 Contact 输入数条记录后，Contact 的列表页看起来如下:</strong></p>
<p><img src= "/img/loading.gif" data-src="https://gitee.com/xgpqq/tuchuang/raw/master/img/image-20200417164137321.png" alt="image-20200417164137321"></p>
<p><strong>我们也可以自定义该页面的显示，比如在列表中显示更多的栏目，只需要在 ContactAdmin 中增加 list_display 属性:</strong></p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre class=" language-hljs python"><span class="hljs-comment">#HelloWorld/TestModel/admin.py: 文件代码：</span><br><span class="hljs-keyword">from</span> django.contrib <span class="hljs-keyword">import</span> admin<br><span class="hljs-keyword">from</span> TestModel.models <span class="hljs-keyword">import</span> Test,Contact,Tag<br> <br><span class="hljs-comment"># Register your models here.</span><br><span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">TagInline</span><span class="hljs-params">(admin.TabularInline)</span>:</span><br>    model = Tag<br> <br><span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">ContactAdmin</span><span class="hljs-params">(admin.ModelAdmin)</span>:</span><br>    list_display = (<span class="hljs-string">'name'</span>,<span class="hljs-string">'age'</span>, <span class="hljs-string">'email'</span>) <span class="hljs-comment"># list</span><br>    inlines = [TagInline]  <span class="hljs-comment"># Inline</span><br>    fieldsets = (<br>        [<span class="hljs-string">'Main'</span>,&#123;<br>            <span class="hljs-string">'fields'</span>:(<span class="hljs-string">'name'</span>,<span class="hljs-string">'email'</span>),<br>        &#125;],<br>        [<span class="hljs-string">'Advance'</span>,&#123;<br>            <span class="hljs-string">'classes'</span>: (<span class="hljs-string">'collapse'</span>,),<br>            <span class="hljs-string">'fields'</span>: (<span class="hljs-string"><code class="language-hljs python"><span class="hljs-comment">#HelloWorld/TestModel/admin.py: 文件代码：</span><br><span class="hljs-keyword">from</span> django.contrib <span class="hljs-keyword">import</span> admin<br><span class="hljs-keyword">from</span> TestModel.models <span class="hljs-keyword">import</span> Test,Contact,Tag<br> <br><span class="hljs-comment"># Register your models here.</span><br><span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">TagInline</span><span class="hljs-params">(admin.TabularInline)</span>:</span><br>    model = Tag<br> <br><span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">ContactAdmin</span><span class="hljs-params">(admin.ModelAdmin)</span>:</span><br>    list_display = (<span class="hljs-string">'name'</span>,<span class="hljs-string">'age'</span>, <span class="hljs-string">'email'</span>) <span class="hljs-comment"># list</span><br>    inlines = [TagInline]  <span class="hljs-comment"># Inline</span><br>    fieldsets = (<br>        [<span class="hljs-string">'Main'</span>,&#123;<br>            <span class="hljs-string">'fields'</span>:(<span class="hljs-string">'name'</span>,<span class="hljs-string">'email'</span>),<br>        &#125;],<br>        [<span class="hljs-string">'Advance'</span>,&#123;<br>            <span class="hljs-string">'classes'</span>: (<span class="hljs-string">'collapse'</span>,),<br>            <span class="hljs-string">'fields'</span>: (<span class="hljs-string">'age'</span>,),<br>        &#125;]<br> <br>    )<br> <br>admin.site.register(Contact, ContactAdmin)<br>admin.site.register([Test])<br></code></pre></td></tr></table></figure>
<h5 id="刷新页面显示效果如下："><strong>刷新页面显示效果如下：</strong></h5>
<p><img src= "/img/loading.gif" data-src="https://gitee.com/xgpqq/tuchuang/raw/master/img/image-20200418112720304.png" alt="image-20200418112720304"></p>
<h4 id="搜索功能在管理大量记录时非常有，我们可以使用-search-fields-为该列表页增加搜索栏：">搜索功能在管理大量记录时非常有，我们可以使用 search_fields 为该列表页增加搜索栏：</h4>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre class=" language-hljs python"><span class="hljs-comment">#HelloWorld/TestModel/admin.py: 文件代码：</span><br><span class="hljs-keyword">from</span> django.contrib <span class="hljs-keyword">import</span> admin<br><span class="hljs-keyword">from</span> TestModel.models <span class="hljs-keyword">import</span> Test,Contact,Tag<br> <br><span class="hljs-comment"># Register your models here.</span><br><span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">TagInline</span><span class="hljs-params">(admin.TabularInline)</span>:</span><br>    model = Tag<br> <br><span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">ContactAdmin</span><span class="hljs-params">(admin.ModelAdmin)</span>:</span><br>    list_display = (<span class="hljs-string">'name'</span>,<span class="hljs-string">'age'</span>, <span class="hljs-string">'email'</span>)<br>    search_fields = (<span class="hljs-string">'name'</span>,)               <span class="hljs-comment">#search</span><br>    inlines = [TagInline]  <span class="hljs-comment"># Inline</span><br>    fieldsets = (<br>        [<span class="hljs-string">'Main'</span>,&#123;<br>            <span class="hljs-string">'fields'</span>:(<span class="hljs-string">'name'</span>,<span class="hljs-string">'email'</span>),<br>        &#125;],<br>        [<span class="hljs-string">'Advance'</span>,&#123;<br>            <span class="hljs-string">'classes'</span>: (<span class="hljs-string">'collapse'</span>,),<br>            <span class="hljs-string">'fields'</span>: (<span class="hljs-string"><code class="language-hljs python"><span class="hljs-comment">#HelloWorld/TestModel/admin.py: 文件代码：</span><br><span class="hljs-keyword">from</span> django.contrib <span class="hljs-keyword">import</span> admin<br><span class="hljs-keyword">from</span> TestModel.models <span class="hljs-keyword">import</span> Test,Contact,Tag<br> <br><span class="hljs-comment"># Register your models here.</span><br><span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">TagInline</span><span class="hljs-params">(admin.TabularInline)</span>:</span><br>    model = Tag<br> <br><span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">ContactAdmin</span><span class="hljs-params">(admin.ModelAdmin)</span>:</span><br>    list_display = (<span class="hljs-string">'name'</span>,<span class="hljs-string">'age'</span>, <span class="hljs-string">'email'</span>)<br>    search_fields = (<span class="hljs-string">'name'</span>,)               <span class="hljs-comment">#search</span><br>    inlines = [TagInline]  <span class="hljs-comment"># Inline</span><br>    fieldsets = (<br>        [<span class="hljs-string">'Main'</span>,&#123;<br>            <span class="hljs-string">'fields'</span>:(<span class="hljs-string">'name'</span>,<span class="hljs-string">'email'</span>),<br>        &#125;],<br>        [<span class="hljs-string">'Advance'</span>,&#123;<br>            <span class="hljs-string">'classes'</span>: (<span class="hljs-string">'collapse'</span>,),<br>            <span class="hljs-string">'fields'</span>: (<span class="hljs-string">'age'</span>,),<br>        &#125;]<br> <br>    )<br> <br>admin.site.register(Contact, ContactAdmin)<br>admin.site.register([Test])<br></code></pre></td></tr></table></figure>
<h5 id="在本实例中我们搜索了-name-为xgp的记录，显示结果如下：">在本实例中我们搜索了 name 为xgp的记录，显示结果如下：</h5>
<p><img src= "/img/loading.gif" data-src="https://gitee.com/xgpqq/tuchuang/raw/master/img/image-20200418112732683.png" alt="image-20200418112732683"></p>
<h1>五、引入静态文件</h1>
<p><em><strong>文件链接《链接: <a href="https://pan.baidu.com/s/133f0ypYOsAi8s8DdV_Uduw" target="_blank" rel="noopener">https://pan.baidu.com/s/133f0ypYOsAi8s8DdV_Uduw</a> 提取码: 4847》</strong></em></p>
<p><strong>需要将一些静态资源引入项目，新建一个static目录，可以将js、css等文件放入这个目录中：</strong></p>
<p><img src= "/img/loading.gif" data-src="https://gitee.com/xgpqq/tuchuang/raw/master/img/image-20200418113756299.png" alt="image-20200418113756299"></p>
<h3 id="1、urls-py-规则修改为如下形式：">1、<a href="http://urls.py" target="_blank" rel="noopener">urls.py</a> 规则修改为如下形式：</h3>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre class=" language-hljs python"><span class="hljs-keyword">from</span> django.contrib <span class="hljs-keyword">import</span> admin<br><span class="hljs-keyword">from</span> django.urls <span class="hljs-keyword">import</span> path<br><span class="hljs-keyword">from</span> . <span class="hljs-keyword">import</span> testdb<br><span class="hljs-keyword">from</span> . <span class="hljs-keyword">import</span> search<br><span class="hljs-keyword">from</span> . <span class="hljs-keyword">import</span> search2<br><span class="hljs-keyword">from</span> . <span class="hljs-keyword">import</span> index<br><br>urlpatterns = [<br>    path(<span class="hljs-string">'admin/'</span>, admin.site.urls),<br>    path(<span class="hljs-string">'testdb/'</span>, testdb.testdb),<br>    path(<span class="hljs-string">'gitdb/'</span>, testdb.getdb),<br>    path(<span class="hljs-string">'modify/'</span>, testdb.modify),<br>    path(<span class="hljs-string">'del/'</span>, testdb.dl),<br>    path(<span class="hljs-string">'search/'</span>, search.search),<br>    path(<span class="hljs-string">'search-from/'</span>, search.search_form),<br>    path(<span class="hljs-string">'search-post/'</span>, search2.search_post),<br>    path(<span class="hljs-string"><code class="language-hljs python"><span class="hljs-keyword">from</span> django.contrib <span class="hljs-keyword">import</span> admin<br><span class="hljs-keyword">from</span> django.urls <span class="hljs-keyword">import</span> path<br><span class="hljs-keyword">from</span> . <span class="hljs-keyword">import</span> testdb<br><span class="hljs-keyword">from</span> . <span class="hljs-keyword">import</span> search<br><span class="hljs-keyword">from</span> . <span class="hljs-keyword">import</span> search2<br><span class="hljs-keyword">from</span> . <span class="hljs-keyword">import</span> index<br><br>urlpatterns = [<br>    path(<span class="hljs-string">'admin/'</span>, admin.site.urls),<br>    path(<span class="hljs-string">'testdb/'</span>, testdb.testdb),<br>    path(<span class="hljs-string">'gitdb/'</span>, testdb.getdb),<br>    path(<span class="hljs-string">'modify/'</span>, testdb.modify),<br>    path(<span class="hljs-string">'del/'</span>, testdb.dl),<br>    path(<span class="hljs-string">'search/'</span>, search.search),<br>    path(<span class="hljs-string">'search-from/'</span>, search.search_form),<br>    path(<span class="hljs-string">'search-post/'</span>, search2.search_post),<br>    path(<span class="hljs-string">'index/'</span>, index.index),<br>]<br></code></pre></td></tr></table></figure>
<h3 id="2、本目录创建index-py文件">2、本目录创建index.py文件</h3>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre class=" language-hljs python"><span class="hljs-keyword">from</span> django.shortcuts <span class="hljs-keyword">import</span> render<br><br><span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">index</span><span class="hljs-params">(request)</span>:</span><br>    <span class="hljs-keyword">return</span> render(request, <span class="hljs-string"><code class="language-hljs python"><span class="hljs-keyword">from</span> django.shortcuts <span class="hljs-keyword">import</span> render<br><br><span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">index</span><span class="hljs-params">(request)</span>:</span><br>    <span class="hljs-keyword">return</span> render(request, <span class="hljs-string">'index.html'</span> ,&#123;&#125;)<br></code></pre></td></tr></table></figure>
<h4 id="浏览器查看一下">浏览器<a href="http://127.0.0.1:8000/index" target="_blank" rel="noopener">查看一下</a></h4>
<p><img src= "/img/loading.gif" data-src="https://gitee.com/xgpqq/tuchuang/raw/master/img/image-20200418115340307.png" alt="image-20200418115340307"></p>
<h3 id="3、需要让Django找到这个目录，需要在setting文件中进行配置：">3、需要让Django找到这个目录，需要在setting文件中进行配置：</h3>
<p><img src= "/img/loading.gif" data-src="https://gitee.com/xgpqq/tuchuang/raw/master/img/image-20200418114859747.png" alt="image-20200418114859747"></p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre class=" language-hljs python">STATICFILES_DIRS = (<br>    os.path.join(BASE_DIR, <span class="hljs-string"><code class="language-hljs python">STATICFILES_DIRS = (<br>    os.path.join(BASE_DIR, <span class="hljs-string">'static'</span>),<br>)<br></code></pre></td></tr></table></figure>
<h3 id="4、修改一下index-html文件">4、修改一下index.html文件</h3>
<p><strong>在html文件中引入静态资源：</strong></p>
<p><img src= "/img/loading.gif" data-src="https://gitee.com/xgpqq/tuchuang/raw/master/img/image-20200418121043637.png" alt="image-20200418121043637"></p>
<p><strong>把index.html文件中所有的<code>image</code>替换为<code>/image</code>！</strong></p>
<p><strong>ctrl+F：替换</strong></p>
<p><img src= "/img/loading.gif" data-src="https://gitee.com/xgpqq/tuchuang/raw/master/img/image-20200418121247927.png" alt="image-20200418121247927"></p>
<h4 id="浏览器查看一下-2">浏览器<a href="http://127.0.0.1:8000/index" target="_blank" rel="noopener">查看一下</a></h4>
<p><img src= "/img/loading.gif" data-src="https://gitee.com/xgpqq/tuchuang/raw/master/img/image-20200418121310112.png" alt="image-20200418121310112"></p>
</div><div class="post-copyright"><div class="post-copyright__author"><span class="post-copyright-meta">文章作者: </span><span class="post-copyright-info"><a href="mailto:undefined">Wu Shao Dong</a></span></div><div class="post-copyright__type"><span class="post-copyright-meta">文章链接: </span><span class="post-copyright-info"><a href="/wsdlxgp.top/2019/09/14/63%20PyCharm%E5%AE%9E%E7%8E%B0%EF%BC%88Django%E7%9A%84%E6%A8%A1%E5%9E%8B%E3%80%81%E8%A1%A8%E5%8D%95%E3%80%81%E7%AE%A1%E7%90%86%E5%B7%A5%E5%85%B7%E3%80%81%E5%BC%95%E5%85%A5%E9%9D%99%E6%80%81%E6%96%87%E4%BB%B6%EF%BC%89/">wsdlxgp.top/2019/09/14/63%20PyCharm%E5%AE%9E%E7%8E%B0%EF%BC%88Django%E7%9A%84%E6%A8%A1%E5%9E%8B%E3%80%81%E8%A1%A8%E5%8D%95%E3%80%81%E7%AE%A1%E7%90%86%E5%B7%A5%E5%85%B7%E3%80%81%E5%BC%95%E5%85%A5%E9%9D%99%E6%80%81%E6%96%87%E4%BB%B6%EF%BC%89/</a></span></div><div class="post-copyright__notice"><span class="post-copyright-meta">版权声明: </span><span class="post-copyright-info">本博客所有文章除特别声明外，均采用 <a href="https://creativecommons.org/licenses/by-nc-sa/4.0/" target="_blank">CC BY-NC-SA 4.0</a> 许可协议。转载请注明来自 <a href="wsdlxgp.top" target="_blank">Xgp & Blog</a>！</span></div></div><div class="tag_share"><div class="post-meta__tag-list"><a class="post-meta__tags" href="/tags/nfs/">nfs</a><a class="post-meta__tags" href="/tags/deployment/">deployment</a><a class="post-meta__tags" href="/tags/pv/">pv</a><a class="post-meta__tags" href="/tags/pvc/">pvc</a><a class="post-meta__tags" href="/tags/Storage-Class/">Storage Class</a><a class="post-meta__tags" href="/tags/dashboard/">dashboard</a><a class="post-meta__tags" href="/tags/helm/">helm</a></div><div class="post_share"><div class="social-share" data-image="https://i.loli.net/2020/05/01/gkihqEjXxJ5UZ1C.jpg" data-sites="facebook,twitter,wechat,weibo,qq"></div><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/social-share.js/dist/css/share.min.css"/><script src="https://cdn.jsdelivr.net/npm/social-share.js/dist/js/social-share.min.js"></script></div></div><nav class="pagination-post" id="pagination"><div class="prev-post pull-left"><a href="/2019/09/14/64%20Python3+Django3%E5%BC%80%E5%8F%91%E7%AE%80%E5%8D%95%E7%9A%84%E4%BA%BA%E5%91%98%E7%AE%A1%E7%90%86%E7%B3%BB%E7%BB%9F/"><img class="prev-cover" data-src="https://gitee.com/xgpqq/tuchuang/raw/master/img/qweq64p.jpg" onerror="onerror=null;src='/img/404.jpg'"><div class="pagination-info"><div class="label">上一篇</div><div class="prev_info">Python3+Django3开发简单的人员管理系统</div></div></a></div><div class="next-post pull-right"><a href="/2019/09/14/62%20windows10%E5%AE%89%E8%A3%85%20mysql%E6%95%B0%E6%8D%AE%E5%BA%93%E5%92%8CNavicat%20for%20MySQL(MySQL%E7%AE%A1%E7%90%86%E5%B7%A5%E5%85%B7)/"><img class="next-cover" data-src="https://gitee.com/xgpqq/tuchuang/raw/master/img/qweq62p.jpg" onerror="onerror=null;src='/img/404.jpg'"><div class="pagination-info"><div class="label">下一篇</div><div class="next_info">windows10安装 mysql数据库和Navicat for MySQL(MySQL管理工具)</div></div></a></div></nav><div class="relatedPosts"><div class="relatedPosts_headline"><i class="fas fa-thumbs-up fa-fw"></i><span> 相关推荐</span></div><div class="relatedPosts_list"><div class="relatedPosts_item"><a href="/2019/09/14/57 正则表达式/" title="python的正则表达式"><img class="relatedPosts_cover" data-src="https://gitee.com/xgpqq/tuchuang/raw/master/img/qweq57p.jpg"><div class="relatedPosts_main is-center"><div class="relatedPosts_date"><i class="far fa-calendar-alt fa-fw"></i> 2019-09-14</div><div class="relatedPosts_title">python的正则表达式</div></div></a></div><div class="relatedPosts_item"><a href="/2019/09/14/58 python文本文件的（读、写、追加）/" title="python文本文件的（读、写、追加）"><img class="relatedPosts_cover" data-src="https://gitee.com/xgpqq/tuchuang/raw/master/img/qweq58p.jpg"><div class="relatedPosts_main is-center"><div class="relatedPosts_date"><i class="far fa-calendar-alt fa-fw"></i> 2019-09-14</div><div class="relatedPosts_title">python文本文件的（读、写、追加）</div></div></a></div><div class="relatedPosts_item"><a href="/2019/09/14/60 Python数据可视化之Pygal图表类型/" title="Python数据可视化之Pygal图表类型"><img class="relatedPosts_cover" data-src="https://gitee.com/xgpqq/tuchuang/raw/master/img/qweq60p.jpg"><div class="relatedPosts_main is-center"><div class="relatedPosts_date"><i class="far fa-calendar-alt fa-fw"></i> 2019-09-14</div><div class="relatedPosts_title">Python数据可视化之Pygal图表类型</div></div></a></div><div class="relatedPosts_item"><a href="/2019/09/14/61 初识Django/" title="初识Django和宝塔面板"><img class="relatedPosts_cover" data-src="https://gitee.com/xgpqq/tuchuang/raw/master/img/qweq61p.jpg"><div class="relatedPosts_main is-center"><div class="relatedPosts_date"><i class="far fa-calendar-alt fa-fw"></i> 2019-09-14</div><div class="relatedPosts_title">初识Django和宝塔面板</div></div></a></div><div class="relatedPosts_item"><a href="/2019/09/14/62 windows10安装 mysql数据库和Navicat for MySQL(MySQL管理工具)/" title="windows10安装 mysql数据库和Navicat for MySQL(MySQL管理工具)"><img class="relatedPosts_cover" data-src="https://gitee.com/xgpqq/tuchuang/raw/master/img/qweq62p.jpg"><div class="relatedPosts_main is-center"><div class="relatedPosts_date"><i class="far fa-calendar-alt fa-fw"></i> 2019-09-14</div><div class="relatedPosts_title">windows10安装 mysql数据库和Navicat for MySQL(MySQL管理工具)</div></div></a></div><div class="relatedPosts_item"><a href="/2019/09/14/59 数据可视化/" title="python数据可视化"><img class="relatedPosts_cover" data-src="https://gitee.com/xgpqq/tuchuang/raw/master/img/qweq59p.jpg"><div class="relatedPosts_main is-center"><div class="relatedPosts_date"><i class="far fa-calendar-alt fa-fw"></i> 2019-09-14</div><div class="relatedPosts_title">python数据可视化</div></div></a></div></div></div></article></main><footer id="footer" data-type="color"><div id="footer-wrap"><div class="copyright">&copy;2020 By Wu Shao Dong</div><div class="framework-info"><span>驱动 </span><a href="https://hexo.io" target="_blank" rel="noopener"><span>Hexo</span></a><span class="footer-separator">|</span><span>主题 </span><a href="https://github.com/jerryc127/hexo-theme-butterfly" target="_blank" rel="noopener"><span>Butterfly</span></a></div></div></footer></div><section class="rightside" id="rightside"><div id="rightside-config-hide"><button id="readmode" title="阅读模式"><i class="fas fa-book-open"></i></button><button id="font_plus" title="放大字体"><i class="fas fa-plus"></i></button><button id="font_minus" title="缩小字体"><i class="fas fa-minus"></i></button><button class="translate_chn_to_cht" id="translateLink" title="简繁转换">繁</button><button id="darkmode" title="浅色和深色模式转换"><i class="fas fa-adjust"></i></button></div><div id="rightside-config-show"><button id="rightside_config" title="设置"><i class="fas fa-cog"></i></button><button class="close" id="mobile-toc-button" title="目录"><i class="fas fa-list-ul"></i></button><button id="go-up" title="回到顶部"><i class="fas fa-arrow-up"></i></button></div></section><script src="https://cdn.jsdelivr.net/npm/jquery@latest/dist/jquery.min.js"></script><script src="/js/utils.js"></script><script src="/js/main.js"></script><script src="/js/tw_cn.js"></script><script src="https://cdn.jsdelivr.net/npm/@fancyapps/fancybox@latest/dist/jquery.fancybox.min.js"></script><script async src="//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script><script src="https://cdn.jsdelivr.net/npm/instant.page/instantpage.min.js" type="module" defer></script><script src="https://cdn.jsdelivr.net/npm/vanilla-lazyload/dist/lazyload.iife.min.js" async></script><script src="/live2dw/lib/L2Dwidget.min.js?094cbace49a39548bed64abff5988b05"></script><script>L2Dwidget.init({"log":false,"pluginJsPath":"lib/","pluginModelPath":"assets/","pluginRootPath":"live2dw/","tagMode":false});</script></body></html>